<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>C# 从入门到放弃 | 南阳向北</title><meta name="keywords" content="C#"><meta name="author" content="MQRoad"><meta name="copyright" content="MQRoad"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="C# 从入门到放弃"><meta name="application-name" content="C# 从入门到放弃"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="default"><link rel="bookmark" href="/img/siteicon/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" sizes="180x180" href="/img/siteicon/apple-touch-icon.png"><link rel="apple-touch-icon" sizes="192x192" href="/img/siteicon/apple-touch-icon.png"><link rel="apple-touch-icon" sizes="512x512" href="/img/siteicon/apple-touch-icon.png"><link rel="apple-touch-startup-image" media="screen and (device-width:320px) and (device-height:568px) and (-webkit-device-pixel-ratio:2) and (orientation:landscape)" href="/img/siteicon/splashIcons/icon_1136x640.png"><link rel="apple-touch-startup-image" media="screen and (device-width:320px) and (device-height:568px) and (-webkit-device-pixel-ratio:2) and (orientation:portrait)" href="/img/siteicon/splashIcons/icon_640x1136.png"><link rel="apple-touch-startup-image" media="screen and (device-width:414px) and (device-height:896px) and (-webkit-device-pixel-ratio:3) and (orientation:landscape)" href="/img/siteicon/splashIcons/icon_2688x1242.png"><link rel="apple-touch-startup-image" media="screen and (device-width:414px) and (device-height:896px) and (-webkit-device-pixel-ratio:2) and (orientation:landscape)" href="/img/siteicon/splashIcons/icon_1792x828.png"><link rel="apple-touch-startup-image" media="screen and (device-width:375px) and (device-height:812px) and (-webkit-device-pixel-ratio:3) and (orientation:portrait)" href="/img/siteicon/splashIcons/icon_1125x2436.png"><link rel="apple-touch-startup-image" media="screen and (device-width:414px) and (device-height:896px) and (-webkit-device-pixel-ratio:2) and (orientation:portrait)" href="/img/siteicon/splashIcons/icon_828x1792.png"><link rel="apple-touch-startup-image" media="screen and (device-width:375px) and (device-height:812px) and (-webkit-device-pixel-ratio:3) and (orientation:landscape)" href="/img/siteicon/splashIcons/icon_2436x1125.png"><link rel="apple-touch-startup-image" media="screen and (device-width:414px) and (device-height:736px) and (-webkit-device-pixel-ratio:3) and (orientation:portrait)" href="/img/siteicon/splashIcons/icon_1242x2208.png"><link rel="apple-touch-startup-image" media="screen and (device-width:414px) and (device-height:736px) and (-webkit-device-pixel-ratio:3) and (orientation:landscape)" href="/img/siteicon/splashIcons/icon_2208x1242.png"><link rel="apple-touch-startup-image" media="screen and (device-width:375px) and (device-height:667px) and (-webkit-device-pixel-ratio:2) and (orientation:landscape)" href="/img/siteicon/splashIcons/icon_1334x750.png"><link rel="apple-touch-startup-image" media="screen and (device-width:375px) and (device-height:667px) and (-webkit-device-pixel-ratio:2) and (orientation:portrait)" href="/img/siteicon/splashIcons/icon_750x1334.png"><link rel="apple-touch-startup-image" media="screen and (device-width:1024px) and (device-height:1366px) and (-webkit-device-pixel-ratio:2) and (orientation:landscape)" href="/img/siteicon/splashIcons/icon_2732x2048.png"><meta name="description" content="参考课程：刘铁猛 - C# 语言入门详解 数据类型 C# 是强类型语言，即声明变量为一种类型时，不能将另一种类型赋值给该变量  纯 面向对象 的语言  为模仿弱类型，C# 提出了动态类型 1234dynamic myvar &#x3D; 100;Console.WriteLine(myvar);myvar &#x3D; &quot;myvar&quot;;Console.WriteLine(myvar);  C# 中">
<meta property="og:type" content="article">
<meta property="og:title" content="C# 从入门到放弃">
<meta property="og:url" content="https://hbroad.github.io/CSharp_learning/index.html">
<meta property="og:site_name" content="南阳向北">
<meta property="og:description" content="参考课程：刘铁猛 - C# 语言入门详解 数据类型 C# 是强类型语言，即声明变量为一种类型时，不能将另一种类型赋值给该变量  纯 面向对象 的语言  为模仿弱类型，C# 提出了动态类型 1234dynamic myvar &#x3D; 100;Console.WriteLine(myvar);myvar &#x3D; &quot;myvar&quot;;Console.WriteLine(myvar);  C# 中">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2023/08/19/Zw3vehYDGNbq81O.png">
<meta property="article:published_time" content="2023-07-23T03:18:30.000Z">
<meta property="article:modified_time" content="2023-08-19T09:02:49.859Z">
<meta property="article:author" content="MQRoad">
<meta property="article:tag" content="C#">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2023/08/19/Zw3vehYDGNbq81O.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://hbroad.github.io/CSharp_learning/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@1.0.17/lib/assets/font-awesome-animation.min.css"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://npm.elemecdn.com/@fortawesome/fontawesome-free@6.3.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/@fancyapps/ui@4.0.31/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#3b70fc","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://npm.elemecdn.com/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://npm.elemecdn.com/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'C# 从入门到放弃',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-08-19 17:02:49'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              // const now = new Date()
              // const hour = now.getHours()
              // const isNight = hour <= 6 || hour >= 18
              // isNight ? activateDarkMode() : activateLightMode()
              activateDarkMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><!-- hexo injector head_end start -->
<style>#recent-posts{margin-top:-1rem;align-content:flex-start;display:flex;flex-wrap:wrap;justify-content:space-between}#recent-posts>.recent-post-item{margin-top:1rem;display:inline-block;height:auto;width:49%}#recent-posts>.recent-post-item .post_cover{width:100%;height:200px}#recent-posts>.recent-post-item .post_cover img.post_bg{width:100%;height:100%}#recent-posts>.recent-post-item>.recent-post-info>.content{display:none}#recent-posts>.recent-post-item{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column}#recent-posts>.recent-post-item .left_radius{border-radius:8px 8px 0 0}#recent-posts>.recent-post-item .right_radius{border-radius:8px 8px 0 0}.recent-post-item{height:auto!important}.recent-post-info{padding:0 40px;margin-top:1em;width:100%!important}#recent-posts>.recent-post-item>.recent-post-info>.article-title{-webkit-line-clamp:1;margin-top:.3rem;margin-bottom:.3rem;color:var(--text-highlight-color);font-size:1.2em;line-height:1.4}#recent-posts>.recent-post-item>.recent-post-info>.article-meta-wrap{margin-bottom:1rem}@media screen and (max-width:768px){#recent-posts>.recent-post-item{width:100%}}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/"><div class="title">南阳向北</div><i class="fa-solid fa-house"></i></a></span><div class="mask-name-container"><center id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></center></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child" style="left:-79px;"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="fa-fw fas fa-archive faa-tada"></i><span> 全部</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="fa-fw fas fa-shapes faa-tada"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="fa-fw fas fa-tags faa-tada"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/link/"><span> 友链</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/categories/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD"><span> AI资讯</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child" style="left:-79px;"><li><a class="site-page child faa-parent animated-hover" href="/about/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-zhifeiji"></use></svg><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="fa-fw fas fas fa-lightbulb faa-tada"></i><span> 发个说说</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/timeline/"><i class="fa-fw fa-fw fas fa-shoe-prints faa-tada faa-tada"></i><span> 建站小记</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="fas fa-dice" style="font-size:1.2rem"></i></a></div><div class="nav-button" id="darkmode_navswitch"><a class="darkmode_switchbutton" type="button" href="javascript:void(0);" title="浅色和深色模式转换" onclick="rm.switchDarkMode()"><i class="fas fa-adjust"></i></a></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="fas fa-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">C# 从入门到放弃</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-07-23T03:18:30.000Z" title="发表于 2023-07-23 11:18:30">2023-07-23</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-08-19T09:02:49.859Z" title="更新于 2023-08-19 17:02:49">2023-08-19</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/C/">C#</a></span></div><div class="meta-secondline"></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://s2.loli.net/2023/08/19/Zw3vehYDGNbq81O.png"></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV11M4y1Q7c7/?spm_id_from=333.999.0.0">参考课程：刘铁猛 - C# 语言入门详解</a></p>
<h1 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h1><ul>
<li><p>C# 是强类型语言，即声明变量为一种类型时，不能将另一种类型赋值给该变量</p>
</li>
<li><p>纯 面向对象 的语言</p>
</li>
<li><p>为模仿弱类型，C# 提出了动态类型</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">dynamic</span> myvar = <span class="number">100</span>;</span><br><span class="line">Console.WriteLine(myvar);</span><br><span class="line">myvar = <span class="string">&quot;myvar&quot;</span>;</span><br><span class="line">Console.WriteLine(myvar);</span><br></pre></td></tr></table></figure>
</li>
<li><p>C# 中存在垃圾回收机制，堆中申请的内存无人使用时会自动回收，较 C++ 安全</p>
</li>
</ul>
<h2 id="C-五大数据类型"><a href="#C-五大数据类型" class="headerlink" title="C# 五大数据类型"></a>C# 五大数据类型</h2><ul>
<li>类</li>
<li>结构体</li>
<li>枚举</li>
<li>接口</li>
<li>委托</li>
</ul>
<p>其中，类、接口、委托 属于 引用类型，结构体、枚举 属于 值类型，它们都属于 object 基类</p>
<h3 id="值类型"><a href="#值类型" class="headerlink" title="值类型"></a>值类型</h3><ul>
<li>无实例（具体的对象），其与变量合而为一</li>
<li>按变量类型分配内存空间</li>
<li>十进制转为二进制存储，对负数，按位取反再加1后存储；对两字节，补零后高八位存储在内存地址较大的位置，后八位存储在较低位置</li>
</ul>
<h3 id="引用类型"><a href="#引用类型" class="headerlink" title="引用类型"></a>引用类型</h3><p>以类为例</p>
<ul>
<li><p><strong>直接分配四个字节</strong></p>
</li>
<li><p><strong>在堆中开辟内存，即引用类型的变量中存储的是对象的内存地址</strong></p>
</li>
</ul>
<h2 id="参数种类"><a href="#参数种类" class="headerlink" title="参数种类"></a>参数种类</h2><ul>
<li>传值</li>
<li>传引用 ref</li>
<li>输出 out</li>
</ul>
<h2 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h2><ul>
<li>静态变量：属于类，而非对象</li>
<li>本地变量必须初始化，否则编译报错（int x = 0;)</li>
<li>类中的成员变量不赋值时默认初始化为 0 或 null</li>
</ul>
<h2 id="常量"><a href="#常量" class="headerlink" title="常量"></a>常量</h2><ul>
<li>const 修饰的常量初始化后不能再更改</li>
</ul>
<h2 id="装箱与拆箱"><a href="#装箱与拆箱" class="headerlink" title="装箱与拆箱"></a>装箱与拆箱</h2><p>Boxing &amp; Unboxing</p>
<ul>
<li>目前不常用，因其涉及性能损失</li>
</ul>
<p>详见 C07S05 05:14</p>
<ul>
<li>装箱：由栈到堆</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> x = <span class="number">100</span>;</span><br><span class="line"><span class="built_in">object</span> obj;	<span class="comment">//此时只是在栈中为 obj 分配 4 字节空间，并初始化为0</span></span><br><span class="line">obj = x;	<span class="comment">//此时先在堆中开辟 4 字节空间，并将 x 的值复制到该空间中，再将该空间对应的首地址存储在obj 中</span></span><br></pre></td></tr></table></figure>
<ul>
<li>拆箱：由堆到栈</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> y = (<span class="built_in">int</span>)obj;	<span class="comment">//先在栈中为 y 分配 4 字节空间，再将堆中 obj 变量的值复制到 y 所在的内存中</span></span><br></pre></td></tr></table></figure>
<p>可见，装箱和拆箱涉及堆栈数据的交换，必然损失性能</p>
<p>装箱时是和类型一起装箱的，故拆箱时类型要一致</p>
<h1 id="字符与字符串"><a href="#字符与字符串" class="headerlink" title="字符与字符串"></a>字符与字符串</h1><h2 id="字符"><a href="#字符" class="headerlink" title="字符"></a>字符</h2><ul>
<li><p>使用 char/Char 定义</p>
</li>
<li><p>只能用单引号，单引号之间是单个字符</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">char</span> ch1 = <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">Console.WriteLine(<span class="built_in">char</span>.ToUpper(ch1));</span><br><span class="line">Console.WriteLine(<span class="built_in">char</span>.IsDigit(ch1));</span><br><span class="line">Console.WriteLine(<span class="built_in">char</span>.IsLetter(ch1));</span><br></pre></td></tr></table></figure>
</li>
<li><p>转义字符</p>
<p>  通过“\”完成转义</p>
  <figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Console.WriteLine(<span class="string">&quot;C:\\Windows\\soft\\test\\2053\\11&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>  可见，若目录层级较深，通过该方法指定路径繁琐，可通过 @ 符号实现多层转义（或者说@是取消转义）：</p>
  <figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Console.WriteLine(<span class="string">@&quot;C:\Windows\soft\test\2053\11&quot;</span>);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h2><h3 id="字串初始化"><a href="#字串初始化" class="headerlink" title="字串初始化"></a>字串初始化</h3><ul>
<li><p>字串声明后不赋初值时，默认为 null</p>
</li>
<li><p>引用字串常量初始化</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> str = <span class="string">&quot;每日疑问，C# 入门了嘛&quot;</span>；</span><br></pre></td></tr></table></figure>
</li>
<li><p>提取字符数组中的一部分初始化</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">char</span>[] ch = &#123; <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;f&#x27;</span> &#125;;</span><br><span class="line"><span class="built_in">string</span> str = <span class="keyword">new</span> <span class="built_in">string</span>(ch, <span class="number">2</span>, <span class="number">3</span>); <span class="comment">//起始索引、截取长度</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>空字串与空引用区别</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> str = <span class="literal">null</span>; <span class="comment">//空对象</span></span><br><span class="line"><span class="built_in">string</span> str = <span class="string">&quot;&quot;</span>; <span class="comment">//是一个空串</span></span><br></pre></td></tr></table></figure>
<ul>
<li>空对象，没有指向任何引用地址，调用 string 的方法会抛出 NullReferenceException 空引用异常</li>
<li>空串，分配了内存空间，可调用 string 的任意方法</li>
</ul>
</li>
</ul>
<h3 id="字串拼接"><a href="#字串拼接" class="headerlink" title="字串拼接"></a>字串拼接</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> str_con = <span class="string">&quot;123&quot;</span> + <span class="string">&quot;456&quot;</span>;</span><br><span class="line">str_con += <span class="string">&quot;xyz&quot;</span>;</span><br></pre></td></tr></table></figure>
<h3 id="字串比较"><a href="#字串比较" class="headerlink" title="字串比较"></a>字串比较</h3><ul>
<li><p>Compare 方法</p>
<p>比较的是字母排序的大小</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">Compare</span>(<span class="params"><span class="built_in">string</span> strA, strB</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">Compare</span>(<span class="params"><span class="built_in">string</span> strA, strB, <span class="built_in">bool</span> ignoreCase</span>)</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>CompareTo 方法</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">CompareTo</span>(<span class="params"><span class="built_in">object</span> <span class="keyword">value</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">CompareTo</span>(<span class="params"><span class="built_in">string</span> <span class="keyword">value</span></span>)</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Equals 方法</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">bool</span> <span class="title">Equals</span>(<span class="params"><span class="built_in">string</span> <span class="keyword">value</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">Equals</span>(<span class="params"><span class="built_in">string</span> a, <span class="built_in">string</span> b</span>)</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>实例</p>
  <figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> a = <span class="string">&quot;string&quot;</span>;</span><br><span class="line"><span class="built_in">string</span> b = <span class="string">&quot;string&quot;</span>;</span><br><span class="line">Console.WriteLine(<span class="built_in">string</span>.Compare(a, b));</span><br><span class="line">Console.WriteLine(<span class="built_in">string</span>.Compare(a, b, <span class="literal">true</span>));</span><br><span class="line">Console.WriteLine(a.CompareTo(b));</span><br><span class="line">Console.WriteLine(a.Equals(b));</span><br><span class="line">Console.WriteLine(<span class="built_in">string</span>.Equals(a, b));</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="格式化字串"><a href="#格式化字串" class="headerlink" title="格式化字串"></a>格式化字串</h3><ul>
<li><p>Format 方法：</p>
  <figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">Format</span>(<span class="params"><span class="built_in">string</span> format, <span class="built_in">object</span> arg0</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">Format</span>(<span class="params"><span class="built_in">string</span> format, <span class="keyword">params</span> Object[] args</span>)</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>标准数值格式规范</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2023/08/11/gfSEd3KrvsVwDnR.png" alt="image-20230811115839706"></p>
  <figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span>.Format(<span class="string">&quot;&#123;0:C&#125;&quot;</span>, <span class="number">256</span>);	<span class="comment">//默认保留两位小数</span></span><br><span class="line"><span class="built_in">string</span>.Format(<span class="string">&quot;&#123;0:C0&#125;&quot;</span>, <span class="number">256</span>);	<span class="comment">//设置小数位数</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>标准日期时间格式规范</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2023/08/11/DFjm6nSxetbZVPT.png" alt="image-20230811134947036"></p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DateTime dateTime = DateTime.Now;</span><br><span class="line"><span class="built_in">string</span>.Format(<span class="string">&quot;&#123;0:D&#125;&quot;</span>, dateTime);</span><br></pre></td></tr></table></figure>
</li>
<li><p>ToString 方法：</p>
  <figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DateTime dateTime = DateTime.Now;</span><br><span class="line">dateTime.ToString(<span class="string">&quot;D&quot;</span>);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="截取字串"><a href="#截取字串" class="headerlink" title="截取字串"></a>截取字串</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">Substring</span>(<span class="params"><span class="built_in">int</span> startIndex</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">Substring</span>(<span class="params"><span class="built_in">int</span> startIndex, <span class="built_in">int</span> length</span>)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> filename = <span class="string">&quot;program.cs&quot;</span>;</span><br><span class="line">Console.WriteLine(filename.Substring(filename.IndexOf(<span class="string">&quot;.&quot;</span>))); <span class="comment">//扩展名</span></span><br><span class="line">Console.WriteLine(filename.Substring(<span class="number">0</span>, filename.IndexOf(<span class="string">&quot;.&quot;</span>))); <span class="comment">//文件名</span></span><br></pre></td></tr></table></figure>
<h3 id="分割字串"><a href="#分割字串" class="headerlink" title="分割字串"></a>分割字串</h3><p>将字串按照指定的符号分割成数组</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">string</span>[] <span class="title">Split</span>(<span class="params"><span class="keyword">params</span> <span class="built_in">char</span>[] separator</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">string</span>[] <span class="title">Split</span>(<span class="params"><span class="built_in">char</span>[] separator, <span class="built_in">int</span> count</span>)	<span class="comment">//指定分割数量</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> str_sep = <span class="string">&quot;123, 456; byd&quot;</span>;</span><br><span class="line"><span class="built_in">string</span>[] str_asep = str_sep.Split(<span class="keyword">new</span> <span class="built_in">char</span>[] &#123; <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;;&#x27;</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//指定分割的个数</span></span><br><span class="line"><span class="built_in">string</span> str_sep = <span class="string">&quot;123, 456; byd&quot;</span>;</span><br><span class="line"><span class="built_in">string</span>[] str_asep = str_sep.Split(<span class="keyword">new</span> <span class="built_in">char</span>[] &#123; <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;;&#x27;</span> &#125;, <span class="number">2</span>);</span><br></pre></td></tr></table></figure>
<h3 id="插入字串"><a href="#插入字串" class="headerlink" title="插入字串"></a>插入字串</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">Insert</span>(<span class="params"><span class="built_in">int</span> startIdenx, <span class="built_in">string</span> <span class="keyword">value</span></span>)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> str_sep = <span class="string">&quot;123,456;byd&quot;</span>;</span><br><span class="line"><span class="built_in">string</span> new_str = str_sep.Insert(<span class="number">4</span>, <span class="string">&quot;xyz;&quot;</span>);</span><br><span class="line">Console.WriteLine(new_str);</span><br></pre></td></tr></table></figure>
<h3 id="删除字串"><a href="#删除字串" class="headerlink" title="删除字串"></a>删除字串</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">Remove</span>(<span class="params"><span class="built_in">int</span> startIndex</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">Remove</span>(<span class="params"><span class="built_in">int</span> startIndex, <span class="built_in">int</span> count</span>) <span class="comment">// 指定删除字符数</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> str_sep = <span class="string">&quot;123,456;byd&quot;</span>;</span><br><span class="line"><span class="built_in">string</span> new_str1 = str_sep.Remove(<span class="number">4</span>);</span><br><span class="line"><span class="built_in">string</span> new_str2 = str_sep.Remove(<span class="number">4</span>, <span class="number">3</span>);</span><br><span class="line">Console.WriteLine(new_str1);</span><br><span class="line">Console.WriteLine(new_str2);</span><br></pre></td></tr></table></figure>
<h3 id="复制字串"><a href="#复制字串" class="headerlink" title="复制字串"></a>复制字串</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">Copy</span>(<span class="params"><span class="built_in">string</span> str</span>) <span class="comment">//完整赋值</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">CopyTo</span>(<span class="params"><span class="built_in">int</span> sourceIndex, <span class="built_in">char</span>[] destination, <span class="built_in">int</span> destinationIndex, <span class="built_in">int</span> count</span>)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> str_sep = <span class="string">&quot;123,456;byd&quot;</span>;</span><br><span class="line"><span class="built_in">char</span>[] chars = <span class="keyword">new</span> <span class="built_in">char</span>[<span class="number">10</span>];</span><br><span class="line">str_sep.CopyTo(str_sep.IndexOf(<span class="string">&quot;456&quot;</span>), chars, <span class="number">0</span>, <span class="number">4</span>);</span><br><span class="line">Console.WriteLine(chars);</span><br></pre></td></tr></table></figure>
<h3 id="替换字符"><a href="#替换字符" class="headerlink" title="替换字符"></a>替换字符</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">Replace</span>(<span class="params"><span class="built_in">char</span> Oldchar, <span class="built_in">char</span> Newchar</span>)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> str_rp = str_sep.Replace(<span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;;&#x27;</span>);</span><br><span class="line"><span class="built_in">string</span> str_rp1 = str_sep.Replace(<span class="string">&quot;456&quot;</span>, <span class="string">&quot;789&quot;</span>);</span><br><span class="line">Console.WriteLine(str_rp);</span><br></pre></td></tr></table></figure>
<h3 id="可变字串类"><a href="#可变字串类" class="headerlink" title="可变字串类"></a>可变字串类</h3><p>string 类型的对象，当我们对其进行拼接等操作时，其总是在内存中重新申请一块空间来存储操作后的对象；倘若我们需要大量重复此类操作，会导致开销过大。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2023/08/11/d9FckLRXDThvt1I.png" alt="image-20230811161655671"></p>
<p>为此，引入 stringBuilder 可变字串类，该类位于 System.Text 命名空间，效率更高。</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">StringBuilder</span>()</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">StringBuilder</span>(<span class="params"><span class="built_in">int</span> capacity</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">StringBuilder</span>(<span class="params"><span class="built_in">string</span> <span class="keyword">value</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">StringBuilder</span>(<span class="params"><span class="built_in">int</span> capacity, <span class="built_in">int</span> maxCapacity</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">StringBuilder</span>(<span class="params"><span class="built_in">string</span> <span class="keyword">value</span>, <span class="built_in">int</span> capacity</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">StringBuilder</span>(<span class="params"><span class="built_in">string</span> <span class="keyword">value</span>, <span class="built_in">int</span> startIndex, <span class="built_in">int</span> length, <span class="built_in">int</span> capacity</span>)</span></span><br></pre></td></tr></table></figure>
<p>该类常见的几种方法如下：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2023/08/11/J3dquMSokT49NEZ.png" alt="image-20230811161952603"></p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">StringBuilder strbu = <span class="keyword">new</span> StringBuilder(<span class="string">&quot;(), (), (), 2, 4, 6, 7, 8&quot;</span>);</span><br><span class="line">strbu.Remove(<span class="number">0</span>, <span class="number">11</span>);</span><br><span class="line">Console.WriteLine(strbu);</span><br><span class="line">strbu.Insert(<span class="number">0</span>, <span class="string">&quot;(门前大桥下), (游过一群鸭), (快来快来数一数),&quot;</span>);</span><br><span class="line">Console.WriteLine(strbu);</span><br></pre></td></tr></table></figure>
<p>不变与可变字串在操作次数较大时耗时差异明显：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> str_op = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="built_in">long</span> start_time = DateTime.Now.Millisecond;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10000</span>; i++)</span><br><span class="line">    str_op += i;</span><br><span class="line"><span class="built_in">long</span> end_time = DateTime.Now.Millisecond;</span><br><span class="line"><span class="built_in">long</span> lost_time = end_time - start_time;</span><br><span class="line">Console.WriteLine(lost_time);   <span class="comment">//32ms</span></span><br><span class="line"></span><br><span class="line">StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">start_time = DateTime.Now.Millisecond;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10000</span>; i++)</span><br><span class="line">    sb.Append(i);</span><br><span class="line">end_time = DateTime.Now.Millisecond;</span><br><span class="line"><span class="built_in">long</span> lost_time2 = end_time - start_time;</span><br><span class="line">Console.WriteLine(lost_time2);  <span class="comment">//1ms</span></span><br></pre></td></tr></table></figure>
<h2 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h2><h3 id="常用符号"><a href="#常用符号" class="headerlink" title="常用符号"></a>常用符号</h3><ul>
<li><p>行限定符</p>
<ul>
<li>行的开始：^</li>
<li>行的结尾：$</li>
</ul>
</li>
<li><p>元字符</p>
<ul>
<li>.：匹配除换行符以外的任意字符</li>
<li>\w：匹配字母、数字、下划线</li>
<li>\s：匹配任意的空白符</li>
<li>\b：匹配单词的开始或结束</li>
<li>\d：匹配数字</li>
</ul>
</li>
<li><p>限定符</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2023/08/11/vSrRCB2UpxuKkwm.png" alt="image-20230811164155253"></p>
</li>
<li><p>字符类</p>
<p>在方括号中列出</p>
<ul>
<li>[aeiou]：匹配任何一个元音首字母</li>
<li>[.?!]：匹配标点符号. ? !</li>
<li>[\u4e00-\u9fa5]：匹配给定字串中的任意一个汉字</li>
<li>[\u4e00-\u9fa5]+：匹配连续多个汉族</li>
</ul>
</li>
<li><p>排除字符</p>
<p><sup><a href="#fn_a-zA-Z" id="reffn_a-zA-Z">a-zA-Z</a></sup>：排除所有字母</p>
</li>
<li><p>选择字符：[ | ]</p>
</li>
<li>分组：()</li>
</ul>
<h3 id="C-与正则表达式"><a href="#C-与正则表达式" class="headerlink" title="C# 与正则表达式"></a>C# 与正则表达式</h3><ul>
<li>命名空间：<code>System.Text.RegularExpressions</code> </li>
<li>类名：Regex</li>
<li>方法：IsMatch、Match、Matches、Replace、Split</li>
</ul>
<h1 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h1><h2 id="一维数组"><a href="#一维数组" class="headerlink" title="一维数组"></a>一维数组</h2><p>数组定义时指定的大小必须初始化</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span>[] arr = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">5</span>] &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;; <span class="comment">//错误</span></span><br><span class="line"><span class="built_in">int</span>[] arr = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">5</span>] &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;; </span><br><span class="line"><span class="built_in">int</span>[] arr = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;; </span><br></pre></td></tr></table></figure>
<h2 id="二维数组"><a href="#二维数组" class="headerlink" title="二维数组"></a>二维数组</h2><ul>
<li><p>二维数组的定义</p>
<ul>
<li><p>直接指定行列：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span>[,]  arr = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">2</span>, <span class="number">4</span>]; <span class="comment">// 2行 4列</span></span><br></pre></td></tr></table></figure>
<ul>
<li>只指定行，再为每行指定列，且每行列数可不同（不规则数组）：</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span>[][] arr = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">2</span>][];	<span class="comment">//该方式只能指定行数</span></span><br><span class="line">arr[<span class="number">0</span>] = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">2</span>];	<span class="comment">// 为每行单独指定列</span></span><br><span class="line">arr[<span class="number">1</span>] = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">3</span>];</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>二维数组的初始化</p>
<ul>
<li><p>给每一行每一列分别赋值</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span>[,] arr = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">2</span>,<span class="number">2</span>];</span><br><span class="line">arr[<span class="number">0</span>, <span class="number">1</span>] = <span class="number">0</span>; arr[<span class="number">0</span>, <span class="number">1</span>] = <span class="number">1</span>; arr[<span class="number">1</span>, <span class="number">0</span>] = <span class="number">3</span>; arr[<span class="number">1</span>, <span class="number">1</span>] = <span class="number">4</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>给每一维数组赋值</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span>[][] arr = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">2</span>][];</span><br><span class="line">arr[<span class="number">0</span>] = <span class="keyword">new</span> <span class="built_in">int</span>[] &#123; <span class="number">0</span>, <span class="number">1</span> &#125;;</span><br><span class="line">arr[<span class="number">1</span>] = <span class="keyword">new</span> <span class="built_in">int</span>[] &#123; <span class="number">2</span>, <span class="number">3</span> &#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>声明时初始化</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span>[,] arr1 = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">2</span>, <span class="number">2</span>] &#123; &#123; <span class="number">1</span>, <span class="number">0</span> &#125;, &#123; <span class="number">1</span>, <span class="number">2</span> &#125; &#125;;</span><br><span class="line"><span class="built_in">int</span>[,] arr2 = <span class="keyword">new</span> <span class="built_in">int</span>[,] &#123; &#123; <span class="number">1</span>, <span class="number">0</span> &#125;, &#123; <span class="number">1</span>, <span class="number">2</span> &#125; &#125;;</span><br><span class="line"><span class="built_in">int</span>[,] arr3 = &#123; &#123; <span class="number">1</span>, <span class="number">0</span> &#125;, &#123; <span class="number">1</span>, <span class="number">2</span> &#125; &#125;;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="ArrayList-类"><a href="#ArrayList-类" class="headerlink" title="ArrayList 类"></a>ArrayList 类</h2><ul>
<li><p>本质就是容器，一种动态数组</p>
</li>
<li><p>使用：创建 ArrayList 对象</p>
</li>
<li>内部的元素类型可不一致</li>
<li>操作：<ul>
<li>添加：Add（从最后添加）、Insert（指定位置插入）</li>
<li>遍历：foreach</li>
<li>删除：Remove（移除第一个匹配项）、RemoveAt、RemoveRange、Clear</li>
<li>查找：Contains（完全匹配）、IndexOf、LastIndexOf（从后往前查找，返回索引）</li>
</ul>
</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">ArrayList al = <span class="keyword">new</span> ArrayList();</span><br><span class="line">al.Add(<span class="number">1</span>);</span><br><span class="line">al.Add(<span class="number">2</span>);</span><br><span class="line">al.Add(<span class="number">2</span>);</span><br><span class="line">al.Add(<span class="number">2</span>);</span><br><span class="line">al.Add(<span class="string">&quot;AL&quot;</span>);</span><br><span class="line">al.Insert(<span class="number">2</span>, <span class="string">&quot;Insert&quot;</span>);</span><br><span class="line">al.Remove(<span class="number">2</span>);</span><br><span class="line">al.RemoveAt(<span class="number">2</span>);</span><br><span class="line">al.RemoveRange(<span class="number">2</span>, <span class="number">2</span>);</span><br><span class="line">al.Clear();</span><br><span class="line">Console.WriteLine(al.Count == <span class="number">0</span>);</span><br><span class="line">Console.WriteLine(al.Contains(<span class="number">5</span>));</span><br><span class="line">Console.WriteLine(al.IndexOf(<span class="string">&quot;AL&quot;</span>));</span><br><span class="line">Console.WriteLine(al.LastIndexOf(<span class="string">&quot;AL&quot;</span>));</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> p <span class="keyword">in</span> al)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(p);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="哈希表"><a href="#哈希表" class="headerlink" title="哈希表"></a>哈希表</h1><ul>
<li><p>本质：Hashtable<key, value></p>
</li>
<li><p>方法：</p>
<ul>
<li>Add(K key, V value)：将键值数据存入哈希表</li>
<li>Contains/ContainsKey(object  key)：查找哈希表中是否存在某个键</li>
<li>Remove(object key)：删除指定的键</li>
<li>ContainsValue(object value)：查找哈希表中是否存在某个值</li>
</ul>
</li>
<li><p>获取哈希表中的键值：DictionaryEntry 结构</p>
</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Hashtable hashtable = <span class="keyword">new</span> Hashtable();</span><br><span class="line">hashtable.Add(<span class="number">1</span>, <span class="string">&quot;a&quot;</span>);</span><br><span class="line">hashtable.Add(<span class="number">2</span>, <span class="string">&quot;b&quot;</span>);</span><br><span class="line">hashtable.Add(<span class="number">3</span>, <span class="string">&quot;c&quot;</span>);</span><br><span class="line">hashtable.Remove(<span class="number">1</span>);</span><br><span class="line">Console.WriteLine(hashtable.Contains(<span class="number">2</span>));</span><br><span class="line">Console.WriteLine(hashtable.ContainsKey(<span class="number">3</span>));</span><br><span class="line">Console.WriteLine(hashtable.ContainsValue(<span class="string">&quot;d&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (DictionaryEntry entry <span class="keyword">in</span> hashtable)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;#<span class="subst">&#123;entry.Key&#125;</span> is <span class="subst">&#123;entry.Value&#125;</span>&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="方法的定义、调用和调试"><a href="#方法的定义、调用和调试" class="headerlink" title="方法的定义、调用和调试"></a>方法的定义、调用和调试</h1><h2 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h2><ul>
<li><p>方法（成员函数）是类或结构体的成员</p>
</li>
<li><p>隐藏复杂的逻辑、大算法分解为小算法、代码复用</p>
</li>
<li><p>C# 中声明定义不分家（不同于 C++ 分为头文件和源文件）</p>
</li>
<li><p>方法名为动词或动词短语，且每个单词首字母大写</p>
</li>
<li><strong>以 static 修饰时，为静态变量，该成员函数属于类；其他的方法属于对象</strong></li>
</ul>
<h2 id="构造器"><a href="#构造器" class="headerlink" title="构造器"></a>构造器</h2><ul>
<li>即构造函数</li>
<li>直接敲 ctor 命令可直接生成一个构造函数代码片段</li>
<li>构造器内存原理<ul>
<li>若构造函数内部变量类型也是类（如 string），则会在构造时继续在堆中开辟新内存，并将其首地址存储在先前开辟内存中</li>
</ul>
</li>
</ul>
<h2 id="方法的重载"><a href="#方法的重载" class="headerlink" title="方法的重载"></a>方法的重载</h2><ul>
<li>方法名一致，方法签名（方法名称、参数个数、参数类型）、类型形参（模板，泛型编程）、参数种类不一致</li>
<li><p>不包含 返回值类型</p>
</li>
<li><p>构造函数也可重载</p>
</li>
</ul>
<h2 id="方法的调用与栈"><a href="#方法的调用与栈" class="headerlink" title="方法的调用与栈"></a>方法的调用与栈</h2><p>方法调用时栈内存的分配</p>
<ul>
<li>call stack：调用堆栈，用于显示方法之间的调用关系</li>
<li><p>stack frame：方法被调用时在栈内存中的布局</p>
</li>
<li><p>方法的参数归调用者管辖，且参数按顺序压入栈</p>
</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Windows.Forms;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Csharptest</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">test</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">double</span> x = <span class="number">10</span>, y = <span class="number">20</span>;</span><br><span class="line">            Calculator cal = <span class="keyword">new</span> Calculator();</span><br><span class="line">            Console.WriteLine(cal.GetCylinderVolume(x, y));	<span class="comment">// 此处的 x y 属于 Main 栈，并按从左至右的顺序压入栈中</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title">Calculator</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="built_in">double</span> <span class="title">Getcirclearea</span>(<span class="params"><span class="built_in">double</span> r</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> Math.PI * r * r;	<span class="comment">//返回值暂存于 CPU 寄存器中</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="built_in">double</span> <span class="title">GetCylinderVolume</span>(<span class="params"><span class="built_in">double</span> r, <span class="built_in">double</span> h</span>)</span> </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> Getcirclearea(r) * h;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="操作符"><a href="#操作符" class="headerlink" title="操作符"></a>操作符</h1><h2 id="操作符概览"><a href="#操作符概览" class="headerlink" title="操作符概览"></a>操作符概览</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img2022.cnblogs.com/blog/2726978/202201/2726978-20220119230614920-518441705.png" alt="img"></p>
<h2 id="操作符的本质"><a href="#操作符的本质" class="headerlink" title="操作符的本质"></a>操作符的本质</h2><ul>
<li>函数或算法的简记法</li>
<li>不能脱离数据的类型</li>
</ul>
<p>举例：方法的定义和调用的常规的写法如下：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Csharptest</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">test</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Person p1 = <span class="keyword">new</span> Person();</span><br><span class="line">            Person p2 = <span class="keyword">new</span> Person();</span><br><span class="line">            p1.name = <span class="string">&quot;B&quot;</span>;</span><br><span class="line">            p2.name = <span class="string">&quot;YD&quot;</span>;</span><br><span class="line">            List&lt;Person&gt; list = Person.Getmarry(p1, p2);</span><br><span class="line">            <span class="comment">//List&lt;Person&gt; list = p1 + p2; //通过操作符调用</span></span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> p <span class="keyword">in</span> list)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(p.name);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title">Person</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> name;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;Person&gt; <span class="title">Getmarry</span>(<span class="params">Person p1, Person p2</span>)</span></span><br><span class="line"><span class="function">        <span class="comment">//public static List&lt;Person&gt; operator+ (Person p1, Person p2)//操作符定义</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            List&lt;Person&gt; list = <span class="keyword">new</span> List&lt;Person&gt;();</span><br><span class="line">            list.Add(p1);</span><br><span class="line">            list.Add(p2);</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                Person child = <span class="keyword">new</span> Person();</span><br><span class="line">                child.name = p1.name + <span class="string">&quot;&amp;&quot;</span> + p2.name + <span class="string">&quot;&#x27;s child&#x27;&quot;</span>;</span><br><span class="line">                list.Add(child);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> list;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>而该方法可通过运算符简化，只需将 方法名 Getmarry 改为 operator+ 即可，主函数中调用时不再通过方法名调用，而是直接采用自定义的操作符 + 调用即可。</p>
<h2 id="操作符的优先级"><a href="#操作符的优先级" class="headerlink" title="操作符的优先级"></a>操作符的优先级</h2><ul>
<li>可通过括号提升优先级</li>
<li>带赋值功能操作符的运算顺序是由右向左</li>
<li>没有结合律，同级运算统一从左至右</li>
</ul>
<h2 id="操作符-1"><a href="#操作符-1" class="headerlink" title="操作符"></a>操作符</h2><p><strong>注：以下均为操作符，并不做关键字看待</strong></p>
<h3 id="基本操作符"><a href="#基本操作符" class="headerlink" title="基本操作符"></a>基本操作符</h3><ul>
<li><p>元素访问操作符</p>
<ul>
<li><p>数组元素访问</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span>[] array = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">10</span>];	<span class="comment">// 创建但不初始化</span></span><br><span class="line"><span class="built_in">int</span>[] array2 = <span class="keyword">new</span> <span class="built_in">int</span>[]&#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span> &#125;;	<span class="comment">// 创建且初始化</span></span><br><span class="line">Console.WriteLine(array2.Length);</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> i <span class="keyword">in</span> array2)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>字典元素访问</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Dictionary&lt;<span class="built_in">string</span>, student&gt; SDic = <span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, student&gt;();</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">    student stud = <span class="keyword">new</span> student();</span><br><span class="line">    stud.name = <span class="string">&quot;s_&quot;</span> + i.ToString();</span><br><span class="line">    stud.age = i + <span class="number">100</span>;</span><br><span class="line">    SDic.Add(stud.name, stud);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">student nameage = SDic[<span class="string">&quot;s_6&quot;</span>];</span><br><span class="line">Console.WriteLine(nameage.age);</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>new 操作符</p>
<ul>
<li><p>构造实例</p>
</li>
<li><p>初始化实例</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Form myform = <span class="keyword">new</span> Form() &#123; Text = <span class="string">&quot;MY&quot;</span> &#125;;	<span class="comment">//带初始化</span></span><br><span class="line"><span class="comment">//myform.Text = &quot;my&quot;;</span></span><br><span class="line">myform.ShowDialog();</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建匿名类型</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person = <span class="keyword">new</span> &#123; name = <span class="string">&quot;BYD&quot;</span>, age = <span class="number">20</span> &#125;;	<span class="comment">//自动类型推断</span></span><br><span class="line">Console.WriteLine(person.name);</span><br><span class="line">Console.WriteLine(person.age);</span><br><span class="line">Console.WriteLine(person.GetType().Name);</span><br><span class="line"><span class="comment">//&lt;&gt;f__AnonymousType0`2 // 0 表示自己创建类型的编号，2 表示该类型有两个参数</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>checked、unchecked</p>
<ul>
<li><p>检查或不检查是否溢出</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">uint</span> e = <span class="built_in">uint</span>.MaxValue;</span><br><span class="line">Console.WriteLine(e);</span><br><span class="line"><span class="built_in">string</span> stre = Convert.ToString(e, <span class="number">2</span>);</span><br><span class="line">Console.WriteLine(stre);</span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">uint</span> f = checked(e + <span class="number">1</span>);	<span class="comment">// e 已经是最大值了，加 1 肯定溢出，若为 unchecked，则不再检查溢出</span></span><br><span class="line">    Console.WriteLine(f);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (OverflowException ex)	<span class="comment">// 捕获溢出</span></span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;EX Catched&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>检查上下文溢出，在包围域中的所有都会被检查</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">checked</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">uint</span> f = e + <span class="number">1</span>;</span><br><span class="line">        Console.WriteLine(f);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (OverflowException ex)</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;EX Catched&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>delegate </p>
<p>做操作符已被 lambda 表达式替代，以 wpf 程序为例说明</p>
<p>常规写法：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">partial</span> <span class="keyword">class</span> <span class="title">MainWindow</span> : <span class="title">Window</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MainWindow</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        InitializeComponent();</span><br><span class="line">        <span class="keyword">this</span>.mybutton.Click += Mybutton_Click; <span class="comment">//常规</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Mybutton_Click</span>(<span class="params"><span class="built_in">object</span> sender, RoutedEventArgs e</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.mybox.Text = <span class="string">&quot;BYD&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用 delegate 操作符：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">partial</span> <span class="keyword">class</span> <span class="title">MainWindow</span> : <span class="title">Window</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MainWindow</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        InitializeComponent();</span><br><span class="line">        <span class="comment">//this.mybutton.Click += Mybutton_Click; //常规</span></span><br><span class="line">        <span class="keyword">this</span>.mybutton.Click += <span class="built_in">delegate</span> (<span class="built_in">object</span> sender, RoutedEventArgs e)	</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.mybox.Text = <span class="string">&quot;BYD&quot;</span>;</span><br><span class="line">        &#125;;	<span class="comment">//注意分号</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用 lambda 表达式（推荐）：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">partial</span> <span class="keyword">class</span> <span class="title">MainWindow</span> : <span class="title">Window</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MainWindow</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        InitializeComponent();</span><br><span class="line">        <span class="keyword">this</span>.mybutton.Click += (sender, e) =&gt;</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.mybox.Text = <span class="string">&quot;BYD&quot;</span>;</span><br><span class="line">        &#125;;	<span class="comment">//注意分号</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>-&gt; 操作符</p>
<p>由于 C# 有指针，但不建议使用，故操作指针时需放在 unsafe 环境下才行，且只能操作结构体类型</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unsafe</span> <span class="comment">//且需在项目-属性-生成-勾选 不安全代码</span></span><br><span class="line">&#123; </span><br><span class="line">    mystru stru = <span class="keyword">new</span> mystru();</span><br><span class="line">    stru.ID = <span class="number">1</span>;</span><br><span class="line">    stru.name = <span class="string">&quot;Test&quot;</span>;</span><br><span class="line">    mystru* pstru = &amp;stru;</span><br><span class="line">    pstru-&gt;ID = <span class="number">2</span>;	<span class="comment">// (*pstru).ID = 2;</span></span><br><span class="line">    pstru-&gt;name = <span class="string">&quot;pointer&quot;</span>;	<span class="comment">// (*pstru).name = &quot;pointer&quot;;</span></span><br><span class="line">    Console.WriteLine(stru.ID);</span><br><span class="line">    Console.WriteLine(stru.name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="单目操作符"><a href="#单目操作符" class="headerlink" title="单目操作符"></a>单目操作符</h3><ul>
<li><p>*：解引用</p>
<p>接前序例子，由于 . 操作符的优先级高于 <em>，故通过加括号方式提升优先级，如 (\</em>pstru).ID = 2</p>
</li>
<li><p>!：取反操作符</p>
<ul>
<li><p>按位取反</p>
</li>
<li><p>条件取反</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">human</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">human</span>(<span class="params"><span class="built_in">string</span> name</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">string</span>.IsNullOrEmpty(name))    <span class="comment">//取反操作符的应用</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.name = name;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;name can&#x27;t be null&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> ID;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//此时构造对象时传入空串将抛异常</span></span><br><span class="line">human hu1 = <span class="keyword">new</span> human(<span class="literal">null</span>);	<span class="comment">//抛异常</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>强制类型转换操作符</p>
<ul>
<li><p>隐式类型转换</p>
<ul>
<li>不丢失精度的转换</li>
<li>子类向父类的转换：转换时只能访问到该变量的类型所具有的类型</li>
<li>装箱</li>
</ul>
</li>
<li><p>显示类型转换</p>
<ul>
<li><p>可能丢失精度甚至发生错误的转换，即 cast，(T)varibable</p>
</li>
<li><p>拆箱</p>
</li>
<li><p>使用 Convert 类</p>
<ul>
<li><p>如将字串转数值类型</p>
<ul>
<li><p>Convert 类：Convert.ToSth</p>
</li>
<li><p>各类数据类型的 Parse/TryParse 方法</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> str = <span class="string">&quot;50&quot;</span>;</span><br><span class="line"><span class="built_in">double</span> k = <span class="built_in">double</span>.Parse(str);</span><br></pre></td></tr></table></figure>
<p>但 Parse 只接受正确的数据格式：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> str2 = <span class="string">&quot;50ab3&quot;</span></span><br><span class="line"><span class="built_in">double</span> j = <span class="built_in">double</span>.Parse(str2);	<span class="comment">//System.FormatException: 输入字串格式不正确</span></span><br></pre></td></tr></table></figure>
<p>可采用 TryParse 方法，返回值表征是否转换成功</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> str3 = <span class="string">&quot;50ab3&quot;</span>;</span><br><span class="line"><span class="built_in">double</span> result;</span><br><span class="line"><span class="built_in">bool</span> success = <span class="built_in">double</span>.TryParse(str3, <span class="keyword">out</span> result);</span><br><span class="line">Console.WriteLine(success);	<span class="comment">//False</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>数值转字串时，可采用 Convert 类的静态方法或数值数据的实例方法</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> str1 = <span class="string">&quot;50&quot;</span>;</span><br><span class="line"><span class="built_in">string</span> str2 = <span class="string">&quot;60&quot;</span>;</span><br><span class="line"><span class="built_in">double</span> x = Convert.ToDouble(str1);</span><br><span class="line"><span class="built_in">double</span> y = Convert.ToDouble(str2);</span><br><span class="line"><span class="built_in">double</span> sum = x + y;</span><br><span class="line">Console.WriteLine(sum);</span><br><span class="line">Console.WriteLine(Convert.ToString(sum));<span class="comment">//Convert类的静态方法</span></span><br><span class="line">Console.WriteLine(sum.ToString());<span class="comment">// 数值的实例方法</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>显示类型转换操作符</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Csharptest</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">test</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Stone stone = <span class="keyword">new</span> Stone();</span><br><span class="line">            <span class="comment">//Monkey mk = (Monkey)stone;	//石头转为孙猴子，但编译器并不知道该转换，需在被转换类中定义</span></span><br><span class="line">            stone.age = <span class="number">5000</span>;</span><br><span class="line">            Monkey mk = (Monkey)stone;</span><br><span class="line">            Console.WriteLine(mk.age);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">Stone</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> age;</span><br><span class="line">   	<span class="comment">//显式转换</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">explicit</span> <span class="keyword">operator</span> <span class="title">Monkey</span>(<span class="params">Stone stone</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Monkey mk = <span class="keyword">new</span> Monkey();</span><br><span class="line">		mk.age = stone.age / <span class="number">500</span>;</span><br><span class="line">        <span class="keyword">return</span> mk;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Monkey</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上述显式转换可改为隐式转换，只需更换关键字即可：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 隐式转换</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">implicit</span> <span class="keyword">operator</span> <span class="title">Monkey</span>(<span class="params">Stone stone</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    Monkey mk = <span class="keyword">new</span> Monkey();</span><br><span class="line">	mk.age = stone.age / <span class="number">500</span>;</span><br><span class="line">    <span class="keyword">return</span> mk;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用时直接赋值，包含了隐式转换</span></span><br><span class="line">Monkey mk = stone;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>自定义类型转换</p>
</li>
</ul>
</li>
<li><p>移位操作符</p>
<ul>
<li>左移：左移一位等同于 *2</li>
<li>右移：右移一位等同于 /2</li>
</ul>
</li>
<li><p>is、as</p>
<p>as：类似强制类型转换，转换不成功返回 null</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">student stude = <span class="keyword">new</span> student();</span><br><span class="line"><span class="keyword">var</span> re = stude <span class="keyword">is</span> student;</span><br><span class="line">Console.WriteLine(re.GetType().FullName);</span><br><span class="line">Console.WriteLine(re);</span><br><span class="line"></span><br><span class="line"><span class="built_in">object</span> obj = <span class="keyword">new</span> student();</span><br><span class="line">student person = obj <span class="keyword">as</span> student;</span><br><span class="line"><span class="keyword">if</span> (person != <span class="literal">null</span>)</span><br><span class="line">&#123;</span><br><span class="line">    person.age = <span class="number">15</span>;</span><br><span class="line">    Console.WriteLine(person.age);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>null 合并</p>
<p>某些情况下我们需要对变量赋空值，此时须通过可控类型实现，C# 将其以关键字 ? 代替</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Nullable&lt;int&gt; p = null;</span></span><br><span class="line"><span class="comment">//等价于</span></span><br><span class="line"><span class="built_in">int</span>? p = <span class="literal">null</span>;</span><br><span class="line"><span class="comment">//p = 100;</span></span><br><span class="line">Console.WriteLine(p.HasValue);</span><br><span class="line"></span><br><span class="line"><span class="comment">// null 合并操作符</span></span><br><span class="line"><span class="built_in">int</span> y = x ?? <span class="number">1</span>;	<span class="comment">// x 是 null 则赋值 1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>条件操作符</p>
<p>if 语句的简写</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> x = <span class="number">50</span>;</span><br><span class="line"><span class="built_in">string</span> str = (x &gt; <span class="number">60</span>) ? <span class="string">&quot;及格&quot;</span> : <span class="string">&quot;挂科&quot;</span>;</span><br><span class="line">Console.WriteLine(str);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="表达式、语句"><a href="#表达式、语句" class="headerlink" title="表达式、语句"></a>表达式、语句</h1><ul>
<li>算法逻辑的最小单元，表达一定的算法意图</li>
<li>操作符有优先级，故表达式亦有优先级</li>
</ul>
<p>常用的块语句：</p>
<ul>
<li><p>try…catch…[finally]</p>
<p>可自定义异常消息提示：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="keyword">using</span> System.Threading.Tasks;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">CSharptest2</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Calculator cal = <span class="keyword">new</span> Calculator();</span><br><span class="line">            Console.WriteLine(cal.Add(<span class="string">&quot;999999999999999&quot;</span>, <span class="string">&quot;100&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title">Calculator</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">Add</span>(<span class="params"><span class="built_in">string</span> str1, <span class="built_in">string</span> str2</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">int</span> a = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">int</span> b = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                a = <span class="built_in">int</span>.Parse(str1);</span><br><span class="line">                b = <span class="built_in">int</span>.Parse(str2);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (ArgumentNullException)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;Argument can&#x27;t be NULL&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (FormatException)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;Argument Format Wrong&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span>(OverflowException) </span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;Out of Range&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">         </span><br><span class="line">            <span class="keyword">return</span> a + b; </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>也可通过异常实例带出异常的具体信息</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">catch</span> (ArgumentNullException ane)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(ane.Message);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (FormatException fe)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(fe.Message);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span>(OverflowException of) </span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(of.Message);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>若在 catch 中不想处理该异常，则可通过 throw 关键字抛出异常，由调用者自行处理异常。</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="keyword">using</span> System.Threading.Tasks;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">CSharptest2</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Calculator cal = <span class="keyword">new</span> Calculator();</span><br><span class="line">            <span class="built_in">int</span> reslut = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                reslut = cal.Add(<span class="string">&quot;99999999999999&quot;</span>, <span class="string">&quot;100&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (OverflowException oe)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(oe.Message);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title">Calculator</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">Add</span>(<span class="params"><span class="built_in">string</span> str1, <span class="built_in">string</span> str2</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">int</span> a = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">int</span> b = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                a = <span class="built_in">int</span>.Parse(str1);</span><br><span class="line">                b = <span class="built_in">int</span>.Parse(str2);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (ArgumentNullException ane)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(ane.Message);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (FormatException fe)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(fe.Message);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span>(OverflowException of) </span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">throw</span> of;	<span class="comment">//抛出由调用者处理</span></span><br><span class="line">            &#125;</span><br><span class="line">         </span><br><span class="line">            <span class="keyword">return</span> a + b; </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>throw 关键字的语法是灵活的，可不实例化：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">catch</span>(OverflowException of) </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">throw</span> of;	<span class="comment">//抛出由调用者处理</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//等同于</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">catch</span>(OverflowException) </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">throw</span>;	<span class="comment">//抛出由调用者处理</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>foreach：是迭代器的简记，主要用于对集合的遍历</p>
<ul>
<li>foreach 中的变量是只读的</li>
<li>不能在内部修改实例的值</li>
<li>当泛型实例是类时，可通过其修改类的属性</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">List&lt;<span class="built_in">int</span>&gt; list = <span class="keyword">new</span> List&lt;<span class="built_in">int</span>&gt;() &#123; <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>&#125;;</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> list)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//item = 1; //只读，不可修改</span></span><br><span class="line">    <span class="comment">//list.Remove(item);  //不能在循环内修改内部值</span></span><br><span class="line">    <span class="comment">//泛型是对象，则可赋值</span></span><br><span class="line">    Console.WriteLine(item);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//当 List 泛型实例是类时，可通过其修改</span></span><br><span class="line">List&lt;Student&gt; students = <span class="keyword">new</span> List&lt;Student&gt;();</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> students)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//item = new Student(&quot;lihao&quot;);</span></span><br><span class="line">    item.name = <span class="string">&quot;lihao&quot;</span>;</span><br><span class="line">    <span class="comment">//item.name = &quot;lihao&quot;;</span></span><br><span class="line">    Console.WriteLine(item);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Student</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Student</span>(<span class="params"><span class="built_in">string</span> name</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="字段、属性、索引器、常量"><a href="#字段、属性、索引器、常量" class="headerlink" title="字段、属性、索引器、常量"></a>字段、属性、索引器、常量</h1><h2 id="字段"><a href="#字段" class="headerlink" title="字段"></a>字段</h2><ul>
<li><p>即成员变量，属于类</p>
</li>
<li><p>字段名必须是名词</p>
</li>
<li><p>实例字段：与对象关联的字段</p>
<ul>
<li><p>初始化时机：实例被创建时</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Student</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> age = <span class="number">10</span>; <span class="comment">//声明即初始化</span></span><br><span class="line">    <span class="comment">//利用实例构造器初始化</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> age;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Student</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        age = <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>readonly：只读实例字段，在声明或创建对象时初始化，且初始化后无法被修改</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Student</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//public readonly int Id = 10; //声明即初始化</span></span><br><span class="line">    <span class="comment">//在实例构造器中初始化</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">readonly</span> <span class="built_in">int</span> Id;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Student</span>(<span class="params"><span class="built_in">int</span> id</span>)</span>	</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.Id = id;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Student stu = <span class="keyword">new</span> Student(<span class="number">6600888</span>);	<span class="comment">//创建实例时初始化且不能再被修改</span></span><br><span class="line">Console.WriteLine(stu.ID);</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>静态字段：与类关联的字段，由 static 修饰；不属于某个具体的对象，用于表征状态</p>
<ul>
<li><p>初始化时机：类被加载时（静态构造器在数据类型被运行环境加载时执行，且只执行一次）</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Student</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> age = <span class="number">10</span>; <span class="comment">//声明即初始化</span></span><br><span class="line">    <span class="comment">//利用静态构造器初始化</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> age;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="title">Student</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Student.age = <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>readonly：静态只读字段，同前</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Color</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Red;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Green;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Blue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Brush</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">readonly</span> Color DeafultColor = <span class="keyword">new</span> Color() &#123; Red = <span class="number">0</span>, Green = <span class="number">255</span>, Blue = <span class="number">0</span> &#125;; <span class="comment">//声明时初始化</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//构造器初始化</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">readonly</span> Color DeafultColor;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="title">Brush</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Brush.DeafultColor = <span class="keyword">new</span> Color() &#123; Red = <span class="number">0</span>, Green = <span class="number">0</span>, Blue = <span class="number">0</span> &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h2><h3 id="属性的由来"><a href="#属性的由来" class="headerlink" title="属性的由来"></a>属性的由来</h3><ul>
<li>反映对象的特征或状态</li>
<li>是字段的扩展</li>
<li>对外：数据可以存储在字段，亦可动态计算</li>
<li>对内：保护字段不被非法值污染</li>
</ul>
<p>最初，保护字段的方法是将 public 属性改为 private， 将数据保护起来，并设置对外的接口，C++ 采用该方法。</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Student</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">GetAge</span>()</span></span><br><span class="line">    &#123; </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SetAge</span>(<span class="params"><span class="built_in">int</span> age</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(age &gt; <span class="number">0</span> &amp;&amp; age &lt;= <span class="number">120</span>)</span><br><span class="line">            <span class="keyword">this</span>.age = age;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">&quot;Wrong age!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//调用时可捕获异常</span></span><br><span class="line"> <span class="keyword">try</span></span><br><span class="line"> &#123;</span><br><span class="line">     Student stu11 = <span class="keyword">new</span> Student();</span><br><span class="line">     stu11.SetAge(<span class="number">10</span>);</span><br><span class="line">     Student stu12 = <span class="keyword">new</span> Student();</span><br><span class="line">     stu12.SetAge(<span class="number">20</span>);</span><br><span class="line"></span><br><span class="line">     Student stu13 = <span class="keyword">new</span> Student();</span><br><span class="line">     stu13.SetAge(<span class="number">30</span>);</span><br><span class="line"></span><br><span class="line">     <span class="built_in">int</span> aveage = (stu11.GetAge() + stu12.GetAge() + stu13.GetAge()) / <span class="number">3</span>;</span><br><span class="line">     Console.WriteLine(aveage);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">catch</span> (Exception ex)</span><br><span class="line"> &#123;</span><br><span class="line">     Console.WriteLine(ex.Message);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>可见，这种方式在写法上有些冗余，故提出了 属性，也算是“语法糖”。</p>
<p>属性采用了设置器 setter 和 获取器 getter，并引入上下文关键字 value，代表由用户传入的值，出了 set/get 域之后该功能消失。</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Student3</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">int</span> age = <span class="number">10</span>;</span><br><span class="line">	<span class="comment">//属性的写法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Age  <span class="comment">//公有属性，作为 get/set 的包装器，名称遵循pascal命名</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span>	<span class="comment">//相当于前述 GetAge()</span></span><br><span class="line">        &#123; </span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.age;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">set</span>	<span class="comment">//相当于前述 SetAge()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">value</span> &gt; <span class="number">0</span> &amp;&amp; <span class="keyword">value</span> &lt;= <span class="number">120</span>)	<span class="comment">//value 关键字接受用户输入值</span></span><br><span class="line">                <span class="keyword">this</span>.age = <span class="keyword">value</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">&quot;Wrong age!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//调用时更加简洁</span></span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//Student3 stu11 = new Student3();</span></span><br><span class="line">    <span class="comment">//stu11.Age = 10; // set </span></span><br><span class="line">    <span class="comment">//上面这两句可合并为一句</span></span><br><span class="line">    Student3 stu11 = <span class="keyword">new</span> Student3() &#123; Age = <span class="number">10</span> &#125;;</span><br><span class="line">    </span><br><span class="line">    Student3 stu12 = <span class="keyword">new</span> Student3();</span><br><span class="line">    stu12.Age = <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line">    Student3 stu13 = <span class="keyword">new</span> Student3();</span><br><span class="line">    stu13.Age = <span class="number">30</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">int</span> aveage3 = (stu11.Age + stu12.Age + stu13.Age) / <span class="number">3</span>;	<span class="comment">// get</span></span><br><span class="line">    Console.WriteLine(aveage3);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (Exception ex)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(ex.Message);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>实际上，编译器是自己生成并调用了 get_Age()/set_Age(int32) 的方法，该方法由其编译属性时自动生成。</p>
<h3 id="属性的声明"><a href="#属性的声明" class="headerlink" title="属性的声明"></a>属性的声明</h3><h4 id="属性的完整声明"><a href="#属性的完整声明" class="headerlink" title="属性的完整声明"></a>属性的完整声明</h4><ul>
<li><p><em>VS 完整属性代码片段快捷操作：propfull，按两次 tab</em></p>
<p>以静态属性为例，静态属性对应的成员变量也需为静态：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Student3</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">int</span> amount;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> Amount</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span>&#123; <span class="keyword">return</span> amount; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">set</span> </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">value</span> &gt;= <span class="number">0</span>)</span><br><span class="line">                Student3.amount = <span class="keyword">value</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">&quot;Wrong Amount!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">    Student3.Amount = <span class="number">-150</span>;</span><br><span class="line">    Console.WriteLine(Student3.Amount);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (Exception ex)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(ex.Message);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="属性的简略声明"><a href="#属性的简略声明" class="headerlink" title="属性的简略声明"></a>属性的简略声明</h4><ul>
<li><em>VS 简略属性代码片段快捷操作：prop，按两次 tab</em></li>
<li>属性的简略声明在功能上 = 公有的字段，数据不受保护</li>
<li><p>一般用于传递数据，代码简单</p>
</li>
<li><p>属性的说明</p>
<ul>
<li><p>属性只有 get 时为只读属性，无法修改</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Student3</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span> name = <span class="string">&quot;XYZ&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span>&#123; <span class="keyword">return</span> <span class="keyword">this</span>.name; &#125;        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Student3 STU = <span class="keyword">new</span> Student3();</span><br><span class="line">Console.WriteLine(STU.Name);</span><br><span class="line"><span class="comment">//STU.Name = &quot;xyz&quot;; //只读，无法修改</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>属性同时有 set/get，但 get 被设置为 private，在外界无法访问，但并不是只读属性</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="built_in">string</span> name = <span class="string">&quot;XYZ&quot;</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="built_in">string</span> Name </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">get</span>&#123; <span class="keyword">return</span> <span class="keyword">this</span>.name; &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">set</span> &#123; <span class="keyword">this</span>.name = <span class="keyword">value</span>; &#125;	<span class="comment">//类外无法访问，非只读属性</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>动态计算值的属性</p>
<p>属性中的值是动态计算的</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="built_in">bool</span> CanWork</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//get &#123; return canWork; &#125;</span></span><br><span class="line">    <span class="keyword">get</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.age &gt;= <span class="number">16</span>)	<span class="comment">//根据年龄的大小动态计算</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>建议：用属性来向外暴露数据，字段应当是 private 或 protected 的</strong></p>
<h2 id="索引器-Indexer"><a href="#索引器-Indexer" class="headerlink" title="索引器 Indexer"></a>索引器 Indexer</h2><ul>
<li>集合类型特有</li>
<li>VS 快速操作：ind，tab*2</li>
</ul>
<h2 id="常量-1"><a href="#常量-1" class="headerlink" title="常量"></a>常量</h2><ul>
<li>隶属于类而非实例（对象），没有“实例常量”</li>
<li>只能是常见的数据类型，不能是类或自定义类型</li>
<li>“实例常量”的角色可由只读字段来承担</li>
<li>提高程序运行效率（编译时直接替换）</li>
<li>成员常量、局部常量</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">const</span> <span class="built_in">double</span> PI = <span class="number">3.1415926535897931</span>;	<span class="comment">//成员常量</span></span><br></pre></td></tr></table></figure>
<h2 id="“只读”场景"><a href="#“只读”场景" class="headerlink" title="“只读”场景"></a>“只读”场景</h2><ul>
<li>为提高程序的可读性和执行效率——常量</li>
<li>为防止对象的值被改变——只读字段</li>
<li>向外暴露不允许修改的字段——只读属性</li>
<li>当希望成为常量的值类型不能被常量声明接受时（类或自定义结构体）——静态只读字段（即类或自定义结构体不能由 const 修饰，而应是静态只读字段）</li>
</ul>
<h1 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h1><h2 id="传值参数"><a href="#传值参数" class="headerlink" title="传值参数"></a>传值参数</h2><ul>
<li><p>值类型作为参数：值参数（形参）只是创建了变量的副本，对值参数的操作并不会影响方法体外变量的值</p>
</li>
<li><p>引用类型作为参数：同样创建了外部变量的副本，但由于参数是引用，故该副本同样指向外部变量所指的对象，更改任何一个都将影响另一个（这种用法在实际中不常用，被称为方法的副作用，side-effect）</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">test2</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;    <span class="comment">//属性</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        test2 ts = <span class="keyword">new</span> test2();</span><br><span class="line">        ts.Name = <span class="string">&quot;Test2&quot;</span>;</span><br><span class="line">        MyMethod(ts);	<span class="comment">// 引用参数传值</span></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;&#123;0&#125;\t&#123;1&#125;&quot;</span>, ts.Name, ts.GetHashCode());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">MyMethod</span>(<span class="params">test2 ts2</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        ts2.Name = <span class="string">&quot;Test1&quot;</span>;	<span class="comment">// 指向同一对象，方法内修改，外部亦被修改</span></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;&#123;0&#125;\t&#123;1&#125;&quot;</span>, ts2.Name, ts2.GetHashCode());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但若在方法体内重新创建了对象，则方法体内变量的改变将不会对外部变量有影响</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">MyMethod</span>(<span class="params">test2 ts2</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//ts2.Name = &quot;Test2&quot;;</span></span><br><span class="line">    ts2 = <span class="keyword">new</span> test2();	<span class="comment">//重新创建了对象</span></span><br><span class="line">    ts2.Name = <span class="string">&quot;Test3&quot;</span>;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;&#123;0&#125;\t&#123;1&#125;&quot;</span>, ts2.Name, ts2.GetHashCode());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="引用参数"><a href="#引用参数" class="headerlink" title="引用参数"></a>引用参数</h2><ul>
<li><p>用 ref 修饰符声明的形参</p>
</li>
<li><p>引用形参不创建新的存储位置</p>
</li>
<li><p>值类型作为引用参数：通过 ref 修饰符显式的指出，该方法会改变实参的值</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">int</span> y = <span class="number">1</span>;</span><br><span class="line">        RefTest(<span class="keyword">ref</span> y);	<span class="comment">//传参时也需用 ref 修饰符，明确表明实参会被修改</span></span><br><span class="line">        Console.WriteLine(y);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">RefTest</span>(<span class="params"><span class="keyword">ref</span> <span class="built_in">int</span> x</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        x += <span class="number">100</span>;</span><br><span class="line">        Console.WriteLine(x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>引用类型作为引用参数：和前述类似，引用类型作为参数传入后，形参和实参指向同一个对象；但若在方法体内为引用变量赋新值或创建新的对象，则实参也会随之改变，此时形参和实参指向了新的对象</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">test3</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        test3 out_ts3 = <span class="keyword">new</span> test3();</span><br><span class="line">        out_ts3.Name = <span class="string">&quot;out_name&quot;</span>;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;&#123;0&#125;\t&#123;1&#125;&quot;</span>, out_ts3.Name, out_ts3.GetHashCode());</span><br><span class="line">        RefOfRefParam(<span class="keyword">ref</span> out_ts3);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;&#123;0&#125;\t&#123;1&#125;&quot;</span>, out_ts3.Name, out_ts3.GetHashCode());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">RefOfRefParam</span>(<span class="params"><span class="keyword">ref</span> test3 ts3</span>) <span class="comment">//引用类型作为引用参数</span></span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//ts3.Name = &quot;in_name&quot;; //只改变对象值，不创建对象，内部更改，外部实参亦更改</span></span><br><span class="line">        ts3 = <span class="keyword">new</span> test3() &#123; Name = <span class="string">&quot;in_name&quot;</span> &#125;;<span class="comment">//创建新对象后内外同时指向新对象</span></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;&#123;0&#125;\t&#123;1&#125;&quot;</span>, ts3.Name, ts3.GetHashCode());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="输出参数"><a href="#输出参数" class="headerlink" title="输出参数"></a>输出参数</h2><ul>
<li><p>用 out 修饰符修饰的形参，显式指出是通过参数向外输出值</p>
</li>
<li><p>不创建新的存储位置，类似 ref</p>
</li>
<li><p>初始值可有可无</p>
</li>
<li><p>值类型：</p>
<p>前述强制类型转换中我们提到了 TryParse 方法，该函数将数字字串转为对应类型的数字，返回值为 bool 类型，表征转换的成功与否，但我们最终需拿到转换的结果，该结果便可通过 out 输出</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> num_str = <span class="string">&quot;12306&quot;</span>;</span><br><span class="line"><span class="built_in">double</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">bool</span> IsOk = <span class="built_in">double</span>.TryParse(num_str, <span class="keyword">out</span> num);	<span class="comment">//显式表明输出</span></span><br><span class="line">Console.WriteLine(num + <span class="number">6</span>);</span><br></pre></td></tr></table></figure>
<p><em>注：TryParse 转换失败时会把原值覆盖为 0</em></p>
<p>输出参数在方法体中必须赋值，否则编译报错，如自定义一个带输出参数的方法：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> num_str = <span class="string">&quot;12306&quot;</span>;</span><br><span class="line">        <span class="built_in">double</span> num = <span class="number">0</span>;</span><br><span class="line">        DoubleParse(num_str, <span class="keyword">out</span> num);</span><br><span class="line">        Console.WriteLine(num + <span class="number">6</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">DoubleParse</span>(<span class="params"><span class="built_in">string</span> str, <span class="keyword">out</span> <span class="built_in">double</span> result</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            result = <span class="built_in">double</span>.Parse(str);	<span class="comment">//出方法体前必须给 out 变量赋值</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span></span><br><span class="line">        &#123;</span><br><span class="line">            result = <span class="number">0</span>; <span class="comment">//出方法体前必须给 out 变量赋值</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>引用类型：</p>
<p>形参和实参指向同一对象，形参赋新值后，实参和形参指向同一新对象</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">students</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span>  <span class="built_in">int</span> Age &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">studentFactory</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span>  <span class="built_in">bool</span> <span class="title">studentF</span>(<span class="params"><span class="built_in">string</span> name,  <span class="built_in">int</span> age, <span class="keyword">out</span> students stu</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        stu = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (name == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">if</span> (age &lt; <span class="number">0</span> || age &gt; <span class="number">80</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        </span><br><span class="line">        stu = <span class="keyword">new</span> students() &#123; Age = age, Name = name &#125;;</span><br><span class="line">		Console.WriteLine(<span class="string">&quot;&#123;0&#125;,&#123;1&#125;,&#123;2&#125;&quot;</span>, stu.Name, stu.Age, stu.GetHashCode());</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">students stus;</span><br><span class="line"><span class="built_in">bool</span> Isok = studentFactory.studentF(<span class="string">&quot;Tom&quot;</span>, <span class="number">20</span>, <span class="keyword">out</span> stus);</span><br><span class="line">Console.WriteLine(Isok);</span><br><span class="line">Console.WriteLine(<span class="string">&quot;&#123;0&#125;,&#123;1&#125;,&#123;2&#125;&quot;</span>, stus.Name, stus.Age, stus.GetHashCode());</span><br><span class="line"><span class="comment">//通过输出可知两者指向同一对象</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="数组参数"><a href="#数组参数" class="headerlink" title="数组参数"></a>数组参数</h2><p>常规中，假若要调用一个形参为数组的方法，必须要先声明一个数组，略显啰嗦，为此提出了 params 关键字。</p>
<p>常规写法：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span>[] arr = <span class="keyword">new</span> <span class="built_in">int</span>[] &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> &#125;;	<span class="comment">//需事先定义数组方可调用         </span></span><br><span class="line">        Console.WriteLine(ArrSum(arr));</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="built_in">int</span> <span class="title">ArrSum</span>(<span class="params"><span class="built_in">int</span>[] arr</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">var</span> i <span class="keyword">in</span> arr)</span><br><span class="line">           sum += i;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>只需在方法声明时的形参前加 params 修饰符，调用时直接传入数组元素即可（编译器会自动创建一个数组），无需再新建数组：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">    &#123;     </span><br><span class="line">        Console.WriteLine(ArrSum(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>));	<span class="comment">//直接传入数组元素</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="built_in">int</span> <span class="title">ArrSum</span>(<span class="params"><span class="keyword">params</span> <span class="built_in">int</span>[] arr</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">var</span> i <span class="keyword">in</span> arr)</span><br><span class="line">           sum += i;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但要注意的是，<strong>必须是形参列表中的最后一个，由 params 修饰</strong>，否则编译器无法确定传入参数属于哪个数组。</p>
<h2 id="具名参数"><a href="#具名参数" class="headerlink" title="具名参数"></a>具名参数</h2><ul>
<li>参数位置不再受约束</li>
<li>传入的参数是带有名字的</li>
</ul>
<p>换句话说，传入的参数没必要按形参的顺序传入，这样做的优点是：</p>
<ul>
<li>提高代码的可读性</li>
<li>可以按任意顺序传递参数</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">    &#123;   </span><br><span class="line">        <span class="comment">//常规调用</span></span><br><span class="line">        <span class="built_in">string</span> name = <span class="string">&quot;TOM&quot;</span>;</span><br><span class="line">        <span class="built_in">int</span> age = <span class="number">20</span>;</span><br><span class="line">        JuMingParam(name, age);</span><br><span class="line">        <span class="comment">//具名参数</span></span><br><span class="line">        JuMingParam(name: <span class="string">&quot;Tom&quot;</span>, age: <span class="number">20</span>);	<span class="comment">//可读性更强</span></span><br><span class="line">        JuMingParam(age: <span class="number">20</span>, name: <span class="string">&quot;Tom&quot;</span>);	<span class="comment">//不受顺序影响</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">JuMingParam</span>(<span class="params"><span class="built_in">string</span> name, <span class="built_in">int</span> age</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Hi, &#123;0&#125;, you are &#123;1&#125;&quot;</span>, name, age);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="可选参数"><a href="#可选参数" class="headerlink" title="可选参数"></a>可选参数</h2><ul>
<li>形参带有默认值的参数</li>
<li>不推荐使用</li>
</ul>
<h2 id="扩展方法（this-参数）"><a href="#扩展方法（this-参数）" class="headerlink" title="扩展方法（this 参数）"></a>扩展方法（this 参数）</h2><p>扩展方法的“三必须”：</p>
<ul>
<li>必须由一个静态类（类名一般为 TypeExtension）统一收纳对 Type 的扩展方法</li>
<li>方法必须是公有、静态的，即被 public static 修饰</li>
<li>必须是形参列表中的第一个，由 this 修饰</li>
</ul>
<p>以 double 类型为例，若需对一个数据求解精确的小数位数，常规操作为： </p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">double</span> x = <span class="number">3.1415926</span>;</span><br><span class="line"><span class="built_in">double</span> y = Math.Round(x, <span class="number">4</span>);</span><br><span class="line">Console.WriteLine(y);</span><br></pre></td></tr></table></figure>
<p>若想对 double 类型扩展出一个 Round 函数，即可通过 this 参数实现：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">class</span> <span class="title">DoubleExtension</span>	</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">double</span> <span class="title">Round</span>(<span class="params"><span class="keyword">this</span> <span class="built_in">double</span> input, <span class="built_in">int</span> digits</span>)	<span class="comment">// this 参数</span></span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> Math.Round(input, digits);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">double</span> x = <span class="number">3.1415926</span>;</span><br><span class="line"><span class="built_in">double</span> y = x.Round(<span class="number">4</span>);	<span class="comment">//输入时参数只有一个，一个通过 x. 的 this 参数指定了</span></span><br><span class="line">Console.WriteLine(y);</span><br></pre></td></tr></table></figure>
<p>可见，当无法对源码进行修改时，可通过扩展方法对目标类型追加方法，如著名的 LINQ 方法。</p>
<h1 id="委托"><a href="#委托" class="headerlink" title="委托"></a>委托</h1><h2 id="委托定义"><a href="#委托定义" class="headerlink" title="委托定义"></a>委托定义</h2><ul>
<li>函数指针的升级版</li>
</ul>
<p>要理解委托，必须先理解一切皆地址：</p>
<ul>
<li>变量（数据）：以某个地址为起点的一段内存中所存储的值</li>
<li>函数（算法）：以某个地址为起点的一段内存中所存储的一组机器语言指令</li>
</ul>
<p>对函数的调用：</p>
<ul>
<li>直接调用：通过函数名调用，CPU 通过函数名直接获得函数所在的地址并执行、返回</li>
<li>间接调用：通过函数指针调用函数，CPU 通过读取函数指针存储的值从而获得函数所在的地址并执行、返回</li>
</ul>
<p>C# 中已有的两种常见的委托为 Action 和 Func。</p>
<ul>
<li><p>Action：只接受返回值为 void 类型函数的委托，带参数时采用泛型</p>
  <figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">CalculatorDelegate</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Report</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;All 3 Methods&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">Add</span>(<span class="params"><span class="built_in">int</span> x, <span class="built_in">int</span> y</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> x + y;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">Sub</span>(<span class="params"><span class="built_in">int</span> x, <span class="built_in">int</span> y</span>)</span></span><br><span class="line">    &#123; </span><br><span class="line">        <span class="keyword">return</span> x - y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">CalculatorDelegate caldg = <span class="keyword">new</span> CalculatorDelegate();</span><br><span class="line">caldg.Report();	<span class="comment">//常规调用</span></span><br><span class="line">Action action = <span class="keyword">new</span> Action(caldg.Report);	<span class="comment">//委托给 Action</span></span><br><span class="line">action.Invoke();	<span class="comment">// 通过委托间接调用</span></span><br><span class="line">action();	<span class="comment">// 模仿函数指针的调用</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Func：泛型委托，有 17 个重载，其中参数是待委托函数的参数类型，返回值类型</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Func&lt;<span class="built_in">int</span>,<span class="built_in">int</span>,<span class="built_in">int</span>&gt; func = <span class="keyword">new</span> Func&lt;<span class="built_in">int</span>, <span class="built_in">int</span>, <span class="built_in">int</span>&gt;(caldg.Add);	</span><br><span class="line">func.Invoke(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">func(<span class="number">1</span>, <span class="number">2</span>);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="委托声明"><a href="#委托声明" class="headerlink" title="委托声明"></a>委托声明</h2><ul>
<li>委托是一种类，类是一种数据类型，故委托也是一种数据类型</li>
<li>声明方式与一般的类不同，主要是照顾可读性和 C/C++ 传统</li>
</ul>
<p>基于前例，采用自定义委托：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">CSharptest2</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//自定义委托声明，委托是类，故和类平级</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">delegate</span> <span class="built_in">int</span> <span class="title">Calcudg</span>(<span class="params"><span class="built_in">int</span> x, <span class="built_in">int</span> y</span>)</span>;	</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">        &#123;  </span><br><span class="line">            <span class="comment">//自定义委托</span></span><br><span class="line">            CalculatorDelegate caldg = <span class="keyword">new</span> CalculatorDelegate();</span><br><span class="line">            Calcudg calcudg = <span class="keyword">new</span> Calcudg(caldg.Add);</span><br><span class="line">            calcudg.invoke(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">            calcudg(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title">CalculatorDelegate</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Report</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;All 3 Methods&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">Add</span>(<span class="params"><span class="built_in">int</span> x, <span class="built_in">int</span> y</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(x + y);</span><br><span class="line">            <span class="keyword">return</span> x + y;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">Sub</span>(<span class="params"><span class="built_in">int</span> x, <span class="built_in">int</span> y</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(x - y);</span><br><span class="line">            <span class="keyword">return</span> x - y;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>由于 C# 也是允许类嵌套的，因而自定义委托也可放置在类中，但辞职该委托已不再是独立的类。</p>
<h2 id="委托使用"><a href="#委托使用" class="headerlink" title="委托使用"></a>委托使用</h2><ul>
<li><p>把方法当做参数传给另一个方法</p>
<ul>
<li>模板方法：填空题，委托有返回值，常位于代码中部</li>
<li>回调方法：流水线，委托无返回值，常位于代码末尾</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Product</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123;<span class="keyword">get</span>; <span class="keyword">set</span>;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Box</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> Product Product &#123;<span class="keyword">get</span>; <span class="keyword">set</span>;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">WrapFactory</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Box <span class="title">WrapProduct</span>(<span class="params">Func&lt;Product&gt; getProduct</span>) <span class="comment">//模板方法</span></span></span><br><span class="line">    &#123;</span><br><span class="line">        Product prod = getProduct();</span><br><span class="line">        Box box = <span class="keyword">new</span> Box();</span><br><span class="line">        box.Product = prod;</span><br><span class="line">        <span class="keyword">return</span> box;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">ProductFactory</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">MakePizza</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Product prod = <span class="keyword">new</span> Product();</span><br><span class="line">        prod.Name = <span class="string">&quot;Pizza&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> prod;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">MakeToys</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Product prod = <span class="keyword">new</span> Product();</span><br><span class="line">        prod.Name = <span class="string">&quot;Toys&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> prod;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//调用</span></span><br><span class="line">WrapFactory wf = <span class="keyword">new</span> WrapFactory();</span><br><span class="line">ProductFactory pf = <span class="keyword">new</span> ProductFactory();</span><br><span class="line">Func&lt;Product&gt; func1 = <span class="keyword">new</span> Func&lt;Product&gt;(pf.MakePizza);</span><br><span class="line">Func&lt;Product&gt; func2 = <span class="keyword">new</span> Func&lt;Product&gt;(pf.MakeToys);</span><br><span class="line">	</span><br><span class="line">Box box1 = wf.WrapProduct(func1);</span><br><span class="line">Box box2 = wf.WrapProduct(func2);</span><br><span class="line"></span><br><span class="line">Console.WriteLine(box1.Product.Name);</span><br><span class="line">Console.WriteLine(box2.Product.Name);</span><br></pre></td></tr></table></figure>
<p>可见，不论 ProductFactory 生产什么样的产品，WrapFactory 都会将其打包并输出结果，代码复用性提高。</p>
</li>
</ul>
<p>  回调方法也类似，在前例基础上稍作改进即可：</p>
  <figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="keyword">using</span> System.Threading.Tasks;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">CSharptest3</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            WrapFactory wrapFactory = <span class="keyword">new</span> WrapFactory();</span><br><span class="line">            ProductFactory productFactory = <span class="keyword">new</span> ProductFactory();</span><br><span class="line">            Logger logger = <span class="keyword">new</span> Logger();</span><br><span class="line"></span><br><span class="line">            Func&lt;Product&gt; func1 = <span class="keyword">new</span> Func&lt;Product&gt;(productFactory.MakePizza);</span><br><span class="line">            Func&lt;Product&gt; func2 = <span class="keyword">new</span> Func&lt;Product&gt;(productFactory.MakeToys);</span><br><span class="line">            Action&lt;Product&gt; action = <span class="keyword">new</span> Action&lt;Product&gt;(logger.Log); <span class="comment">//log封装进 action</span></span><br><span class="line"></span><br><span class="line">            Box box1 = wrapFactory.WrapProduct(func1, action);</span><br><span class="line">            Box box2 = wrapFactory.WrapProduct(func2, action);</span><br><span class="line"></span><br><span class="line">            Console.WriteLine(box1.Product.Name);</span><br><span class="line">            Console.WriteLine(box2.Product.Name);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title">Product</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">double</span> Price &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;   </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title">Box</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">public</span> Product Product &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title">WrapFactory</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> Box <span class="title">WrapProduct</span>(<span class="params">Func&lt;Product&gt; getProduct, Action&lt;Product&gt; getLog</span>)	<span class="comment">// 回调方法用 Action 封装</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            Product product = getProduct();</span><br><span class="line">            Box box = <span class="keyword">new</span> Box();</span><br><span class="line">            box.Product = product;</span><br><span class="line">            <span class="keyword">if</span>(product.Price &gt; <span class="number">50</span>)</span><br><span class="line">            &#123;</span><br><span class="line">               getLog(product);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> box;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title">ProductFactory</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> Product <span class="title">MakePizza</span>()</span> </span><br><span class="line">        &#123;</span><br><span class="line">            Product pizza = <span class="keyword">new</span> Product();</span><br><span class="line">            pizza.Name = <span class="string">&quot;Pizza&quot;</span>;</span><br><span class="line">            pizza.Price = <span class="number">50</span>;</span><br><span class="line">            <span class="keyword">return</span> pizza;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Product <span class="title">MakeToys</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Product toys = <span class="keyword">new</span> Product();</span><br><span class="line">            toys.Name = <span class="string">&quot;Toys&quot;</span>;</span><br><span class="line">            toys.Price = <span class="number">100</span>;</span><br><span class="line">            <span class="keyword">return</span> toys;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title">Logger</span>	<span class="comment">//记录日志</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Log</span>(<span class="params">Product product</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;&#123;0&#125;,&#123;1&#125;,&#123;2&#125;&quot;</span>, product.Name, DateTime.Now, product.Price);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>使用委托要小心，防止滥用</li>
</ul>
<h2 id="委托高级使用"><a href="#委托高级使用" class="headerlink" title="委托高级使用"></a>委托高级使用</h2><h3 id="多播委托"><a href="#多播委托" class="headerlink" title="多播委托"></a>多播委托</h3><p>多个委托合并到一个，按合并顺序执行</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Student</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> ID;</span><br><span class="line">    <span class="keyword">public</span> ConsoleColor PenColor &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">DrawPic</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.ForegroundColor = <span class="keyword">this</span>.PenColor;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;Student&#x27;ID : &#123;0&#125;, draw pen &#123;1&#125;&quot;</span>, ID, i);</span><br><span class="line">            Thread.Sleep(<span class="number">100</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Student stu1 = <span class="keyword">new</span> Student() &#123;ID = <span class="number">1</span>, PenColor = ConsoleColor.Red&#125;;</span><br><span class="line">Student stu2 = <span class="keyword">new</span> Student() &#123;ID = <span class="number">2</span>, PenColor = ConsoleColor.Green&#125;;</span><br><span class="line">Student stu3 = <span class="keyword">new</span> Student() &#123;ID = <span class="number">3</span>, PenColor = ConsoleColor.Blue&#125;;</span><br><span class="line"></span><br><span class="line">Action action1 = <span class="keyword">new</span> Action(stu1.DrawPic);</span><br><span class="line">Action action2 = <span class="keyword">new</span> Action(stu2.DrawPic);</span><br><span class="line">Action action3 = <span class="keyword">new</span> Action(stu3.DrawPic);</span><br><span class="line"></span><br><span class="line"><span class="comment">//分别调用</span></span><br><span class="line">action1();</span><br><span class="line">action2();</span><br><span class="line">action3();</span><br><span class="line"></span><br><span class="line"><span class="comment">//合并调用</span></span><br><span class="line">action1 += action2;	<span class="comment">// 2 合并到 1</span></span><br><span class="line">action1 += action3;	<span class="comment">// 3 合并到 1</span></span><br><span class="line">action1();	<span class="comment">//只需调用 1 即可全部调用，因 1 封装了 1 2 3 共 3 个方法</span></span><br></pre></td></tr></table></figure>
<h3 id="隐式异步调用"><a href="#隐式异步调用" class="headerlink" title="隐式异步调用"></a>隐式异步调用</h3><ul>
<li><p>同步与异步区别</p>
<ul>
<li><p>同步：你做完了我在你的基础上接着做（顺序执行，执行完一个再执行下一个，需要等待、协调运行）</p>
</li>
<li><p>异步：两人同时做（彼此独立，在等待某事件的过程中继续做自己的事，不需要等待这一事件完成后再工作）</p>
</li>
</ul>
</li>
<li><p>同步调用与异步调用区别</p>
<ul>
<li>每个运行的程序为一个进程（process）</li>
<li>每个进程可有一个或多个线程（thread），每个进程运行时最先运行的那个为主线程，其他为分支线程</li>
<li>同步调用是在同一线程内：同步调用是主线程在运行中遇到方法调用时，先停下主线程去执行调用的方法，执行结束后再返回继续执行主线程，如此往复</li>
<li>异步调用则是多个线程之间相互独立，互不影响，其底层机理是<strong>多线程</strong></li>
<li>串行——同步——单线程；并行——异步——多线程</li>
</ul>
<p>前述多播委托即为同步调用。</p>
<p>异步调用实例如下：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">action1.BeginInvoke(<span class="literal">null</span>, <span class="literal">null</span>); <span class="comment">//隐式异步调用，会自动生成分支线程，由于不用执行后续操作，故参数为 null</span></span><br><span class="line">action2.BeginInvoke(<span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">action3.BeginInvoke(<span class="literal">null</span>, <span class="literal">null</span>); </span><br></pre></td></tr></table></figure>
<p>显示异步调用，即自定义多线程：</p>
<p>使用 Thread 显式异步调用：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Thread thread1 = <span class="keyword">new</span> Thread(<span class="keyword">new</span> ThreadStart(stu1.DrawPic));</span><br><span class="line">Thread thread2 = <span class="keyword">new</span> Thread(<span class="keyword">new</span> ThreadStart(stu2.DrawPic));</span><br><span class="line">Thread thread3 = <span class="keyword">new</span> Thread(<span class="keyword">new</span> ThreadStart(stu2.DrawPic));</span><br><span class="line">thread1.Start();</span><br><span class="line">thread2.Start();</span><br><span class="line">thread3.Start();</span><br></pre></td></tr></table></figure>
<p>也有较高级的异步调用方式，即 Task：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Task task1 = <span class="keyword">new</span> Task(<span class="keyword">new</span> Action(stu1.DrawPic));</span><br><span class="line">Task task2 = <span class="keyword">new</span> Task(<span class="keyword">new</span> Action(stu2.DrawPic));</span><br><span class="line">Task task3 = <span class="keyword">new</span> Task(<span class="keyword">new</span> Action(stu3.DrawPic));</span><br><span class="line"></span><br><span class="line">task1.Start();</span><br><span class="line">task2.Start();</span><br><span class="line">task3.Start();</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><em>若对委托使用不当，会导致代码可读性降低，Debug 也更难，为此，可适当使用 接口 取代一些委托的使用，JAVA 中完全使用接口取代了委托</em></p>
<h1 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h1><h2 id="事件概念"><a href="#事件概念" class="headerlink" title="事件概念"></a>事件概念</h2><ul>
<li>定义：Event，能够发生的事情</li>
<li>角色：是对象或类具备通知能力的成员（可见其是类的成员）</li>
<li>使用：用于对象或类间的动作协调与信息传递</li>
<li>原理：事件模型（event model），即 发生-响应 模型<ul>
<li>隐含“订阅”关系</li>
<li>被通知的人根据拿到的事件信息（事件数据、事件参数、通知）对事件做出响应（处理事件）</li>
</ul>
</li>
<li>应用：多用于桌面、手机等客户端开发，这类程序靠事件驱动</li>
</ul>
<h2 id="事件模型"><a href="#事件模型" class="headerlink" title="事件模型"></a>事件模型</h2><p>事件模型的5个组成部分：</p>
<ul>
<li>事件的拥有者（event source）：类、对象</li>
<li>事件成员（event）：成员</li>
<li>事件的响应者（event subscriber)：类、对象</li>
<li>事件处理器（event handler）：方法成员，本质是一个回调方法</li>
<li>事件订阅：将事件处理器与事件关联在一起，本质是一个以委托类型为基础的“约定”（+=）<ul>
<li>事件需要委托类型作约束，该约束规定了事件能发送什么样的消息给事件的响应者，亦规定了事件响应者能收到什么样的消息</li>
<li>当事件的响应者向事件拥有者提供了事件处理器后，需要将其保存，能够引用方法的也只有委托的实例（对象）了</li>
</ul>
</li>
</ul>
<p><strong>事件的拥有者、事件的source、事件消息的发送者一致，这也是事件方法参数第一个参数的由来。</strong></p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Timers;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">CSharptest3</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Timers timers = <span class="keyword">new</span> Timers;</span><br><span class="line">            timers.Interval = <span class="number">1000</span>;</span><br><span class="line">            Boy boy = <span class="keyword">new</span> Boy();</span><br><span class="line">            timers.Elapsed += boy.Action;</span><br><span class="line">            timer.Start();</span><br><span class="line">            Console.ReadLine();   </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">class</span> <span class="title">Boy</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">internal</span> <span class="keyword">void</span> <span class="title">Action</span>(<span class="params"><span class="built_in">object</span> sender, ElapsedEventArgs e</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;BOY&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>实例1：事件的响应者（事件处理器）订阅事件的拥有者（事件）</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Windows.Forms;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">CSharptest3</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Form form = <span class="keyword">new</span> Form();</span><br><span class="line">            Controller controller = <span class="keyword">new</span> Controller(form);</span><br><span class="line">            form.ShowDialog();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">class</span> <span class="title">Controller</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> Form form;</span><br><span class="line">        </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Controller</span>(<span class="params">Form form</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">          	<span class="keyword">if</span>(<span class="keyword">this</span>.form != <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">             	<span class="keyword">this</span>.form = form;</span><br><span class="line">                <span class="keyword">this</span>.form.Click += <span class="keyword">this</span>.FormClicked;           </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">FormClicked</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.form.Text = DateTime.Now.ToString();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>实例2：事件的拥有者同时是事件的响应者</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Windows.Forms;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">CSharptest3</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            MyForm myform = <span class="keyword">new</span> MyForm;</span><br><span class="line">            myForm.Click += myForm.Action;</span><br><span class="line">            myForm.ShowDialog();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">	<span class="keyword">class</span> <span class="title">MyForm</span>: <span class="title">Form</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">internal</span> <span class="keyword">void</span> <span class="title">Action</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.Text = DateTime.Now.ToString();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>实例3：事件的拥有者是事件响应者的一个字段，事件的响应者利用自己的方法订阅事件</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">MForm</span>: <span class="title">Form</span>	<span class="comment">//事件响应者 Form</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> TextBox textBox;</span><br><span class="line">    <span class="keyword">private</span> Button button;	<span class="comment">//事件拥有者 button，是 Form 的字段成员</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MForm</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.textBox = <span class="keyword">new</span> TextBox();</span><br><span class="line">        <span class="keyword">this</span>.button = <span class="keyword">new</span> Button();</span><br><span class="line">        <span class="keyword">this</span>.Controls.Add(<span class="keyword">this</span>.textBox);</span><br><span class="line">        <span class="keyword">this</span>.Controls.Add(<span class="keyword">this</span>.button);</span><br><span class="line">        <span class="keyword">this</span>.button.Click += <span class="keyword">this</span>.ButtonClicked;	<span class="comment">// click 事件由方法订阅</span></span><br><span class="line">        <span class="comment">//this.button.Text = &quot;Clicked&quot;;</span></span><br><span class="line">        <span class="comment">//this.button.Top = 50;</span></span><br><span class="line">        <span class="comment">//this.button.AutoSize = true;</span></span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">// 事件处理器为 Form 的方法</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ButtonClicked</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span>	</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.textBox.Text = DateTime.Now.ToString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//调用</span></span><br><span class="line">MForm myForm2 = <span class="keyword">new</span> MForm();</span><br><span class="line">myForm2.ShowDialog();</span><br></pre></td></tr></table></figure>
<h2 id="事件处理器挂接"><a href="#事件处理器挂接" class="headerlink" title="事件处理器挂接"></a>事件处理器挂接</h2><ul>
<li>事件处理器可重用，但必须和被处理事件保持约束一致</li>
<li>挂接方式1：代码显式挂接</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">WindowsFormsApp1</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">partial</span> <span class="keyword">class</span> <span class="title">Form1</span> : <span class="title">Form</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Form1</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            InitializeComponent();</span><br><span class="line">            <span class="comment">//事件处理器挂接方式1：方法名</span></span><br><span class="line">            <span class="keyword">this</span>.button3.Click += button1_Click; </span><br><span class="line">            <span class="comment">//事件处理器挂接方式2：通过委托实例</span></span><br><span class="line">            <span class="keyword">this</span>.button3.Click += <span class="keyword">new</span> EventHandler(<span class="keyword">this</span>.button1_Click);</span><br><span class="line">            <span class="comment">//事件处理器挂接方式3：Lambda 表达式</span></span><br><span class="line">            <span class="keyword">this</span>.button3.Click += (<span class="built_in">object</span> sender, EventArgs s) =&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">this</span>.textBox1.Text = <span class="string">&quot;Lambda&quot;</span>;</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="comment">// Lambda 表达式中，编译器可根据参数自动推断类型，可省略类型</span></span><br><span class="line">            <span class="keyword">this</span>.button3.Click += (sender, s) =&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">this</span>.textBox1.Text = <span class="string">&quot;Lambda&quot;</span>;</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">button1_Click</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (sender == <span class="keyword">this</span>.button1)</span><br><span class="line">                <span class="keyword">this</span>.textBox1.Text = <span class="string">&quot;Button1&quot;</span>;</span><br><span class="line">            <span class="keyword">if</span> (sender == <span class="keyword">this</span>.button2)</span><br><span class="line">                <span class="keyword">this</span>.textBox1.Text = <span class="string">&quot;Button2&quot;</span>;</span><br><span class="line">            <span class="keyword">if</span> (sender == <span class="keyword">this</span>.button3)</span><br><span class="line">                <span class="keyword">this</span>.textBox1.Text = <span class="string">&quot;Button3&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>挂接方式2：在属性-事件面板下，选择相应的事件处理器即可</li>
</ul>
<p>综上可见，一个事件可挂接多个事件处理器（如前述 Timers 事件），一个事件处理器也可被多个事件挂接（如上述 button1_Click）。</p>
<p><strong>事件处理器对事件的订阅并不是任意的，匹配与否由声明事件时所使用的委托类型来检测，如上列中，button 的 click 事件的委托类型是 EventHandler</strong></p>
<p>对于事件的暂时理解：你去餐馆吃饭，点菜即为事件，服务员拥有事件处理器，一旦你点菜的事件发生，服务员将你点的菜（事件信息）告诉（事件处理器）厨师。</p>
<h2 id="自定义事件"><a href="#自定义事件" class="headerlink" title="自定义事件"></a>自定义事件</h2><ul>
<li>完整声明<ul>
<li>要声明事件，需先声明委托，委托是事件的基础，事件是委托的上层建筑。如前列中，button 的 click 事件的委托类型是 EventHandler，但我们自定义事件并没有预制的委托类型，故需先声明委托</li>
<li>据 .NET 的规定，声明事件的委托类型时，委托名以 EventHandler  作为后缀；若需声明事件参数（即传输事件信息）的基础类时，类名以 EventArgs 作为后缀，且需继承 EventArgs 基类</li>
</ul>
</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Diagnostics.Tracing;</span><br><span class="line"><span class="keyword">using</span> System.Threading;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">CSharptest4</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Customer customer = <span class="keyword">new</span> Customer();</span><br><span class="line">            Waiter waiter = <span class="keyword">new</span> Waiter();</span><br><span class="line">            customer.Order += waiter.Action;</span><br><span class="line">            customer.Action();</span><br><span class="line">            customer.PaytheBill();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">OrderEventArgs</span>: <span class="title">EventArgs</span>	<span class="comment">//传递事件信息</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> DishName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> Size &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">delegate</span> <span class="keyword">void</span> <span class="title">OrderEventHandler</span>(<span class="params">Customer customer, OrderEventArgs e</span>)</span>; <span class="comment">//声明委托类型，事件的基础</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Customer</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> OrderEventHandler e;</span><br><span class="line">        <span class="comment">//声明事件，关键字 event</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">event</span> OrderEventHandler Order</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//事件处理器添加器</span></span><br><span class="line">            <span class="keyword">add</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">this</span>.e += <span class="keyword">value</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//事件处理器移除器</span></span><br><span class="line">            <span class="keyword">remove</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">this</span>.e -= <span class="keyword">value</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">double</span> Bill  &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">PaytheBill</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;I will pay $&#123;0&#125;&quot;</span>, <span class="keyword">this</span>.Bill);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Walkin</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;Run into resraunt&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SitDown</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;Sit Down&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Think</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">           </span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;Need Some time to think……&quot;</span>);</span><br><span class="line">                Thread.Sleep(<span class="number">1000</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//触发事件</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">this</span>.e != <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                OrderEventArgs ea = <span class="keyword">new</span> OrderEventArgs();</span><br><span class="line">                ea.DishName = <span class="string">&quot;GongPao Chicken&quot;</span>;</span><br><span class="line">                ea.Size = <span class="string">&quot;large&quot;</span>;</span><br><span class="line">                <span class="keyword">this</span>.e.Invoke(<span class="keyword">this</span>, ea);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Action</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.ReadLine();</span><br><span class="line">            <span class="keyword">this</span>.Walkin();</span><br><span class="line">            <span class="keyword">this</span>.SitDown();</span><br><span class="line">            <span class="keyword">this</span>.Think();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Waiter</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Action</span>(<span class="params">Customer customer, OrderEventArgs e</span>)</span></span><br><span class="line">        &#123; </span><br><span class="line">            Console.WriteLine(<span class="string">&quot;Your Dish - &#123;0&#125;&quot;</span>, e.DishName);</span><br><span class="line">            <span class="built_in">double</span> price = <span class="number">10</span>;</span><br><span class="line">            <span class="keyword">switch</span> (e.Size)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;small&quot;</span>:</span><br><span class="line">                    price *= <span class="number">0.5</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;large&quot;</span>:</span><br><span class="line">                    price *= <span class="number">1.5</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="literal">default</span>:</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            customer.Bill += price;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>简洁声明：无需写事件添加器和移除器，但由于没有了手动声明委托字段，故在调用时使用事件名（实际上编译器会生成委托字段，只是我们没法访问，只能通过事件名访问）</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//事件简略声明</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">event</span> OrderEventHandler Order;</span><br><span class="line"></span><br><span class="line"><span class="comment">//触发事件</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">this</span>.Order!= <span class="literal">null</span>)</span><br><span class="line">&#123;</span><br><span class="line">    OrderEventArgs ea = <span class="keyword">new</span> OrderEventArgs();</span><br><span class="line">    ea.DishName = <span class="string">&quot;GongPao Chicken&quot;</span>;</span><br><span class="line">    ea.Size = <span class="string">&quot;large&quot;</span>;</span><br><span class="line">    <span class="keyword">this</span>.Order.Invoke(<span class="keyword">this</span>, ea);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但其实，我们可以不用单独去声明 OrderEventHandler 这个委托类型，而是直接使用 .NET 已有的 EventHandler，其定义如下：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">delegate</span> <span class="keyword">void</span> <span class="title">EventHandler</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span>;</span><br></pre></td></tr></table></figure>
<p>由于 object 是所有类型的基类，故可传入任意类型的参数；此外，定义事件参数 OrderEventArgs 时，继承了 EventArgs 基类，故其亦可接受派生类参数。</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">event</span> EventHandler Order;</span><br><span class="line"><span class="comment">//此时 waiter 的方法需进行数据类型的转换</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Action</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line">&#123; </span><br><span class="line">    Customer customer = sender <span class="keyword">as</span> Customer;</span><br><span class="line">    OrderEventArgs ea = e <span class="keyword">as</span> OrderEventArgs;</span><br><span class="line">    </span><br><span class="line">    Console.WriteLine(<span class="string">&quot;Your Dish - &#123;0&#125;&quot;</span>, ea.DishName);</span><br><span class="line">    <span class="built_in">double</span> price = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">switch</span> (ea.Size)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;small&quot;</span>:</span><br><span class="line">            price *= <span class="number">0.5</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;large&quot;</span>:</span><br><span class="line">            price *= <span class="number">1.5</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="literal">default</span>:</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    customer.Bill += price;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>此外，上述中的例子也说明，事件只能由事件的拥有者触发，访问级别一般为 protected，防止被“借刀杀人”。前述中，事件是在 Think 方法中触发的，但一般一个方法只做一件事，且触发事件的方法一般命名为 OnMethodName。</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Think</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Need Some time to think……&quot;</span>);</span><br><span class="line">        Thread.Sleep(<span class="number">1000</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">this</span>.OnOrder(<span class="string">&quot;GongPao Chicken&quot;</span>, <span class="string">&quot;Large&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//触发事件的方法</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">OnOrder</span>(<span class="params"><span class="built_in">string</span> dishname, <span class="built_in">string</span> size</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.Order != <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        OrderEventArgs ea = <span class="keyword">new</span> OrderEventArgs();</span><br><span class="line">        ea.DishName = dishname;</span><br><span class="line">        ea.Size = size;</span><br><span class="line">        <span class="keyword">this</span>.Order(<span class="keyword">this</span>, ea);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="事件本质"><a href="#事件本质" class="headerlink" title="事件本质"></a>事件本质</h2><ul>
<li>委托字段的一个包装器</li>
<li>该包装器对委托字段的访问起到限制作用，即封装</li>
<li>事件对外界隐藏了委托实例的大部分功能，仅暴露添加、移除事件处理器的功能</li>
</ul>
<h1 id="类"><a href="#类" class="headerlink" title="类"></a>类</h1><h2 id="什么是类"><a href="#什么是类" class="headerlink" title="什么是类"></a>什么是类</h2><ul>
<li><p>一种数据结构</p>
</li>
<li><p>一种数据类型</p>
<p>C# 中的类是一种引用类型，但具体到每个不同的类的时候，又是一种自定义的（引用）类型。</p>
</li>
<li><p>代表现实中的“种类”</p>
</li>
</ul>
<h2 id="构造和析构"><a href="#构造和析构" class="headerlink" title="构造和析构"></a>构造和析构</h2><ul>
<li>静态构造器：（只能）初始化静态成员，如属性或字段</li>
<li>Ｃ# 有 GC （Garbage Collector)，即垃圾回收机制，垃圾回收过程中做的事可以放在析构中</li>
</ul>
<h2 id="类的声明"><a href="#类的声明" class="headerlink" title="类的声明"></a>类的声明</h2><ul>
<li>一般声明在命名空间里，即使声明在命名空间外，该类也位于是全局命名空间下的</li>
<li>也可以声明在已有的类里面，此时是该已有类的成员（成员类）</li>
<li>C# 中类的声明即定义（注意不同于 C++，大多数时候是.h/.hpp声明，.cpp定义）</li>
</ul>
<h2 id="类的权限"><a href="#类的权限" class="headerlink" title="类的权限"></a>类的权限</h2><ul>
<li>public：可以暴露给其他项目</li>
<li>internal：在本项目中完全可访问，出了本项目无法访问（默认）（限制在同一程序集 assembly中）</li>
<li>private：只在嵌套类中可使用</li>
<li>sealed：封闭关键字，修饰后该类不能再作为基类</li>
</ul>
<h2 id="类的继承"><a href="#类的继承" class="headerlink" title="类的继承"></a>类的继承</h2><ul>
<li>派生类的实例也是基类的实例，即可用基类类型的变量引用派生类类型的实例</li>
<li><p>C# 规定每个类只能有一个基类</p>
</li>
<li><p>子类的访问级别不能高于基类</p>
</li>
<li><p>派生类的对象，是从基类开始构造，直到该派生类</p>
</li>
<li><p>派生类不继承基类的实例构造器</p>
</li>
<li><p>base. 只能访问派生类的上一级对象</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Class Vehicle	<span class="comment">//默认继承 全局基类 object</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Vehicle</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.Owner = <span class="string">&quot;N/A&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Owner &#123;<span class="keyword">get</span>; <span class="keyword">set</span>;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> Car : Vehicle</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Car</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.Owner = <span class="string">&quot;Car Owner&quot;</span>;	<span class="comment">//派生类继承了基类除实例构造器外的所有</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ShowOwner</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="keyword">base</span>.Owner);	<span class="comment">// base只能访问上一级，即 Vehicle, 但不能访问 Vehicle 的基类</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可见，派生类正确构造的前提是基类先被正确构造，上例中，假若基类不再是构造器，则派生类也应做出相应的改变：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Class Vehicle	<span class="comment">//默认继承 全局基类 object</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Vehicle</span>(<span class="params"><span class="built_in">string</span> owner</span>)<span class="comment">//含参构造器</span></span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.Owner = owner;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Owner &#123;<span class="keyword">get</span>; <span class="keyword">set</span>;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> Car : Vehicle</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//派生类必须把基类构造器的参数传入</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Car</span>(<span class="params"><span class="built_in">string</span> owner</span>) : <span class="title">base</span>(<span class="params">owner</span>)</span>  &#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ShowOwner</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="keyword">base</span>.Owner);	<span class="comment">// base只能访问上一级，即 Vehicle, 但不能访问 Vehicle 的基类</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>派生类、基类访问级别</p>
<ul>
<li>public：可以暴露给其他项目</li>
<li>internal：在本项目中完全可访问，出了本项目无法访问（默认）（限制在同一程序集）</li>
<li><p>private：只在本类中可访问（限制在类中）（字段、属性默认值）</p>
<ul>
<li>变量名前面加 _ ，表示实例字段，且是私有的，相等于 this.varname</li>
</ul>
</li>
<li><p>protected：限制在继承链上，即子类都能访问，但非继承关系的无法访问，且是跨程序集的（即在其他项目中有派生类的话，也是可访问的）</p>
</li>
<li>目前还有 internal protected 等组合</li>
</ul>
</li>
</ul>
<h2 id="重写、隐藏、多态"><a href="#重写、隐藏、多态" class="headerlink" title="重写、隐藏、多态"></a>重写、隐藏、多态</h2><ul>
<li>类似 C++ 虚函数，若基类中的方法可能在派生类中重写，则加 virtual 修饰，在派生类中重写时，加 override 修饰符</li>
<li>方法、属性属于函数成员，均可被重写</li>
<li>派生类的实例调用派生类的方法，基类的实例调用基类的方法</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Vehicle</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Run</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;This is Base&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Car</span> : <span class="title">Vehicle</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Run</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;This is Derived &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//调用</span></span><br><span class="line">Car car = <span class="keyword">new</span> Car();</span><br><span class="line">car.Run();	<span class="comment">//子类的 Run 方法</span></span><br><span class="line">Vehicle vehicle = <span class="keyword">new</span> Vehicle();</span><br><span class="line">vehicle.Run();	<span class="comment">// 父类的 Run 方法</span></span><br></pre></td></tr></table></figure>
<p>前述中提到过，父类也是可以引用子类的实例的，即便是父类的变量，但其引用的是子类的实例，故调用的还是子类的方法，这便是多态，即用父类类型的变量引用子类的实例时，总是调用到最新重写的方法，</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Vehicle vehicle2 = <span class="keyword">new</span> Car();</span><br><span class="line">vehicle2.Run();	<span class="comment">//子类的 Run 方法</span></span><br></pre></td></tr></table></figure>
<p>隐藏则是另一种情况，即在没有 virtual 和 override 修饰时。子父类直接对父类的同名方法进行了隐藏：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Vehicle</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Run</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;This is Base&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Car</span> : <span class="title">Vehicle</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Run</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;This is Derived &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//调用</span></span><br><span class="line">Car car = <span class="keyword">new</span> Car();</span><br><span class="line">car.Run();	<span class="comment">// 子类的 Run 方法，隐藏了父类</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 父类的 Run 方法，由于不是重写，直接调用了 父类的方法</span></span><br><span class="line">Vehicle vehicle = <span class="keyword">new</span> Vehicle();</span><br><span class="line">vehicle.Run();	</span><br><span class="line">Vehicle vehicle2 = <span class="keyword">new</span> Car();</span><br><span class="line">vehicle2.Run();	</span><br></pre></td></tr></table></figure>
<p>实际项目中一般不会使用隐藏（Hide）！</p>
<p>上述是对方法的重写，但属性也属于函数成员，故其也是可以重写的：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Vehicle</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">int</span> _speed;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">virtual</span> <span class="built_in">int</span> Speed	<span class="comment">//属性</span></span><br><span class="line">    &#123; </span><br><span class="line">        <span class="keyword">get</span> &#123; <span class="keyword">return</span> _speed / <span class="number">10</span>; &#125; </span><br><span class="line">        <span class="keyword">set</span> &#123; _speed = <span class="keyword">value</span>; &#125;</span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Run</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        _speed = <span class="number">1000</span>;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Speed =&#123;0&#125;&quot;</span>, Speed);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Car</span> : <span class="title">Vehicle</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">int</span> _fuel;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">override</span> <span class="built_in">int</span> Speed 	<span class="comment">//重写属性</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123; <span class="keyword">return</span> _fuel + <span class="number">100</span>; &#125;</span><br><span class="line">        <span class="keyword">set</span> &#123; _fuel += <span class="keyword">value</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Run</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        _fuel = <span class="number">100</span>;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;OR = &#123;0&#125;&quot;</span>, Speed);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//调用</span></span><br><span class="line">Car car = <span class="keyword">new</span> Car();</span><br><span class="line">car.Run();</span><br><span class="line">Vehicle vehicle = <span class="keyword">new</span> Vehicle();</span><br><span class="line">vehicle.Run();</span><br><span class="line"></span><br><span class="line">Vehicle vehicle2 = <span class="keyword">new</span> Car();   <span class="comment">//Car 的实例，调用重写方法</span></span><br><span class="line">vehicle2.Run();</span><br></pre></td></tr></table></figure>
<p>综上，重写能够发生的条件是：</p>
<ul>
<li>函数成员：如方法、属性</li>
<li>可见：继承的成员、方法对子类是可见的，如在父类中是 private 则必不能重写</li>
<li>签名一致：方法名/属性名、方法的参数必须一致</li>
</ul>
<h2 id="抽象类"><a href="#抽象类" class="headerlink" title="抽象类"></a>抽象类</h2><ul>
<li>函数成员未被完全实现的类（众多函数成员中至少有一个未被实现）</li>
<li>（类似 C++ 中含有纯虚函数的类）</li>
<li>抽象类与设计原则中的 “开放/关闭” 原则 关系紧密，该原则强调类中应封装一些不变的、稳定的、固定的和确定的成员，而把那些不确定的、有可能改变的成员留给子类去实现</li>
<li>被 abstract 修饰的函数成员不能有任何实现，即<strong>没有函数体</strong>，对应的类也需用 abstract 修饰，该类也<strong>不能被实例化</strong>，可用于：<ul>
<li>用作基类（其实是转为作基类而生的）</li>
<li>用基类类型的变量引用派生类的实例</li>
</ul>
</li>
<li>为复用而生，专门作为基类使用，也具有解耦功能</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title">Vehicle</span>	<span class="comment">//抽象类</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Stop</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Vehicle Is Stopped&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Fuel</span>()</span> </span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Vehicle Is Fuelling&quot;</span>);         </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Run</span>()</span>;	<span class="comment">//函数成员不实现</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">RaceCar</span> : <span class="title">Vehicle</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Run</span>()	<span class="comment">//子类必须实现基类中的抽象成员</span></span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;RaceCar is Running&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h1><h2 id="初识接口"><a href="#初识接口" class="headerlink" title="初识接口"></a>初识接口</h2><p>抽象类中部分函数成员是被实现了的，那有没有所有的函数成员均未被实现的类呢？这就是纯抽象类，其作用就是说明这个类可能含有这些功能，即留下接口，让子类去实现（类似 C++），这种情况在 C# 中就是接口 Interface，即纯抽象类 = 接口。</p>
<ul>
<li>为解耦而生：高内聚，低耦合，方便单元测试</li>
<li>接口亦不能实例化</li>
<li>成员必须是 public 的</li>
<li>接口的产生：自底向上（重构），自定向下（设计）</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title">VehicleBase</span>	<span class="comment">//纯抽象类</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Run</span>()</span>;</span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Stop</span>()</span>;</span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Fuel</span>()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title">Vehicle</span> : <span class="title">VehicleBase</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Stop</span>()	<span class="comment">//子类实现</span></span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Vehicle Is Stopped&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Fuel</span>()</span> </span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Vehicle Is Fuelling&quot;</span>);</span><br><span class="line">           </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>abstract class 换为 interface，且<strong>接口要求其成员必须是 public 的</strong>，由此上述代码换为接口的写法为：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title">IVehicle</span></span><br><span class="line">&#123;</span><br><span class="line">     <span class="function"><span class="keyword">void</span> <span class="title">Run</span>()</span>;</span><br><span class="line">     <span class="function"><span class="keyword">void</span> <span class="title">Stop</span>()</span>;</span><br><span class="line">     <span class="function"><span class="keyword">void</span> <span class="title">Fuel</span>()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title">Vehicle</span> : <span class="title">IVehicle</span>	<span class="comment">//实现接口</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Stop</span>()	<span class="comment">// 接口实现时无需加 override</span></span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Vehicle Is Stopped&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Fuel</span>()</span> </span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Vehicle Is Fuelling&quot;</span>);           </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">abstract</span> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Run</span>()</span>;	<span class="comment">// 未实现的方法继续预留</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">RaceCar</span> : <span class="title">Vehicle</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Run</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;RaceCar is Running&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//调用</span></span><br><span class="line">RaceCar raceCar = <span class="keyword">new</span> RaceCar();</span><br><span class="line">raceCar.Run();</span><br><span class="line">raceCar.Stop();</span><br><span class="line">raceCar.Fuel();</span><br><span class="line">Vehicle vehicle = <span class="keyword">new</span> RaceCar();</span><br><span class="line">vehicle.Run(); </span><br></pre></td></tr></table></figure>
<p>关于抽象类和接口的总结说明：</p>
<ul>
<li>接口和抽象类都是“软件工程产物“</li>
<li>具体类→抽象类→接口：越来越抽象，内部实现的东西越来越少</li>
<li>抽象类是未完全实现逻辑的类（可以有字段和非 public 成员，它们代表了“具体逻辑”）</li>
<li>抽象类为复用而生：专门作为基类来使用，也具有解耦功能</li>
<li>封装确定的，开放不确定的，推迟到合适的子类中去实现</li>
<li>接口是完全未实现逻辑的“类”（“纯虚类”；只有函数成员：成员全部 public）</li>
<li>接口为解耦而生：“高内聚，低耦合”，方便单元测试</li>
<li>接口是一个“协约”，旱已为工业生产所熟知（有分工必有协作，有协作必有协约）</li>
<li>它们都不能实例化，只能用来声明变量、引用具体类(concrete class)的实例</li>
</ul>
<h2 id="接口本质"><a href="#接口本质" class="headerlink" title="接口本质"></a>接口本质</h2><p>是一种契约，一种协议！</p>
<p>假若有两个不同类型的数组需求和及均值，代码如下：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span>[] arr1 = <span class="keyword">new</span> <span class="built_in">int</span>[] &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span> &#125;;</span><br><span class="line">        ArrayList arr2 = <span class="keyword">new</span> ArrayList &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span> &#125;;</span><br><span class="line"></span><br><span class="line">        Console.WriteLine(Sum(arr1));</span><br><span class="line">        Console.WriteLine(Ave(arr1));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="built_in">int</span> <span class="title">Sum</span>(<span class="params"><span class="built_in">int</span>[] arr</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="built_in">int</span> i <span class="keyword">in</span> arr)</span><br><span class="line">            sum += i;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="built_in">int</span> <span class="title">Ave</span>(<span class="params"><span class="built_in">int</span>[] arr</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span> sum = <span class="number">0</span>, ave = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="built_in">int</span> i <span class="keyword">in</span> arr)</span><br><span class="line">        &#123;</span><br><span class="line">            sum += i; </span><br><span class="line">            ave++; </span><br><span class="line">        &#125;</span><br><span class="line">        ave = sum / ave;</span><br><span class="line">        <span class="keyword">return</span> ave;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//对 ArrayList 类型再写Sum 和 Ave 函数</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可见，对于不同的类型，同样的功能存在重复，但若采用接口就会方便很多：由于 Sum 和 Ave 内部只要求传入元素满足可迭代性（foreach 循环迭代），而整型数组类型的基类 Array 、ArrayList 实例均实现了 IEnumerable 接口，改接口支持简单迭代，故代码可重写为：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span>[] arr1 = <span class="keyword">new</span> <span class="built_in">int</span>[] &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span> &#125;;</span><br><span class="line">        ArrayList arr2 = <span class="keyword">new</span> ArrayList &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span> &#125;;</span><br><span class="line"></span><br><span class="line">        Console.WriteLine(Sum(arr1));</span><br><span class="line">        Console.WriteLine(Ave(arr1));</span><br><span class="line">        Console.WriteLine(Sum(arr2));</span><br><span class="line">        Console.WriteLine(Ave(arr2));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="built_in">int</span> <span class="title">Sum</span>(<span class="params">IEnumerable arr</span>)	<span class="comment">//接口</span></span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="built_in">int</span> i <span class="keyword">in</span> arr)</span><br><span class="line">            sum += i;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="built_in">int</span> <span class="title">Ave</span>(<span class="params">IEnumerable arr</span>)<span class="comment">//接口</span></span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span> sum = <span class="number">0</span>, ave = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="built_in">int</span> i <span class="keyword">in</span> arr)</span><br><span class="line">        &#123;</span><br><span class="line">            sum += i; </span><br><span class="line">            ave++; </span><br><span class="line">        &#125;</span><br><span class="line">        ave = sum / ave;</span><br><span class="line">        <span class="keyword">return</span> ave;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="依赖和耦合"><a href="#依赖和耦合" class="headerlink" title="依赖和耦合"></a>依赖和耦合</h2><ul>
<li><p>紧耦合：一个类B完全依赖另一个类A，在 A 类出问题时，B 类无法正常工作</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Engine</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> RPM &#123; <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Work</span>(<span class="params"><span class="built_in">int</span> gas</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        RPM = <span class="number">1000</span> * gas;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Car</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> Engine _engine;  <span class="comment">//对 Engine 类有了依赖</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Car</span>(<span class="params">Engine engine</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _engine = engine;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Speed &#123; <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Run</span>(<span class="params"><span class="built_in">int</span> gas</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _engine.Work(gas);</span><br><span class="line">        <span class="keyword">this</span>.Speed = _engine.RPM / <span class="number">100</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用</span></span><br><span class="line">Engine engine = <span class="keyword">new</span> Engine();</span><br><span class="line">Car car = <span class="keyword">new</span> Car(engine);</span><br><span class="line">car.Run(<span class="number">2</span>);</span><br><span class="line">Console.WriteLine(car.Speed);</span><br></pre></td></tr></table></figure>
</li>
<li><p>降低耦合度：通过接口，暴露在外的接口一定是稳定可靠的</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title">Iphone</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Dail</span>()</span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">PicKUp</span>()</span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Send</span>()</span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Receive</span>()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">NokiaPhone</span> : <span class="title">Iphone</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Dail</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Dailling, Hello&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">PicKUp</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Who is this&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Send</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Are you ok&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Receive</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Great&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">HuaweiPhone</span> : <span class="title">Iphone</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Dail</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Dailling, Hello&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">PicKUp</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Who is this&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Send</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Are you ok&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Receive</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Great&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Users</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> Iphone _phone;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Users</span>(<span class="params">Iphone iphone</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _phone = iphone;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">UsePhone</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        _phone.Dail();</span><br><span class="line">        _phone.PicKUp();</span><br><span class="line">        _phone.Send();</span><br><span class="line">        _phone.Receive();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//调用</span></span><br><span class="line"><span class="keyword">var</span> users = <span class="keyword">new</span> Users(<span class="keyword">new</span> HuaweiPhone());</span><br><span class="line"><span class="comment">//var users = new Users(new NokiaPhone());</span></span><br><span class="line">users.UsePhone();</span><br></pre></td></tr></table></figure>
<p>可见，用户与手机之间的耦合度大幅降低，用户换手机只需传入手机名，因为不同手机的基本功能是一致的，即功能或服务的提供方是可更换的！</p>
</li>
<li><p>接口可以有多个基接口，但类只能有一个基类</p>
</li>
</ul>
<h1 id="设计原则"><a href="#设计原则" class="headerlink" title="设计原则"></a>设计原则</h1><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV11M4y1Q7c7?p=131&amp;vd_source=fec24f91a1f4089702782fcfcc6cba66">详见</a></p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://www.freecodecamp.org/chinese/news/solid-principles/">SOLID 设计原则</a></p>
</li>
<li><p>依赖反转原则</p>
</li>
<li><p>单元测试：新建 xUnit 项目（对 .NET Core 兼容性最好），每个类是一个测试用例（这个可以参考开源库中的测试）</p>
</li>
<li>可通过 mock 框架简化单元测试</li>
</ul>
<p>依赖反转是单元测试的基础。</p>
<ul>
<li><p>接口隔离原则：调用者不会多调</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">CSharptest5</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> drivers = <span class="keyword">new</span> Driver(<span class="keyword">new</span> Car());</span><br><span class="line">            drivers.Drive();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title">Driver</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> IVehicle _vehicle;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Driver</span>(<span class="params">IVehicle vehicle</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            _vehicle = vehicle;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Drive</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            _vehicle.Run();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="keyword">region</span> Interface_Vehicle</span></span><br><span class="line">    <span class="keyword">interface</span> <span class="title">IVehicle</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">Run</span>()</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title">Car</span> : <span class="title">IVehicle</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Run</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;Car is running&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title">Truck</span> : <span class="title">IVehicle</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Run</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;Truck is Running&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="keyword">region</span> Interface_Tank</span></span><br><span class="line">    <span class="keyword">interface</span> <span class="title">ITank</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">Run</span>()</span>;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">Fire</span>()</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title">LightTank</span> : <span class="title">ITank</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Fire</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;Light Fire!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Run</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;Light Tank run&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title">HeavyTank</span> : <span class="title">ITank</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Fire</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;Heavy Fire!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Run</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;Heavy tank run&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可见，由于在 Driver 类的构造函数是 IVehicle 接口，当我们想通过其访问 Itank 的类时，只能通过修改 Driver 类的 IVehicle 接口类型为 ITank 接口类型，此时问题又出现了，Itank接口的 Fire 方法永远也无法用到，这就说明该接口“胖了”，即该接口封装了两个本质完全不同的方法，应将其拆分：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">CSharptest5</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> drivers = <span class="keyword">new</span> Driver(<span class="keyword">new</span> LightTank());</span><br><span class="line">            drivers.Drive();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title">Driver</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> IVehicle _vehicle;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Driver</span>(<span class="params">IVehicle vehicle</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            _vehicle = vehicle;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Drive</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            _vehicle.Run();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="keyword">region</span> Interface_Vehicle</span></span><br><span class="line">    <span class="keyword">interface</span> <span class="title">IVehicle</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">Run</span>()</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title">Car</span> : <span class="title">IVehicle</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Run</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;Car is running&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title">Truck</span> : <span class="title">IVehicle</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Run</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;Truck is Running&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="keyword">region</span> Interface_Tank</span></span><br><span class="line">    <span class="keyword">interface</span> <span class="title">IWeapon</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">Fire</span>()</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">interface</span> <span class="title">ITank</span> : <span class="title">IVehicle</span>, <span class="title">IWeapon</span>	<span class="comment">// Tank 继承两个接口</span></span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">class</span> <span class="title">LightTank</span> : <span class="title">ITank</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Fire</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;Light Fire!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Run</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;Light Tank run&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title">HeavyTank</span> : <span class="title">ITank</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Fire</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;Heavy Fire!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Run</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;Heavy tank run&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当把两个完全不同的功能：Fire 与 Run 分开后，ITank 接口只需同时继承这两个接口即可，此时无需更改 Driver 类（该类只负责 Drive，其他均无法传入），实现了接口分离。</p>
</li>
<li><p>接口显式声明</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">region</span> Interface_Explicity</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title">IGentleman</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">love</span>()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title">IKiller</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">kill</span>()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">WarmKiller</span> : <span class="title">IGentleman</span>, <span class="title">IKiller</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">love</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Forever!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> IKiller.kill()	<span class="comment">//显式实现接口</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Explicity Kill&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line">    </span><br><span class="line"><span class="comment">//调用</span></span><br><span class="line">IKiller killer = <span class="keyword">new</span> WarmKiller();</span><br><span class="line">killer.kill();</span><br><span class="line"><span class="keyword">var</span> wk = (WarmKiller)killer;	<span class="comment">//可通过类型转换访问</span></span><br><span class="line">wk.love();</span><br><span class="line"><span class="keyword">var</span> wk2 = killer <span class="keyword">as</span> WarmKiller;</span><br><span class="line">wk2.love();</span><br></pre></td></tr></table></figure>
<p>该例旨在说明，实际案例中，Killer 不会明目张胆的被访问，而是隐藏自己，这个过程可通过显式实现接口解决，显示实现接口后，要调用方法，必须是该类型的变量。</p>
<p>换句话说，<strong>显示接口成员属于接口的成员，并不是类的成员，故不能通过类对象直接访问，而是通过接口对象来访问</strong>。</p>
</li>
</ul>
<h1 id="反射"><a href="#反射" class="headerlink" title="反射"></a>反射</h1><ul>
<li>反射不是 C# 语言的功能，而是 .NET 框架功能</li>
<li>创建对象不用 new 操作符</li>
</ul>
<h1 id="泛型"><a href="#泛型" class="headerlink" title="泛型"></a>泛型</h1><h2 id="初识泛型"><a href="#初识泛型" class="headerlink" title="初识泛型"></a>初识泛型</h2><ul>
<li>避免成员膨胀或类型膨胀<ul>
<li>类型膨胀：为实现不同类型的产品，每新增一个产品就增加一个类，导致类的数量快速膨胀</li>
</ul>
</li>
<li>正交性：泛型与类、接口、委托、方法、属性、字段等均有交叉，泛型看做横轴，其它实体看做纵轴的话，它们是正交的，由此形成了泛型类、泛型接口……</li>
</ul>
<h2 id="泛型实例"><a href="#泛型实例" class="headerlink" title="泛型实例"></a>泛型实例</h2><ul>
<li><p>泛型类</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Apple</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Color &#123;<span class="keyword">get</span>; <span class="keyword">set</span>;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">AppleBox</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> Apple Cargo &#123;<span class="keyword">get</span>; <span class="keyword">set</span>;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用</span></span><br><span class="line"></span><br><span class="line">Apple apple = <span class="keyword">new</span> Apple() &#123;Color = <span class="string">&quot;Red&quot;</span>&#125;;</span><br><span class="line">AppleBox applebox = <span class="keyword">new</span> AppleBox() &#123;Cargo = apple&#125;;</span><br><span class="line">Console.WriteLine(applebox.Cargo.Color);</span><br></pre></td></tr></table></figure>
<p>假设该老板后续想卖其它东西，则需为每样东西写一个对应的类及包装盒的类，导致类膨胀。</p>
<p>一个解决的办法是，只定义一种盒子，该盒子可装任意类型的产品：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Apple</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Color &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Book</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Box</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">object</span> Cargo &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; <span class="comment">// object 类型</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用</span></span><br><span class="line">Apple apple = <span class="keyword">new</span> Apple() &#123; Color = <span class="string">&quot;Red&quot;</span> &#125;;</span><br><span class="line">Book book = <span class="keyword">new</span> Book() &#123; Name = <span class="string">&quot;Book&quot;</span> &#125;;</span><br><span class="line"></span><br><span class="line">Box box1 = <span class="keyword">new</span> Box() &#123; Cargo = apple &#125;;</span><br><span class="line">Box box2 = <span class="keyword">new</span> Box() &#123; Cargo =  book &#125;;</span><br><span class="line"></span><br><span class="line">Console.WriteLine((box1.Cargo <span class="keyword">as</span> Apple)?.Color);    <span class="comment">//若是Apple, 打印 Color</span></span><br><span class="line">Console.WriteLine((box2.Cargo <span class="keyword">as</span> Book)?.Name);</span><br></pre></td></tr></table></figure>
<p>但该方法仍然不是最佳的，泛型类更加合理。</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Apple</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Color &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Book</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Box</span>&lt;<span class="title">TCargo</span>&gt; <span class="comment">//泛型类，类型参数</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> TCargo Cargo &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用</span></span><br><span class="line">Apple apple = <span class="keyword">new</span> Apple() &#123; Color = <span class="string">&quot;Red&quot;</span> &#125;;</span><br><span class="line">Book book = <span class="keyword">new</span> Book() &#123; Name = <span class="string">&quot;Book&quot;</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//泛型特化</span></span><br><span class="line">Box&lt;Apple&gt; box3 = <span class="keyword">new</span> Box&lt;Apple&gt;() &#123; Cargo = apple &#125;;</span><br><span class="line">Box&lt;Book&gt; box4 = <span class="keyword">new</span> Box&lt;Book&gt; &#123; Cargo = book &#125;;</span><br><span class="line"></span><br><span class="line">Console.WriteLine(box3.Cargo.Color);</span><br><span class="line">Console.WriteLine(box4.Cargo.Name);</span><br></pre></td></tr></table></figure>
</li>
<li><p>泛型接口</p>
<ul>
<li>若类实现的是泛型接口，该类也是泛型的</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title">IUnique</span>&lt;<span class="title">TID</span>&gt;	<span class="comment">//泛型接口</span></span><br><span class="line">&#123;</span><br><span class="line">    TID Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Student</span>&lt;<span class="title">TID</span>&gt; : <span class="title">IUnique</span>&lt;<span class="title">TID</span>&gt;   <span class="comment">//类实现的是泛型接口，该类也是泛型的</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> TID Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//特化</span></span><br><span class="line">Student&lt;<span class="built_in">int</span>&gt; student = <span class="keyword">new</span> Student&lt;<span class="built_in">int</span>&gt;() &#123; Id = <span class="number">1</span> , Name = <span class="string">&quot;LiHua&quot;</span>&#125;;</span><br><span class="line">Console.WriteLine(student.Id);</span><br><span class="line">Console.WriteLine(student.Name);</span><br></pre></td></tr></table></figure>
<p>也可以在实现接口时特化，此时类不再是泛型的：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title">IUnique</span>&lt;<span class="title">TID</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    TID Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Student</span> : <span class="title">IUnique</span>&lt;<span class="title">ulong</span>&gt;	<span class="comment">//实现时特化</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">ulong</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span> ; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//直接调用</span></span><br><span class="line">Student student2 = <span class="keyword">new</span> Student() &#123; Id = <span class="number">2</span>, Name = <span class="string">&quot;LiLei&quot;</span> &#125;;</span><br><span class="line">Console.WriteLine(student2.Id);</span><br><span class="line">Console.WriteLine(student2.Name);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="类型参数"><a href="#类型参数" class="headerlink" title="类型参数"></a>类型参数</h2><ul>
<li><p>类型参数的数量</p>
<p>上述例子中，泛型的类型参数是单个的，但其也可多个，如字典这个数据结构：</p>
  <figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">IDictionary&lt;<span class="built_in">int</span>,<span class="built_in">string</span>&gt; keyValues =  <span class="keyword">new</span> Dictionary&lt;<span class="built_in">int</span>, <span class="built_in">string</span>&gt;();</span><br><span class="line">keyValues[<span class="number">1</span>] = <span class="string">&quot;LiHua&quot;</span>;</span><br><span class="line">keyValues[<span class="number">2</span>] = <span class="string">&quot;LiLei&quot;</span>;</span><br><span class="line">Console.WriteLine(<span class="string">$&quot;Student Num.1 is <span class="subst">&#123;keyValues[<span class="number">1</span>]&#125;</span>&quot;</span>);</span><br><span class="line">Console.WriteLine(<span class="string">$&quot;Student Num.2 is <span class="subst">&#123;keyValues[<span class="number">2</span>]&#125;</span>&quot;</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>类型参数自动推断</p>
<p>一个很简单的例子，不同类型的数求和，若用方法实现，每个类型的数据都需要写一个方法，导致成员方法膨胀！</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="built_in">int</span> <span class="title">Sum</span>(<span class="params"><span class="built_in">int</span> a, <span class="built_in">int</span> b</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="built_in">double</span> <span class="title">Sum</span>(<span class="params"><span class="built_in">double</span> a, <span class="built_in">double</span> b</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//调用</span></span><br><span class="line"><span class="built_in">int</span> a1 = <span class="number">1</span>, b1 = <span class="number">10</span>;</span><br><span class="line"><span class="built_in">double</span> a2 = <span class="number">1.1</span>, b2 = <span class="number">2.2</span>;</span><br><span class="line">Console.WriteLine(Sum(a1, b1));</span><br><span class="line">Console.WriteLine(Sum(a2, b2));</span><br></pre></td></tr></table></figure>
<p>采用泛型可解决上述问题（关于这里可以直接使用＋运算符可参考<a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/dotnet/standard/generics/math">文档</a>，.NET版本7-8）：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> T <span class="title">Sum</span>&lt;<span class="title">T</span>&gt;(<span class="params">T left, T right</span>)</span></span><br><span class="line"><span class="function">    <span class="keyword">where</span> T : INumber&lt;T&gt;</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> left + right;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用</span></span><br><span class="line"><span class="built_in">int</span> a1 = <span class="number">1</span>, b1 = <span class="number">10</span>;</span><br><span class="line"><span class="built_in">double</span> a2 = <span class="number">1.1</span>, b2 = <span class="number">2.2</span>;</span><br><span class="line">Console.WriteLine(Sum(a1, b1));</span><br><span class="line">Console.WriteLine(Sum(a2, b2));</span><br></pre></td></tr></table></figure>
<p>在传入参数时，无需显示特化参数的类型，编译器会自动推荐其类型。</p>
</li>
</ul>
<h2 id="泛型委托"><a href="#泛型委托" class="headerlink" title="泛型委托"></a>泛型委托</h2><ul>
<li><p>Action 泛型委托：引用没有返回值的方法，特化传入方法形参类型</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Say</span>(<span class="params"><span class="built_in">string</span> str</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;Hello, <span class="subst">&#123;str&#125;</span>&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Mul</span>(<span class="params"><span class="built_in">int</span> a</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(a * <span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用</span></span><br><span class="line">Action&lt;<span class="built_in">string</span>&gt; action1 = Say;</span><br><span class="line">action1.Invoke(<span class="string">&quot;LiHua&quot;</span>);</span><br><span class="line">action1(<span class="string">&quot;LiHua&quot;</span>);</span><br><span class="line"></span><br><span class="line">Action&lt;<span class="built_in">int</span>&gt; action2 = Mul;</span><br><span class="line">action2.Invoke(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>Func 泛型委托：泛型参数指代方法形参的类型，最后一个参数为返回值类型</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="built_in">int</span> <span class="title">Sum</span>(<span class="params"><span class="built_in">int</span> a, <span class="built_in">int</span> b</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="built_in">double</span> <span class="title">Sum</span>(<span class="params"><span class="built_in">double</span> a, <span class="built_in">double</span> b</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//调用</span></span><br><span class="line"><span class="comment">//Func&lt;int, int, int&gt; func1 = new Func&lt;int, int, int&gt;(Sum);</span></span><br><span class="line"><span class="comment">//var func1 = new Func&lt;int, int, int&gt;(Sum);</span></span><br><span class="line">Func&lt;<span class="built_in">int</span>, <span class="built_in">int</span>, <span class="built_in">int</span>&gt; func1 = Sum;</span><br><span class="line">Func&lt;<span class="built_in">double</span>, <span class="built_in">double</span>, <span class="built_in">double</span>&gt; func2 = Sum;</span><br><span class="line"></span><br><span class="line">Console.WriteLine(func1.Invoke(<span class="number">10</span>, <span class="number">20</span>));</span><br><span class="line">Console.WriteLine(func2.Invoke(<span class="number">10.5</span>, <span class="number">20.5</span>));</span><br></pre></td></tr></table></figure>
</li>
<li><p>泛型委托与 Lambda 表达式</p>
<p>对某些功能简单的方法不想声明，而是随调用随声明，且是匿名声明</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Func&lt;<span class="built_in">int</span>, <span class="built_in">int</span>, <span class="built_in">int</span>&gt; func3 = (<span class="built_in">int</span> a, <span class="built_in">int</span> b) =&gt; &#123; <span class="keyword">return</span> a + b; &#125;;</span><br><span class="line">Console.WriteLine(func3(<span class="number">10</span>, <span class="number">20</span>));</span><br></pre></td></tr></table></figure>
<p>由于声明泛型委托时已经指明了参数类型，故 Lambda 表达式中可省略参数类型：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Func&lt;<span class="built_in">int</span>, <span class="built_in">int</span>, <span class="built_in">int</span>&gt; func3 = (a, b) =&gt; &#123; <span class="keyword">return</span> a + b; &#125;;</span><br></pre></td></tr></table></figure>
<p>这样做的好处是，我们不想将简单的功能声明在命名空间中，占用或污染命名空间，而是留给重要的功能。</p>
</li>
<li><p>声明泛型委托：自定义泛型委托</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="built_in">delegate</span> T <span class="title">MyDele</span>&lt;<span class="title">T</span>&gt;(<span class="params">T a, T b</span>)</span>;	<span class="comment">//泛型委托声明</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="built_in">int</span> <span class="title">Add</span>(<span class="params"><span class="built_in">int</span> a, <span class="built_in">int</span> b</span>)</span> &#123; <span class="keyword">return</span> a + b; &#125;</span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="built_in">double</span> <span class="title">Mul</span>(<span class="params"><span class="built_in">double</span> a, <span class="built_in">double</span> b</span>)</span> &#123;  <span class="keyword">return</span> a * b; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//调用</span></span><br><span class="line">MyDele&lt;<span class="built_in">int</span>&gt; myDele1 = <span class="keyword">new</span> MyDele&lt;<span class="built_in">int</span>&gt;(Add);</span><br><span class="line">Console.WriteLine(myDele1(<span class="number">100</span>, <span class="number">200</span>));</span><br><span class="line">MyDele&lt;<span class="built_in">double</span>&gt; myDele2 = <span class="keyword">new</span> MyDele&lt;<span class="built_in">double</span>&gt;(Mul);</span><br><span class="line">Console.WriteLine(myDele2(<span class="number">3.0</span>, <span class="number">5.2</span>));</span><br></pre></td></tr></table></figure>
<p>自定义委托使用不多，一般使用内置的 Action 和 Func。</p>
</li>
</ul>
<h1 id="partial-类"><a href="#partial-类" class="headerlink" title="partial 类"></a>partial 类</h1><ul>
<li>C# 编译器允许把一个类分成两部分或多部分编写，且每部分都以自己的节奏进行版本更新</li>
<li>减少派生类：使用 partial 类后，不再需要派生，各部分合起来还是基类的名称</li>
<li>允许不同部分用不同的编程语言编写，如 WPF 程序由 C# 和 XAML 语言组成</li>
</ul>
<h1 id="枚举"><a href="#枚举" class="headerlink" title="枚举"></a>枚举</h1><ul>
<li><p>目的：有限的约束</p>
</li>
<li><p>本质：限制了取值范围的整数</p>
<p>如一周只有七天，从星期一到星期天，为了正确约束，可用枚举类型，即只能从枚举中选择一个。</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">enum</span> Week</span><br><span class="line">&#123;</span><br><span class="line">    MON,</span><br><span class="line">    TUS,</span><br><span class="line">    Won, <span class="comment">//最后一项,可写可不写，建议写，方便下次添加其他项</span></span><br><span class="line">    <span class="comment">//…</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>枚举默认第一个值为 0，依次递增，也可自定义值。</p>
</li>
<li><p>比特位用法：利用整数的 按位与或 操作</p>
<p>比如一个人同时掌握多项技能（假若这些技能是有限且固定的），可利用整数的比特位操作（如8421这样的整数，对应的二进制的特性）：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">enum</span> Skill</span><br><span class="line">&#123;</span><br><span class="line">    Drive = <span class="number">1</span>,</span><br><span class="line">    Cook = <span class="number">2</span>,</span><br><span class="line">    Program = <span class="number">4</span>,</span><br><span class="line">    Teach = <span class="number">8</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Person</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> ID &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> Skill Skill &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//调用</span></span><br><span class="line">Person person = <span class="keyword">new</span> Person();</span><br><span class="line">person.Skill = Skill.Cook | Skill.Teach | Skill.Drive |　Skill.Program;</span><br><span class="line">Console.WriteLine(person.Skill);	<span class="comment">// 15 = 8+4+2+1</span></span><br><span class="line"><span class="comment">//通过按位与的方式判断是否掌握了某种技能</span></span><br><span class="line">Console.WriteLine((person.Skill &amp; Skill.Teach) == Skill.Teach);	<span class="comment">//True</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="结构体"><a href="#结构体" class="headerlink" title="结构体"></a>结构体</h1><ul>
<li><p>值类型</p>
</li>
<li><p>对象之间的赋值是完整的赋值一份，相互不会影响</p>
  <figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> Students</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> ID &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Students students1 = <span class="keyword">new</span> Students() &#123; ID = <span class="number">1</span>, Name = <span class="string">&quot;Hua&quot;</span> &#125;;</span><br><span class="line">Students students2 = students1;	<span class="comment">//赋值，是两个独立的对象</span></span><br><span class="line">students2.Name = <span class="string">&quot;Lei&quot;</span>;	<span class="comment">//不会改变 students1 的属性</span></span><br><span class="line">students2.ID = <span class="number">2</span>;</span><br><span class="line">Console.WriteLine(<span class="string">$&quot;Num:<span class="subst">&#123;students1.ID&#125;</span>, Name: <span class="subst">&#123;students1.Name&#125;</span>&quot;</span>);</span><br><span class="line">Console.WriteLine(<span class="string">$&quot;Num:<span class="subst">&#123;students2.ID&#125;</span>, Name: <span class="subst">&#123;students2.Name&#125;</span>&quot;</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>可以实现接口</p>
  <figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title">ISpeak</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Speak</span>()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> Students:ISpeak</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> ID &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Speak</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;I&#x27;m Num <span class="subst">&#123;<span class="keyword">this</span>.ID&#125;</span> student <span class="subst">&#123;<span class="keyword">this</span>.Name&#125;</span>&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Students students1 = <span class="keyword">new</span> Students() &#123; ID = <span class="number">1</span>, Name = <span class="string">&quot;Hua&quot;</span> &#125;;</span><br><span class="line">students1.Speak();</span><br></pre></td></tr></table></figure>
</li>
<li><p>可以从接口派生：结构体不能有基结构体，即结构体不能从其他类或结构体派生而来，但可从接口派生</p>
</li>
<li><p>不能拥有显式无参构造器，但允许显式有参构造器</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title">ISpeak</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Speak</span>()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> Students:ISpeak</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//public Students() //不允许显示无参</span></span><br><span class="line">    <span class="comment">//&#123;</span></span><br><span class="line">    <span class="comment">//&#125;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Students</span>(<span class="params"><span class="built_in">int</span> id, <span class="built_in">string</span> name</span>) <span class="comment">//允许显式有参</span></span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.ID = id;</span><br><span class="line">        <span class="keyword">this</span>.Name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> ID &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Speak</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;I&#x27;m Num <span class="subst">&#123;<span class="keyword">this</span>.ID&#125;</span> student <span class="subst">&#123;<span class="keyword">this</span>.Name&#125;</span>&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Students students = <span class="keyword">new</span> Students(<span class="number">3</span>,<span class="string">&quot;May&quot;</span>);</span><br><span class="line">students.Speak();</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="Lambda-表达式"><a href="#Lambda-表达式" class="headerlink" title="Lambda 表达式"></a>Lambda 表达式</h1><ul>
<li><p>一种 inline （调用时才声明）的匿名方法</p>
</li>
<li><p>省略函数名，直接给出参数，通过符号 =&gt; 给出函数体，意为将参数带入符号后表达式或函数体</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Func&lt;<span class="built_in">int</span>, <span class="built_in">int</span>, <span class="built_in">int</span>&gt; func = <span class="keyword">new</span> Func&lt;<span class="built_in">int</span>, <span class="built_in">int</span>, <span class="built_in">int</span>&gt;((<span class="built_in">int</span> a, <span class="built_in">int</span> b) =&gt; &#123; <span class="keyword">return</span> a * b; &#125;);</span><br><span class="line">Console.WriteLine(func(<span class="number">10</span>, <span class="number">5</span>));</span><br><span class="line">func = <span class="keyword">new</span> Func&lt;<span class="built_in">int</span>, <span class="built_in">int</span>, <span class="built_in">int</span>&gt;((a,b) =&gt; &#123; <span class="keyword">return</span> a + b; &#125;);<span class="comment">//可重用</span></span><br><span class="line">Console.WriteLine(func(<span class="number">10</span>, <span class="number">5</span>));</span><br></pre></td></tr></table></figure>
<p>上述写法略显冗余，实际中常用简洁的写法：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//简洁写法，常用</span></span><br><span class="line">Func&lt;<span class="built_in">int</span>, <span class="built_in">int</span>, <span class="built_in">int</span>&gt; func = (<span class="built_in">int</span> a, <span class="built_in">int</span> b) =&gt; &#123; <span class="keyword">return</span> a * b; &#125;;</span><br><span class="line">func = (a,b) =&gt; &#123; <span class="keyword">return</span> a + b; &#125;; <span class="comment">//重用</span></span><br></pre></td></tr></table></figure>
<p>可见，既然可以直接把 Lambda 表达式赋值给泛型委托类型的实例，那么，假若有个函数的参数是泛型委托实例，则可以直接传入 Lambda 表达式。</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">DoSTH</span>&lt;<span class="title">T</span>&gt;(<span class="params">Func&lt;T, T, T&gt; func, T x, T y</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(func(x, y));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//调用</span></span><br><span class="line">DoSTH&lt;<span class="built_in">int</span>&gt;((<span class="built_in">int</span> a, <span class="built_in">int</span> b) =&gt; &#123; <span class="keyword">return</span> a * b; &#125;, <span class="number">100</span>, <span class="number">200</span>);</span><br><span class="line"><span class="comment">//由于传入的 100， 200 为整型，编译器会自动推荐其类型，故简化为：</span></span><br><span class="line">DoSTH((a, b) =&gt; &#123; <span class="keyword">return</span> a + b; &#125;, <span class="number">100</span>, <span class="number">200</span>);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="LINQ数据访问"><a href="#LINQ数据访问" class="headerlink" title="LINQ数据访问"></a>LINQ数据访问</h1><ul>
<li>LINQ2SQL：集成于 .NET，功能不强</li>
<li>EF（ADO.NET）：独立于 .NET，功能强大</li>
<li>本质是通过 C# 进行数据库的访问，底层还是将 C# 转为了 SQL</li>
<li>具体方法参考<a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/dotnet/api/system.linq.enumerable?view=net-7.0">微软文档</a>：直接传入 Lambda 表达式</li>
</ul>
<h1 id="Windows-窗体"><a href="#Windows-窗体" class="headerlink" title="Windows 窗体"></a>Windows 窗体</h1><ul>
<li>窗体是 Windows 应用程序的基本单元</li>
<li>窗体也是对象，窗体类定义了生成窗体的模板，每实例化一个窗体类，就产生一个窗体</li>
<li><p>.NET框架类库的 System.Windows.Forms 命名空间中定义的 Form 类是所有窗体类的基类</p>
<h2 id="窗台常用方法"><a href="#窗台常用方法" class="headerlink" title="窗台常用方法"></a>窗台常用方法</h2></li>
<li><p>Show：显示窗体</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Show</span>()</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Show</span>(<span class="params">IWin32Window owner</span>)</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Hide：隐藏窗体</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Hide</span>()</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Close：关闭窗体</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Close</span>()</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="窗体常用事件"><a href="#窗体常用事件" class="headerlink" title="窗体常用事件"></a>窗体常用事件</h2><ul>
<li><p>Load：窗体加载</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Form1_Load</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span> &#123;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>FormClosing：窗体关闭时触发</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Form1Closing</span>(<span class="params"><span class="built_in">object</span> sender, FormClosingEventArgs e</span>)</span> &#123;&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="MDI-窗体"><a href="#MDI-窗体" class="headerlink" title="ＭDI 窗体"></a>ＭDI 窗体</h2><ul>
<li><p>父子窗体设置</p>
<ul>
<li><p>设置父窗体：属性面板中，将 IsMdiContainer 属性设置为 True</p>
</li>
<li><p>子窗体：form.MdiParent = this</p>
</li>
</ul>
</li>
<li><p>子窗体排列</p>
<p>通过使用带有 MdiLayout 枚举的 LayoutMdi 方法来排列多文档界面父窗体中的子窗体</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">LayoutMdi</span>(<span class="params">MdiLayout <span class="keyword">value</span></span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// 调用</span></span></span><br><span class="line"><span class="function"><span class="title">LayoutMdi</span>(<span class="params">MdiLayout.TileHorizontal</span>)</span>; <span class="comment">// 水平平铺</span></span><br><span class="line">LayoutMdi(MdiLayout.TileVertical); <span class="comment">// 垂直平铺</span></span><br><span class="line">LayoutMdi(MdiLayout.Cascade); <span class="comment">// 层叠排列</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="继承窗体"><a href="#继承窗体" class="headerlink" title="继承窗体"></a>继承窗体</h2><ul>
<li><p>作用：将一个窗体的全部功能继承</p>
</li>
<li><p>方法：</p>
<ul>
<li>修改继承类：直接在代码后面添加要继承的窗体</li>
<li>使用 VS 继承选取器：添加-窗体-继承的窗体</li>
</ul>
</li>
<li><p>继承前必须先编译，再添加继承项</p>
</li>
<li>继承后的窗体控件默认锁定无法修改，需修改基窗体的 Modifiers 属性，由 private 改为 public（修改后编译生效）</li>
</ul>
<h2 id="控件"><a href="#控件" class="headerlink" title="控件"></a>控件</h2><h3 id="控件概述"><a href="#控件概述" class="headerlink" title="控件概述"></a>控件概述</h3><ul>
<li><p>控件是带有可视化表示形式的组件（空间是可视化的，组件是不可视化的）</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/dotnet/api/system.windows.forms.control?view=windowsdesktop-7.0">Control 类</a>是定义控件的基类（该基类的命名空间<a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/dotnet/api/system.windows.forms?view=windowsdesktop-7.0">System.Windows.Forms</a>）</p>
</li>
</ul>
<h3 id="常用控件"><a href="#常用控件" class="headerlink" title="常用控件"></a>常用控件</h3><p><em>以下控件内容、属性、事件均可在属性中修改</em></p>
<ul>
<li><p>Label：标签控件，显示用户不能编辑的文本</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//可直接在属性中修改</span></span><br><span class="line"><span class="keyword">this</span>.label1.Text = <span class="string">&quot;输入&quot;</span>;</span><br><span class="line"><span class="keyword">this</span>.label1.Visible = <span class="literal">false</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Button：按钮控件</p>
</li>
<li><p>TextBox：文本框控件，获取用户输入数据或显示文本（可编辑文本，也可为只读控件，可多行）</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.textBox1.Multiline = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">this</span>.textBox1.PasswordChar = <span class="string">&#x27;*&#x27;</span>;</span><br><span class="line"><span class="keyword">this</span>.textBox1.ReadOnly = <span class="literal">true</span>;</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">textBox1_TextChanged</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span> &#123;&#125; <span class="comment">//事件</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>RichTextBox：显示、输入、操作带格式文本</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">richTextBox1.SelectionFont = <span class="keyword">new</span> Font(<span class="string">&quot;宋体&quot;</span>, <span class="number">12</span>, FontStyle.Bold);</span><br><span class="line">richTextBox1.SelectionColor = Color.Red;</span><br><span class="line">richTextBox1.Text = <span class="string">&quot;www.byd.com&quot;</span>;</span><br><span class="line">richTextBox1.SelectionBullet = <span class="literal">true</span>; <span class="comment">//段落样式</span></span><br><span class="line">richTextBox1.SelectionIndent = <span class="number">10</span>; <span class="comment">//设置距离左边距离</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">richTextBox1_LinkClicked</span>(<span class="params"><span class="built_in">object</span> sender, LinkClickedEventArgs e</span>)	<span class="comment">//超链接点击事件</span></span></span><br><span class="line">&#123;</span><br><span class="line">    System.Diagnostics.Process.Start(e.LinkText);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ComboBox：下拉组合框控件</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.comboBox1.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;	<span class="comment">//可在属性中设置</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">comboBox1_SelectedIndexChanged</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//SelectedItem 获取用户选中项</span></span><br><span class="line">    MessageBox.Show(comboBox1.SelectedItem.ToString());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>CheckBox：是否选取了某个控件</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">checkBox1_CheckedChanged</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//if (checkBox1.Checked)</span></span><br><span class="line">    <span class="comment">//&#123;</span></span><br><span class="line">    <span class="comment">//    MessageBox.Show(&quot;Clicked!&quot;);</span></span><br><span class="line">    <span class="comment">//&#125;</span></span><br><span class="line">    <span class="keyword">if</span> (checkBox1.CheckState == CheckState.Checked)</span><br><span class="line">    &#123;</span><br><span class="line">        MessageBox.Show(<span class="string">&quot;Clicked!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>RadioButton：单选按钮控件（多个控件只能选一个）</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">radioButton1_CheckedChanged</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (radioButton1.Checked == <span class="literal">true</span>)</span><br><span class="line">        MessageBox.Show(<span class="string">&quot;YES&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>NumericUpDown：数字按钮调节</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">numericUpDown1.Value = <span class="number">10</span>;  <span class="comment">//设置或获取默认值，0~100</span></span><br><span class="line">numericUpDown1.DecimalPlaces = <span class="number">2</span>; <span class="comment">//小数点位数</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>ListBox：列表控件，显示一个列表，用户可选择一项或者多项</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">listBox1.Items.Add(<span class="string">&quot;UPDOWN&quot;</span>);</span><br><span class="line">listBox1.Items.Remove(<span class="string">&quot;UPDOWN&quot;</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>Panel：分组窗体，批量控制控件的隐藏和显示（panel 内部的所有空间隐藏或显示）</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">panel1.Hide();</span><br><span class="line">panel1.Show();</span><br></pre></td></tr></table></figure>
</li>
<li><p>GroupBox：分组框</p>
</li>
<li><p>TabControl：选项卡</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在选项卡中添加控件</span></span><br><span class="line">System.Windows.Forms.Button btn = <span class="keyword">new</span> System.Windows.Forms.Button();</span><br><span class="line">btn.Text = <span class="string">&quot;New Button&quot;</span>;</span><br><span class="line">tabPage2.Controls.Add(btn);</span><br><span class="line"></span><br><span class="line"><span class="comment">//选项卡的添加删除</span></span><br><span class="line">TabPage tabPage = <span class="keyword">new</span> TabPage(<span class="string">&quot;New 1&quot;</span>);</span><br><span class="line"><span class="comment">//tabPage.Text = &quot;New1&quot;;</span></span><br><span class="line">tabControl1.TabPages.Add(tabPage);</span><br><span class="line">tabControl1.TabPages.Remove(tabControl1.SelectedTab);</span><br><span class="line">tabControl1.TabPages.Clear();</span><br></pre></td></tr></table></figure>
</li>
<li><p>MenuStrip：菜单栏，支持多文档、菜单合并、工具提示等诸多功能</p>
<p>快捷键设置：直接在 Text 属性中的文字后添加 (&amp;快捷键)</p>
</li>
<li><p>ToolStrip：工具栏</p>
</li>
<li>StatusStrip：状态栏，显示窗体上一些对象的相关信息，通常放置在窗体最底部</li>
</ul>
<h3 id="高级控件"><a href="#高级控件" class="headerlink" title="高级控件"></a>高级控件</h3><ul>
<li><p>ImageList：存储图片资源并在控件上显示，可通过属性设置</p>
</li>
<li><p>ListView：列表视图</p>
</li>
<li><p>TreeView：树形</p>
</li>
<li><p>ErrorProvider：不打扰用户的情况下提示用户，是组件</p>
</li>
<li><p>Timer：计时器组件，定期触发事件</p>
<ul>
<li>时间间隔长度由 Interval 属性定义，单位为 ms</li>
<li>启用该组件后，间隔触发 Tick 事件</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Microsoft.VisualBasic; <span class="comment">//使用 DateAndTime 所需</span></span><br><span class="line"></span><br><span class="line">DateTime dtNow, dtSet;</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Form3_Load</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    timer1.Interval = <span class="number">1000</span>; <span class="comment">//设置 timer1 计时器执行时间间隔</span></span><br><span class="line">    timer1.Enabled = <span class="literal">true</span>;  <span class="comment">//启动 timer1 计时器  = timer1.start;</span></span><br><span class="line">    numericUpDown1.Value = DateTime.Now.Hour;</span><br><span class="line">    numericUpDown2.Value = DateTime.Now.Minute;</span><br><span class="line">    numericUpDown3.Value = DateTime.Now.Second;</span><br><span class="line">    numericUpDown1.Maximum = <span class="number">24</span>;</span><br><span class="line">    numericUpDown2.Maximum = <span class="number">59</span>;</span><br><span class="line">    numericUpDown3.Maximum = <span class="number">59</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">button1_Click</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (button1.Text == <span class="string">&quot;设置&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        button1.Text = <span class="string">&quot;停止&quot;</span>;</span><br><span class="line">        timer2.Start();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (button1.Text == <span class="string">&quot;停止&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        button1.Text = <span class="string">&quot;设置&quot;</span>;</span><br><span class="line">        timer2.Stop();</span><br><span class="line">        label7.Text = <span class="string">&quot;已停止计时&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">timer1_Tick</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    label2.Text = DateTime.Now.ToString();</span><br><span class="line">    dtNow = Convert.ToDateTime(label2.Text);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">timer2_Tick</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    dtSet = Convert.ToDateTime(numericUpDown1.Value + <span class="string">&quot;:&quot;</span> + numericUpDown2.Value + <span class="string">&quot;:&quot;</span> + numericUpDown3.Value);</span><br><span class="line">    <span class="built_in">long</span> countdown = DateAndTime.DateDiff(DateInterval.Second, dtNow, dtSet, FirstDayOfWeek.Monday);</span><br><span class="line">    <span class="keyword">if</span> (countdown &gt; <span class="number">0</span>)</span><br><span class="line">        label7.Text = <span class="string">&quot;倒计时&quot;</span> + countdown + <span class="string">&quot;秒&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        label7.Text = <span class="string">&quot;倒计时结束&quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>ProgressBar：进度条</p>
<ul>
<li>Value：获取进度条进度</li>
<li>Minimum：设置最小值</li>
<li>Maximum：设置最大值</li>
<li>Step：进度条递增值</li>
<li>PerformStep：按照上述属性递增进度</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">progressBar1.Value = <span class="number">0</span>;</span><br><span class="line">progressBar1.Minimum = <span class="number">0</span>;</span><br><span class="line">progressBar1.Maximum = <span class="number">100</span>;</span><br><span class="line">progressBar1.Step = <span class="number">1</span>;	<span class="comment">//步长</span></span><br><span class="line"><span class="comment">// 递增进度</span></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; progressBar1.Maximum; i++)</span><br><span class="line">    progressBar1.PerformStep();</span><br></pre></td></tr></table></figure>
<p>由于该控件只能以水平方向显示，若想改变显示样式，可通过<a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/dotnet/api/system.windows.forms.progressbarrenderer?view=windowsdesktop-7.0">ProgressBarRender类</a>实现。</p>
</li>
<li><p>DataGridView：数据表格控件，以表格形式显示数据</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//属性控制：不允许用户增加、删除行</span></span><br><span class="line">dataGridView1.AllowUserToAddRows = <span class="literal">false</span>; </span><br><span class="line">dataGridView1.AllowUserToDeleteRows = <span class="literal">false</span>;</span><br><span class="line">dataGridView1.RowHeadersVisible = <span class="literal">false</span>; <span class="comment">//去除行表头列，默认是空白</span></span><br><span class="line">conn = <span class="keyword">new</span> SqlConnection(strCon);</span><br><span class="line">sqlDataAdapter = <span class="keyword">new</span> SqlDataAdapter(<span class="string">&quot;select * from tb1&quot;</span>, conn);</span><br><span class="line">ds = <span class="keyword">new</span> DataSet();</span><br><span class="line">sqlDataAdapter.Fill(ds);</span><br><span class="line"><span class="comment">//int k = ds.Tables.Count;</span></span><br><span class="line"><span class="comment">//var k = dataGridView1.Rows.Count;</span></span><br><span class="line">dataGridView1.DataSource = ds.Tables[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//遍历所有行禁止按列排序</span></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; dataGridView1.Columns.Count; i++)</span><br><span class="line">    dataGridView1.Columns[i].SortMode = DataGridViewColumnSortMode.NotSortable;</span><br><span class="line"><span class="comment">//设置整行选中</span></span><br><span class="line">dataGridView1.SelectionMode = DataGridViewSelectionMode.FullRowSelect;</span><br><span class="line"><span class="comment">//设置隔行不同色显示</span></span><br><span class="line"><span class="keyword">foreach</span> (DataGridViewRow dgvRow <span class="keyword">in</span> dataGridView1.Rows)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (dgvRow.Index % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">        dataGridView1.Rows[dgvRow.Index].DefaultCellStyle.BackColor = Color.LightSalmon;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        dataGridView1.Rows[dgvRow.Index].DefaultCellStyle.BackColor = Color.LightGreen;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dataGridView1.ReadOnly = <span class="literal">true</span>; <span class="comment">//只读</span></span><br><span class="line">dataGridView1.DefaultCellStyle.SelectionBackColor = Color.LightSkyBlue; <span class="comment">//选中行背景色</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//单击单元格任意部分发生事件</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">dataGridView1_CellClick</span>(<span class="params"><span class="built_in">object</span> sender, DataGridViewCellEventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (e.RowIndex &gt;= <span class="number">0</span>)<span class="comment">//RowIndex 从0开始，如5行，则为 0~4</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//获取选中行的第一个单元格中的值</span></span><br><span class="line">        <span class="built_in">int</span> selectID = (<span class="built_in">int</span>)dataGridView1.Rows[e.RowIndex].Cells[<span class="number">0</span>].Value;<span class="comment">//获取选中的行号</span></span><br><span class="line">        conn = <span class="keyword">new</span> SqlConnection(strCon);</span><br><span class="line">        <span class="comment">//设置选中行显示在控件中</span></span><br><span class="line">        sqlDataAdapter = <span class="keyword">new</span> SqlDataAdapter(<span class="string">&quot;select * from tb1 where id = &quot;</span> + selectID + <span class="string">&quot;&quot;</span>, conn);</span><br><span class="line">        ds = <span class="keyword">new</span> DataSet();</span><br><span class="line">        sqlDataAdapter.Fill(ds);</span><br><span class="line">        <span class="keyword">if</span> (ds.Tables[<span class="number">0</span>].Rows.Count &gt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            textBox3.Text = ds.Tables[<span class="number">0</span>].Rows[<span class="number">0</span>][<span class="number">0</span>].ToString();</span><br><span class="line">            textBox4.Text = ds.Tables[<span class="number">0</span>].Rows[<span class="number">0</span>][<span class="number">1</span>].ToString();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="数据库访问"><a href="#数据库访问" class="headerlink" title="数据库访问"></a>数据库访问</h1><h2 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h2><h3 id="SQL-语言"><a href="#SQL-语言" class="headerlink" title="SQL  语言"></a>SQL  语言</h3><ul>
<li>不区分大小写</li>
<li>只识别一个空格</li>
<li>可换行</li>
<li>可写注释（/**/）</li>
</ul>
<h3 id="SQL-语法"><a href="#SQL-语法" class="headerlink" title="SQL 语法"></a>SQL 语法</h3><ul>
<li><p>数据库、表的创建</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> database db_name	<span class="operator">/</span><span class="operator">/</span>创建数据库</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> table_name(</span><br><span class="line">    列名<span class="number">1</span> 数据类型,</span><br><span class="line">    列名<span class="number">2</span> 数据类型,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
</li>
<li><p>增删改查</p>
<p>假设我们已建数据库 db，建表 tb，表中有两个字段：id, name：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb(id, name) <span class="keyword">values</span>(<span class="number">1</span>, <span class="string">&#x27;小李&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">update</span> tb <span class="keyword">set</span> name <span class="operator">=</span> <span class="string">&#x27;小李&#x27;</span> <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> tb <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="ADO-NET-对象模型"><a href="#ADO-NET-对象模型" class="headerlink" title="ADO.NET 对象模型"></a>ADO.NET 对象模型</h2><h3 id="对象模型"><a href="#对象模型" class="headerlink" title="对象模型"></a>对象模型</h3><ul>
<li><p>微软 .NET 数据库的访问框架</p>
</li>
<li><p>数据库应用程序和数据源之间的桥梁</p>
</li>
<li><p>对象模型：</p>
<ul>
<li><p>数据源</p>
</li>
<li><p>Connection 对象：提供与数据库的链接功能</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> sqlstr = <span class="string">&quot;Server = LAPTOP-K9IFEVSM; DataBase = db2; uid = sa; pwd = 123&quot;</span>;</span><br><span class="line">SqlConnection conn = <span class="keyword">new</span> SqlConnection(sqlstr);</span><br><span class="line">conn.Open();</span><br><span class="line"><span class="keyword">if</span> (conn.State == ConnectionState.Open) </span><br><span class="line">&#123;</span><br><span class="line">    MessageBox.Show(<span class="string">&quot;SS On!&quot;</span>);</span><br><span class="line">    conn.Close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (conn.State == ConnectionState.Closed)</span><br><span class="line">    MessageBox.Show(<span class="string">&quot;SS Down!&quot;</span>);</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>Command 对象：返回数据、修改数据、运行存储过程、发送数据库命令等</p>
<p>用于对数据源进行增删改查等操作，SqlCommand</p>
<ul>
<li>使用 Command 对象调用 sql 语句操作对象</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> sqlstr = <span class="string">&quot;Server = LAPTOP-K9IFEVSM; DataBase = db; uid = sa; pwd = 123&quot;</span>;</span><br><span class="line">SqlConnection conn = <span class="keyword">new</span> SqlConnection( sqlstr );</span><br><span class="line"><span class="built_in">string</span> str_sql = <span class="string">&quot;insert into tb1(id, name) values(&quot;</span> + Convert.ToInt16(textBox1.Text) + <span class="string">&quot;, &#x27;&quot;</span> + textBox2.Text + <span class="string">&quot;&#x27;)&quot;</span>;</span><br><span class="line">SqlCommand sqlcomm = <span class="keyword">new</span> SqlCommand(str_sql, conn);</span><br><span class="line">conn.Open();</span><br><span class="line"><span class="built_in">int</span> k = sqlcomm.ExecuteNonQuery();  <span class="comment">//执行 SQL 语句并返回受影响的行数</span></span><br><span class="line"><span class="keyword">if</span> (k &gt; <span class="number">0</span>)</span><br><span class="line">    label1.Text = <span class="string">&quot;添加成功&quot;</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    label1.Text = <span class="string">&quot;添加失败&quot;</span>;</span><br><span class="line">conn.Close();</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> sqlstr = <span class="string">&quot;Server = LAPTOP-K9IFEVSM; DataBase = db; uid = sa; pwd = 123&quot;</span>;</span><br><span class="line">SqlConnection sqlconn = <span class="keyword">new</span> SqlConnection(sqlstr);</span><br><span class="line"><span class="built_in">string</span> sqlstr1 = <span class="string">&quot;delete from tb1 where id = 15&quot;</span>;</span><br><span class="line">SqlCommand sqcomm1 = <span class="keyword">new</span> SqlCommand(sqlstr1, sqlconn);</span><br><span class="line">sqlconn.Open();</span><br><span class="line"><span class="built_in">int</span> k = sqcomm1.ExecuteNonQuery();</span><br><span class="line"><span class="keyword">if</span> (k &gt; <span class="number">0</span>)</span><br><span class="line">    label1.Text = <span class="string">&quot;删除成功&quot;</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    label1.Text = <span class="string">&quot;删除失败&quot;</span>;</span><br><span class="line">sqlconn.Close();</span><br></pre></td></tr></table></figure>
<ul>
<li><p>使用 Command 对象调用存储过程</p>
<p><em>在调用存储过程前，必须现在数据库中创建该过程</em></p>
</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">SqlConnection sqlconn = <span class="keyword">new</span> SqlConnection(<span class="string">&quot;Server = LAPTOP-K9IFEVSM; DataBase = db; uid = sa; pwd = 123&quot;</span>);</span><br><span class="line"><span class="comment">//string str_sql = &quot;insert into tb1(id, name) values(&quot; + Convert.ToInt32(textBox1.Text) + &quot;, &#x27;&quot; + textBox2.Text + &quot;&#x27;)&quot;;</span></span><br><span class="line">SqlCommand sqlcmd = <span class="keyword">new</span> SqlCommand();</span><br><span class="line">sqlcmd.Connection = sqlconn;    <span class="comment">//指定数据库连接对象</span></span><br><span class="line">sqlcmd.CommandType = CommandType.StoredProcedure;   <span class="comment">// 执行过程为存储过程</span></span><br><span class="line">sqlcmd.CommandText = <span class="string">&quot;proc_AddData&quot;</span>; <span class="comment">//假设已经在数据库中创建了该过程</span></span><br><span class="line"><span class="comment">//存储过程的参数</span></span><br><span class="line">sqlcmd.Parameters.Add(<span class="string">&quot;@id&quot;</span>, SqlDbType.Int).Value = Convert.ToInt64(textBox1.Text); </span><br><span class="line">sqlcmd.Parameters.Add(<span class="string">&quot;@name&quot;</span>, SqlDbType.NVarChar, <span class="number">50</span>).Value = textBox2.Text;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(sqlconn.State == ConnectionState.Closed)</span><br><span class="line">    sqlconn.Open();</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> k = sqlcmd.ExecuteNonQuery();</span><br><span class="line"><span class="keyword">if</span> (k &gt; <span class="number">0</span>)</span><br><span class="line">    label1.Text = <span class="string">&quot;OK&quot;</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    label1.Text = <span class="string">&quot;NG&quot;</span>;</span><br><span class="line">sqlconn.Close();</span><br></pre></td></tr></table></figure>
<p>存储过程较直接使用 SQL 语句快，且能保证数据的安全，推荐使用。</p>
</li>
<li><p>DataReader 对象：通过 Command 对象从数据库检索信息，只读、向前、快速的访问</p>
<p>读取数据时，<strong>必须保持与数据库的链接，故也称为连线模式</strong></p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">SqlConnection sqlConnection = <span class="keyword">new</span> SqlConnection(<span class="string">&quot;server = LAPTOP-K9IFEVSM; DataBase = db; uid = sa; pwd = 123&quot;</span>);</span><br><span class="line">SqlCommand sqlcmd = <span class="keyword">new</span> SqlCommand(<span class="string">&quot;select * from tb1 order by id desc&quot;</span>, sqlConnection);</span><br><span class="line">sqlConnection.Open();</span><br><span class="line">SqlDataReader reader = sqlcmd.ExecuteReader();</span><br><span class="line"><span class="keyword">if</span>(reader.HasRows)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">while</span> (reader.Read())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//DataReader 对象的列索引获取读取到的值</span></span><br><span class="line">        richTextBox1.Text += reader[<span class="string">&quot;id&quot;</span>] + <span class="string">&quot; &quot;</span> + reader[<span class="string">&quot;name&quot;</span>] + <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">reader.Close(); <span class="comment">//使用后关闭</span></span><br><span class="line">sqlConnection.Close();</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>DataAdapter 对象：链接数据集 DataSet 对象的桥梁，专门为 DataSet 对象服务（会自动打开数据库连接和关系）</p>
<ul>
<li><p>通过 Command 对象执行 SQL 语句，从而从数据源中检索数据，并将检索到的结果集填充到 DataSet 对象中（Fill 方法）</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> strCon = <span class="string">&quot;server = LAPTOP-K9IFEVSM; DataBase = db; uid = sa; pwd = 123&quot;</span>;</span><br><span class="line">SqlConnection sqlCon = <span class="keyword">new</span> SqlConnection(strCon);</span><br><span class="line"><span class="built_in">string</span> strSql = <span class="string">&quot;select * from tb1 order by id asc&quot;</span>;</span><br><span class="line">SqlDataAdapter adapter = <span class="keyword">new</span> SqlDataAdapter(strSql, sqlCon);</span><br><span class="line">DataSet ds = <span class="keyword">new</span> DataSet();</span><br><span class="line">adapter.Fill(ds, <span class="string">&quot;tbtmp&quot;</span>);</span><br><span class="line">dataGridView1.DataSource = ds.Tables[<span class="string">&quot;tbtmp&quot;</span>];</span><br></pre></td></tr></table></figure>
</li>
<li><p>把用户对 DataSet 对象做出的更改写入到数据源中</p>
</li>
</ul>
</li>
<li><p>DataSet 对象：数据库容器，包括 Data Table 对象</p>
<ul>
<li><p>支持 ADO.NET <strong>断开式</strong>、分布式数据方案的核心对象，是实现非连接数据查询的核心组件</p>
</li>
<li><p>是创建在内存中的一个小型关系数据库</p>
</li>
<li>一个 DataSet 对象包含一组 DataTable 对象和 DataRelation 对象，其中DataTable对象由 DataColumn、DataRow、Constraint 集合对象组成</li>
</ul>
</li>
</ul>
<h3 id="数据访问命名空间"><a href="#数据访问命名空间" class="headerlink" title="数据访问命名空间"></a>数据访问命名空间</h3><ul>
<li>System.Data：提供对 ADO.NET 结构类的访问</li>
<li>System.Data.Common：包含各种 .NET 框架的共享类</li>
<li>System.Data.SqlClient：sql 服务器 .NET 框架数据提供程序，用于在托管空间中访问 SQL Server 数据库的类集合</li>
<li>System.Data.SqlTypes：提供 SQL Server 中本机数据类型的类</li>
</ul>
<h2 id="Entity-Framework"><a href="#Entity-Framework" class="headerlink" title="Entity Framework"></a>Entity Framework</h2><p>创建、增删改查</p>
<h1 id="文件及数据流技术"><a href="#文件及数据流技术" class="headerlink" title="文件及数据流技术"></a>文件及数据流技术</h1><ul>
<li>命名空间：<code>System.IO</code></li>
</ul>
<h2 id="文件基本操作"><a href="#文件基本操作" class="headerlink" title="文件基本操作"></a>文件基本操作</h2><h3 id="File-类"><a href="#File-类" class="headerlink" title="File 类"></a>File 类</h3><ul>
<li>支持对文件基本操作，包括提供用于创建、复制、删除、移动和打开文件的静态方法；并协助创建 FileStream 对象</li>
<li>若只执行一个操作， File 方法效率可能高于 FileInfo 实例方法</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2023/08/11/Q62x5VuitKZJeLW.png" alt="image-20230811171652330"></p>
<h3 id="FileInfo-类"><a href="#FileInfo-类" class="headerlink" title="FileInfo 类"></a>FileInfo 类</h3><ul>
<li>诸多方法和 File 类相同，但其没有静态方法，仅可用于实例化对象</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2023/08/11/EmblzwQ3M52P7ky.png" alt="image-20230811172002310"></p>
<h3 id="判断文件存在与否"><a href="#判断文件存在与否" class="headerlink" title="判断文件存在与否"></a>判断文件存在与否</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">Exists</span>(<span class="params"><span class="built_in">string</span> path</span>) <span class="comment">//File 类</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="built_in">bool</span> Exists</span> &#123;<span class="keyword">get</span>;&#125; <span class="comment">// FileInfo 类属性</span></span><br></pre></td></tr></table></figure>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">bool</span> isexists = File.Exists(<span class="string">@&quot;C:\config.ini&quot;</span>);</span><br><span class="line">Console.WriteLine(isexists);</span><br><span class="line"></span><br><span class="line">FileInfo fileInfo = <span class="keyword">new</span> FileInfo(<span class="string">@&quot;C:\config.ini&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (fileInfo.Exists)</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;OK&quot;</span>);</span><br></pre></td></tr></table></figure>
<h3 id="创建文件"><a href="#创建文件" class="headerlink" title="创建文件"></a>创建文件</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> FileStream <span class="title">Create</span>(<span class="params"><span class="built_in">string</span> path</span>) <span class="comment">//File 类</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> FileStream <span class="title">Create</span>()	<span class="comment">//FileInfo 类</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">File.Create(<span class="string">@&quot;G:\1.txt&quot;</span>);</span><br><span class="line">FileInfo fileInfo1 = <span class="keyword">new</span> FileInfo(<span class="string">@&quot;G:\2.txt&quot;</span>);</span><br><span class="line">fileInfo1.Create();</span><br></pre></td></tr></table></figure>
<h3 id="复制文件"><a href="#复制文件" class="headerlink" title="复制文件"></a>复制文件</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Copy</span>(<span class="params"><span class="built_in">string</span> sourceFileName, <span class="built_in">string</span> destFileName</span>)<span class="comment">//File类</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> FileInfo <span class="title">CopyTo</span>(<span class="params"><span class="built_in">string</span> DestFileName</span>) <span class="comment">//FileInfo 类</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">File.Copy(<span class="string">&quot;G:\\1.txt&quot;</span>, <span class="string">&quot;E:\\1.txt&quot;</span>);</span><br><span class="line">fileInfo1.CopyTo(<span class="string">&quot;E:\\1.txt&quot;</span>);</span><br></pre></td></tr></table></figure>
<h3 id="移动文件"><a href="#移动文件" class="headerlink" title="移动文件"></a>移动文件</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Move</span>(<span class="params"><span class="built_in">string</span> sourceFileName, <span class="built_in">string</span> destFileName</span>) <span class="comment">//File类</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">MoveTo</span>(<span class="params"><span class="built_in">string</span> destFileName</span>) <span class="comment">//FileInfo 类</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">File.Move(<span class="string">&quot;G:\\1.txt&quot;</span>, <span class="string">&quot;E:\\1.txt&quot;</span>);</span><br><span class="line">fileInfo1.MoveTo(<span class="string">&quot;E:\\2.txt&quot;</span>);</span><br></pre></td></tr></table></figure>
<h3 id="删除文件"><a href="#删除文件" class="headerlink" title="删除文件"></a>删除文件</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Delete</span>(<span class="params"><span class="built_in">string</span> path</span>) <span class="comment">//File类</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Delete</span>() <span class="comment">//FileInfo 类</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">File.Delete(<span class="string">&quot;E:\\1.txt&quot;</span>);</span><br><span class="line">fileInfo1.Delete();</span><br></pre></td></tr></table></figure>
<h3 id="获取文件信息"><a href="#获取文件信息" class="headerlink" title="获取文件信息"></a>获取文件信息</h3><ul>
<li>Name：获取文件名</li>
<li>FullName：获取文件完整目录，包括文件名</li>
<li>DirectoryName：获取文件完整路径</li>
<li>IsReadOnly：获取文件是否只读</li>
<li>CreationTime：获取文件创建时间</li>
<li>Length：获取文件大小</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">button1_Click</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(openFileDialog1.ShowDialog() == DialogResult.OK)</span><br><span class="line">    &#123;</span><br><span class="line">        textBox1.Text = openFileDialog1.FileName;</span><br><span class="line">        FileInfo fileInfo = <span class="keyword">new</span> FileInfo(textBox1.Text);</span><br><span class="line">        <span class="keyword">if</span>(fileInfo.Exists)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span> filename = fileInfo.Name;</span><br><span class="line">            <span class="built_in">string</span> filefullname = fileInfo.FullName;</span><br><span class="line">            <span class="built_in">string</span> filecreatetime = fileInfo.CreationTime.ToString();</span><br><span class="line">            <span class="built_in">long</span> filesize = fileInfo.Length;</span><br><span class="line">            <span class="built_in">string</span> isreadonly = fileInfo.IsReadOnly.ToString();</span><br><span class="line">            MessageBox.Show(<span class="string">$&quot;文件名：<span class="subst">&#123;filename&#125;</span> \n 路径：<span class="subst">&#123;filefullname&#125;</span> \n 创建时间：<span class="subst">&#123;filecreatetime&#125;</span> \n 文件大小：<span class="subst">&#123;filesize&#125;</span> \n 是否只读：<span class="subst">&#123;isreadonly&#125;</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="文件夹基本操作"><a href="#文件夹基本操作" class="headerlink" title="文件夹基本操作"></a>文件夹基本操作</h2><ul>
<li>Directory 类：静态类，文件夹的操作，复制、移动、重命名、创建、删除等，也可获取上述操作的 DateTime 信息</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2023/08/12/gZdpJTG28haCtKm.png" alt="image-20230812165915991"></p>
<ul>
<li>DirectoryInfo 类：实例化后使用，方法和 Directory 类类似，其常用属性如下：</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2023/08/12/cjf5ounQILHVq1E.png" alt="image-20230812170117945"></p>
<h3 id="判断文件夹是否存在"><a href="#判断文件夹是否存在" class="headerlink" title="判断文件夹是否存在"></a>判断文件夹是否存在</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">Exists</span>(<span class="params"><span class="built_in">string</span> path</span>)	<span class="comment">//Directory 类</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="built_in">bool</span> Exists</span>&#123;<span class="keyword">get</span>;&#125; <span class="comment">//DirectoryInfo 类</span></span><br></pre></td></tr></table></figure>
<h3 id="创建文件夹"><a href="#创建文件夹" class="headerlink" title="创建文件夹"></a>创建文件夹</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DirectoryInfo <span class="title">CreateDirectory</span>(<span class="params"><span class="built_in">string</span> path</span>) <span class="comment">//Directory 类</span></span></span><br><span class="line"><span class="function"><span class="comment">//DirectoryInfo 类</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Create</span>()</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Create</span>(<span class="params">DirectrySecurity directorySecurity</span>) <span class="comment">//文件夹访问权限</span></span></span><br></pre></td></tr></table></figure>
<h3 id="移动文件夹"><a href="#移动文件夹" class="headerlink" title="移动文件夹"></a>移动文件夹</h3><p>移动时根目录必须一致，如 C 盘移动到 C 盘，不能移动到 D！</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Move</span>(<span class="params"><span class="built_in">string</span> sourceDirName, <span class="built_in">string</span> destDirName</span>)<span class="comment">//Directory 类</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">MoveTo</span>(<span class="params"><span class="built_in">string</span> destDirName</span>) <span class="comment">//DirectoryInfo 类</span></span></span><br></pre></td></tr></table></figure>
<h3 id="删除文件夹"><a href="#删除文件夹" class="headerlink" title="删除文件夹"></a>删除文件夹</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Delete</span>(<span class="params"><span class="built_in">string</span> path</span>)<span class="comment">//Directory 类</span></span></span><br><span class="line"><span class="function"><span class="comment">//DirectoryInfo 类</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Delete</span>()</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Delete</span>(<span class="params"><span class="built_in">bool</span> recurisive</span>) <span class="comment">//是否删除子文件夹</span></span></span><br></pre></td></tr></table></figure>
<h3 id="遍历文件夹"><a href="#遍历文件夹" class="headerlink" title="遍历文件夹"></a>遍历文件夹</h3><ul>
<li>使用 DirectoryInfo 类</li>
<li>GetDirectories：返回当前目录的子目录</li>
<li>GetFiles：返回当前目录的文件列表</li>
<li>GetFileSystemInfos：检索表示当前目录的文件和子目录的强类型 FileSystemInfo 对象的数组</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">listView1.Items.Clear();</span><br><span class="line"><span class="keyword">if</span> (folderBrowserDialog1.ShowDialog() == DialogResult.OK) <span class="comment">//文件夹浏览</span></span><br><span class="line">&#123;</span><br><span class="line">    textBox1.Text = folderBrowserDialog1.SelectedPath;</span><br><span class="line">    DirectoryInfo info = <span class="keyword">new</span> DirectoryInfo(textBox1.Text);</span><br><span class="line">    FileSystemInfo[] fileSystemInfos = info.GetFileSystemInfos();<span class="comment">//返回数组</span></span><br><span class="line">    <span class="comment">//FileInfo[] systemInfos = info.GetFiles();</span></span><br><span class="line">    <span class="comment">//DirectoryInfo[] dirs = info.GetDirectories();</span></span><br><span class="line">    <span class="keyword">foreach</span> (FileSystemInfo fsi <span class="keyword">in</span> fileSystemInfos)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (fsi <span class="keyword">is</span> DirectoryInfo)<span class="comment">//是否是文件夹</span></span><br><span class="line">        &#123;</span><br><span class="line">            DirectoryInfo dfo = <span class="keyword">new</span> DirectoryInfo(fsi.FullName);</span><br><span class="line">            listView1.Items.Add(dfo.Name);</span><br><span class="line">            listView1.Items[listView1.Items.Count - <span class="number">1</span>].SubItems.Add(dfo.FullName);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            FileInfo fileInfo = <span class="keyword">new</span> FileInfo(fsi.FullName);</span><br><span class="line">            listView1.Items.Add(fileInfo.Name);</span><br><span class="line">            listView1.Items[listView1.Items.Count - <span class="number">1</span>].SubItems.Add(fileInfo.FullName);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="文件流"><a href="#文件流" class="headerlink" title="文件流"></a>文件流</h2><h3 id="FileStream-类"><a href="#FileStream-类" class="headerlink" title="FileStream 类"></a>FileStream 类</h3><p>FileStream 类，常用属性及方法如下：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2023/08/12/SMXd85jbPxVGKfC.png" alt="image-20230812211116419"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2023/08/12/51Im8ciYVE4xq7k.png" alt="image-20230812211153445"></p>
<h3 id="文本文件读写"><a href="#文本文件读写" class="headerlink" title="文本文件读写"></a>文本文件读写</h3><p>StreamWriter类和StreamReader类</p>
<h1 id="网络编程技术"><a href="#网络编程技术" class="headerlink" title="网络编程技术"></a>网络编程技术</h1><h2 id="网络协议"><a href="#网络协议" class="headerlink" title="网络协议"></a>网络协议</h2><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">TCP</th>
<th>UDP</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">反馈数据是否送达，可靠</td>
<td>无任何反馈，不可靠</td>
</tr>
<tr>
<td style="text-align:left">需创建连接请求，连接成功后发数据，效率低</td>
<td>不创建连接请求，直接发数据，效率高</td>
</tr>
</tbody>
</table>
</div>
<h2 id="端口"><a href="#端口" class="headerlink" title="端口"></a>端口</h2><ul>
<li><p>port：类似办事大厅不同的窗口，实现分流</p>
</li>
<li><p>计算机端口的取值范围在 0~65535 之间，但一般写程序时取在 1024 以上，以下的留给较知名的网络服务和应用</p>
</li>
</ul>
<h2 id="IP-地址封装"><a href="#IP-地址封装" class="headerlink" title="IP 地址封装"></a>IP 地址封装</h2><ul>
<li>IP地址格式（IPv4）：192.168.0.1（0.0.0.0~255.255.255.255）</li>
<li>本地回送地址：127.0.0.1（不进行网络传输，返回计算机本地）</li>
<li>命名空间：System.Net</li>
</ul>
<h3 id="Dns-类"><a href="#Dns-类" class="headerlink" title="Dns 类"></a>Dns 类</h3><p>类 <a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/dotnet/api/system.net.dns?view=net-7.0">Dns</a> 是一个静态类，提供简单的域名解析功能</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">Dns</span></span><br></pre></td></tr></table></figure>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> hostName = Dns.GetHostName();</span><br><span class="line">Console.WriteLine(hostName);</span><br><span class="line">IPHostEntry iPHostEntry =  Dns.GetHostEntry(hostName);</span><br><span class="line"><span class="built_in">string</span> hostname =  iPHostEntry.HostName;</span><br><span class="line">Console.WriteLine(hostname);</span><br><span class="line">IPAddress[] iPAddresses =  iPHostEntry.AddressList;</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> iPAddresses)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(item);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="IPAddress-类"><a href="#IPAddress-类" class="headerlink" title="IPAddress  类"></a>IPAddress  类</h3><p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/dotnet/api/system.net.ipaddress?view=net-7.0">IPAddress</a>类包含 IP 网络上的计算机的地址，提供 Internet 协议 (IP) 地址。</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">IPAddress</span></span><br></pre></td></tr></table></figure>
<h3 id="IPHostEntry-类"><a href="#IPHostEntry-类" class="headerlink" title="IPHostEntry 类"></a>IPHostEntry 类</h3><p>类 <a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/dotnet/api/system.net.iphostentry?view=net-7.0">IPHostEntry</a> 将域名系统 (DNS) 主机名与别名数组和匹配的 IP 地址数组相关联，为 Internet 主机地址信息提供容器类。</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">IPHostEntry</span></span><br></pre></td></tr></table></figure>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">IPHostEntry iph = Dns.GetHostEntry(<span class="string">&quot;baidu.com&quot;</span>);</span><br><span class="line">Console.WriteLine(iph.AddressList.ElementAt(<span class="number">0</span>));</span><br></pre></td></tr></table></figure>
<h2 id="套接字"><a href="#套接字" class="headerlink" title="套接字"></a>套接字</h2><ul>
<li>socket：提供给程序可以对外进行连接的接口，类似一个插座，程序调用其方法实现联网</li>
<li>命名空间：System.Net.Sockets</li>
</ul>
<h3 id="Sockets-类"><a href="#Sockets-类" class="headerlink" title="Sockets 类"></a>Sockets 类</h3><p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/dotnet/api/system.net.sockets.socket?view=net-7.0">Socket</a> 类用于管理连接，实现 Berkeley 通信端套接字接口。提供了一组丰富的方法和属性。</p>
<h3 id="TcpClient-类"><a href="#TcpClient-类" class="headerlink" title="TcpClient 类"></a>TcpClient 类</h3><p>通过网络来连接、发送、接收流数据</p>
<h3 id="TcpListener-类"><a href="#TcpListener-类" class="headerlink" title="TcpListener 类"></a>TcpListener 类</h3><p>监听和接收传入的连接请求</p>
<h3 id="UdpClient-类"><a href="#UdpClient-类" class="headerlink" title="UdpClient 类"></a>UdpClient 类</h3><p>发送和接收无连接 UDP 数据报</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://hbroad.github.io">MQRoad</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://hbroad.github.io/CSharp_learning/">https://hbroad.github.io/CSharp_learning/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://hbroad.github.io" target="_blank">南阳向北</a>！</span></div></div><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__category-list"><a class="post-meta__box__categoryes" href="/categories/C/"><span class="categoryes-punctuation"> <svg class="icon iconfont icon-biaoqian" title="C#" aria-hidden="true"><use xlink:href="#icon-fenlei"></use></svg></span>C#<span class="categoryesPageCount">1</span></a></div><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/C/"><span class="tags-punctuation"> <svg class="icon iconfont icon-biaoqian" title="C#" aria-hidden="true"><use xlink:href="#icon-biaoqian1"></use></svg></span>C#<span class="tagsPageCount">1</span></a></div></div><div class="post_share"><div class="social-share" data-image="https://s2.loli.net/2023/08/19/Zw3vehYDGNbq81O.png" data-sites="wechat,weibo,qq,facebook,twitter"></div><link rel="stylesheet" href="https://npm.elemecdn.com/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://npm.elemecdn.com/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/halcon_mv/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2023/05/13/Di9p5SVFybnfNol.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">机器视觉—Halcon</div></div></a></div><div class="next-post pull-right"><a href="/sqlserver_learning/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2023/08/19/E24SaTKefCWJpRd.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">SQL Server 从入门到放弃</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a></div><div class="comment-tips" id="comment-tips"><span>你无需删除空行，直接评论以获取最佳展示效果</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div><div class="comment-barrage"></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="author-info-top"> <div class="card-info-avatar"><a class="avatar-img" href="/about"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2023/04/17/YGpk958xbD3jyol.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></a><div class="author-status-box"><div class="author-status"><g-emoji class="g-emoji" alias="writing_hand" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/270d.png">✍️</g-emoji><span>on Studying</span></div></div></div></div><div class="author-info__sayhi" id="author-info__sayhi"></div><h1 class="author-info__name">MQRoad</h1><div class="author-info__description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">打工人，在此记录过去、现在和未来！</div></div><div class="banner-button-group"><a class="banner-button" onclick="pjax.loadUrl(&quot;/about/&quot;)"><span class="banner-button-text">了解更多</span><i class="fas fa-circle-right"></i></a></div><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/hbroad" target="_blank" title="Github"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-gitHub"></use></svg></a><a class="social-icon faa-parent animated-hover" href="https://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=1746469211@qq.com" target="_blank" title="Email"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-youxiang"></use></svg></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/188520608" target="_blank" title="BiliBili"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-bilibili"></use></svg></a><a class="social-icon faa-parent animated-hover" href="tencent://Message/?Uin=1746469211&amp;amp;websiteName=local.edu.com:8888=&amp;amp;Menu=yes" target="_blank" title="QQ"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-QQ1"></use></svg></a></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://s2.loli.net/2023/05/26/3b9pyQu47GXi2t5.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(https://s2.loli.net/2022/08/23/LaJqogHM3WOiAD6.jpg) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.</span> <span class="toc-text">数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#C-%E4%BA%94%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.1.</span> <span class="toc-text">C# 五大数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%80%BC%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.1.1.</span> <span class="toc-text">值类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.1.2.</span> <span class="toc-text">引用类型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E7%A7%8D%E7%B1%BB"><span class="toc-number">1.2.</span> <span class="toc-text">参数种类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%98%E9%87%8F"><span class="toc-number">1.3.</span> <span class="toc-text">变量</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E9%87%8F"><span class="toc-number">1.4.</span> <span class="toc-text">常量</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A3%85%E7%AE%B1%E4%B8%8E%E6%8B%86%E7%AE%B1"><span class="toc-number">1.5.</span> <span class="toc-text">装箱与拆箱</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%8E%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">2.</span> <span class="toc-text">字符与字符串</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6"><span class="toc-number">2.1.</span> <span class="toc-text">字符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">2.2.</span> <span class="toc-text">字符串</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E4%B8%B2%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-number">2.2.1.</span> <span class="toc-text">字串初始化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E4%B8%B2%E6%8B%BC%E6%8E%A5"><span class="toc-number">2.2.2.</span> <span class="toc-text">字串拼接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E4%B8%B2%E6%AF%94%E8%BE%83"><span class="toc-number">2.2.3.</span> <span class="toc-text">字串比较</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E4%B8%B2"><span class="toc-number">2.2.4.</span> <span class="toc-text">格式化字串</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%88%AA%E5%8F%96%E5%AD%97%E4%B8%B2"><span class="toc-number">2.2.5.</span> <span class="toc-text">截取字串</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E5%89%B2%E5%AD%97%E4%B8%B2"><span class="toc-number">2.2.6.</span> <span class="toc-text">分割字串</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%92%E5%85%A5%E5%AD%97%E4%B8%B2"><span class="toc-number">2.2.7.</span> <span class="toc-text">插入字串</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E5%AD%97%E4%B8%B2"><span class="toc-number">2.2.8.</span> <span class="toc-text">删除字串</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%8D%E5%88%B6%E5%AD%97%E4%B8%B2"><span class="toc-number">2.2.9.</span> <span class="toc-text">复制字串</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%BF%E6%8D%A2%E5%AD%97%E7%AC%A6"><span class="toc-number">2.2.10.</span> <span class="toc-text">替换字符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%AF%E5%8F%98%E5%AD%97%E4%B8%B2%E7%B1%BB"><span class="toc-number">2.2.11.</span> <span class="toc-text">可变字串类</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">2.3.</span> <span class="toc-text">正则表达式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E7%AC%A6%E5%8F%B7"><span class="toc-number">2.3.1.</span> <span class="toc-text">常用符号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#C-%E4%B8%8E%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">2.3.2.</span> <span class="toc-text">C# 与正则表达式</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E7%BB%84"><span class="toc-number">3.</span> <span class="toc-text">数组</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E7%BB%B4%E6%95%B0%E7%BB%84"><span class="toc-number">3.1.</span> <span class="toc-text">一维数组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E7%BB%B4%E6%95%B0%E7%BB%84"><span class="toc-number">3.2.</span> <span class="toc-text">二维数组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ArrayList-%E7%B1%BB"><span class="toc-number">3.3.</span> <span class="toc-text">ArrayList 类</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%93%88%E5%B8%8C%E8%A1%A8"><span class="toc-number">4.</span> <span class="toc-text">哈希表</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E7%9A%84%E5%AE%9A%E4%B9%89%E3%80%81%E8%B0%83%E7%94%A8%E5%92%8C%E8%B0%83%E8%AF%95"><span class="toc-number">5.</span> <span class="toc-text">方法的定义、调用和调试</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B9%E6%B3%95"><span class="toc-number">5.1.</span> <span class="toc-text">方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E5%99%A8"><span class="toc-number">5.2.</span> <span class="toc-text">构造器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E7%9A%84%E9%87%8D%E8%BD%BD"><span class="toc-number">5.3.</span> <span class="toc-text">方法的重载</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E7%9A%84%E8%B0%83%E7%94%A8%E4%B8%8E%E6%A0%88"><span class="toc-number">5.4.</span> <span class="toc-text">方法的调用与栈</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="toc-number">6.</span> <span class="toc-text">操作符</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E7%AC%A6%E6%A6%82%E8%A7%88"><span class="toc-number">6.1.</span> <span class="toc-text">操作符概览</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E7%AC%A6%E7%9A%84%E6%9C%AC%E8%B4%A8"><span class="toc-number">6.2.</span> <span class="toc-text">操作符的本质</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E7%AC%A6%E7%9A%84%E4%BC%98%E5%85%88%E7%BA%A7"><span class="toc-number">6.3.</span> <span class="toc-text">操作符的优先级</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E7%AC%A6-1"><span class="toc-number">6.4.</span> <span class="toc-text">操作符</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="toc-number">6.4.1.</span> <span class="toc-text">基本操作符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E7%9B%AE%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="toc-number">6.4.2.</span> <span class="toc-text">单目操作符</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%A1%A8%E8%BE%BE%E5%BC%8F%E3%80%81%E8%AF%AD%E5%8F%A5"><span class="toc-number">7.</span> <span class="toc-text">表达式、语句</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AD%97%E6%AE%B5%E3%80%81%E5%B1%9E%E6%80%A7%E3%80%81%E7%B4%A2%E5%BC%95%E5%99%A8%E3%80%81%E5%B8%B8%E9%87%8F"><span class="toc-number">8.</span> <span class="toc-text">字段、属性、索引器、常量</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E6%AE%B5"><span class="toc-number">8.1.</span> <span class="toc-text">字段</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7"><span class="toc-number">8.2.</span> <span class="toc-text">属性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7%E7%9A%84%E7%94%B1%E6%9D%A5"><span class="toc-number">8.2.1.</span> <span class="toc-text">属性的由来</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7%E7%9A%84%E5%A3%B0%E6%98%8E"><span class="toc-number">8.2.2.</span> <span class="toc-text">属性的声明</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7%E7%9A%84%E5%AE%8C%E6%95%B4%E5%A3%B0%E6%98%8E"><span class="toc-number">8.2.2.1.</span> <span class="toc-text">属性的完整声明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7%E7%9A%84%E7%AE%80%E7%95%A5%E5%A3%B0%E6%98%8E"><span class="toc-number">8.2.2.2.</span> <span class="toc-text">属性的简略声明</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E5%99%A8-Indexer"><span class="toc-number">8.3.</span> <span class="toc-text">索引器 Indexer</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E9%87%8F-1"><span class="toc-number">8.4.</span> <span class="toc-text">常量</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%80%9C%E5%8F%AA%E8%AF%BB%E2%80%9D%E5%9C%BA%E6%99%AF"><span class="toc-number">8.5.</span> <span class="toc-text">“只读”场景</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%82%E6%95%B0"><span class="toc-number">9.</span> <span class="toc-text">参数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%A0%E5%80%BC%E5%8F%82%E6%95%B0"><span class="toc-number">9.1.</span> <span class="toc-text">传值参数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%95%E7%94%A8%E5%8F%82%E6%95%B0"><span class="toc-number">9.2.</span> <span class="toc-text">引用参数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BE%93%E5%87%BA%E5%8F%82%E6%95%B0"><span class="toc-number">9.3.</span> <span class="toc-text">输出参数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E7%BB%84%E5%8F%82%E6%95%B0"><span class="toc-number">9.4.</span> <span class="toc-text">数组参数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B7%E5%90%8D%E5%8F%82%E6%95%B0"><span class="toc-number">9.5.</span> <span class="toc-text">具名参数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%AF%E9%80%89%E5%8F%82%E6%95%B0"><span class="toc-number">9.6.</span> <span class="toc-text">可选参数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E6%96%B9%E6%B3%95%EF%BC%88this-%E5%8F%82%E6%95%B0%EF%BC%89"><span class="toc-number">9.7.</span> <span class="toc-text">扩展方法（this 参数）</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A7%94%E6%89%98"><span class="toc-number">10.</span> <span class="toc-text">委托</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A7%94%E6%89%98%E5%AE%9A%E4%B9%89"><span class="toc-number">10.1.</span> <span class="toc-text">委托定义</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A7%94%E6%89%98%E5%A3%B0%E6%98%8E"><span class="toc-number">10.2.</span> <span class="toc-text">委托声明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A7%94%E6%89%98%E4%BD%BF%E7%94%A8"><span class="toc-number">10.3.</span> <span class="toc-text">委托使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A7%94%E6%89%98%E9%AB%98%E7%BA%A7%E4%BD%BF%E7%94%A8"><span class="toc-number">10.4.</span> <span class="toc-text">委托高级使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E6%92%AD%E5%A7%94%E6%89%98"><span class="toc-number">10.4.1.</span> <span class="toc-text">多播委托</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9A%90%E5%BC%8F%E5%BC%82%E6%AD%A5%E8%B0%83%E7%94%A8"><span class="toc-number">10.4.2.</span> <span class="toc-text">隐式异步调用</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6"><span class="toc-number">11.</span> <span class="toc-text">事件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E6%A6%82%E5%BF%B5"><span class="toc-number">11.1.</span> <span class="toc-text">事件概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E6%A8%A1%E5%9E%8B"><span class="toc-number">11.2.</span> <span class="toc-text">事件模型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E5%99%A8%E6%8C%82%E6%8E%A5"><span class="toc-number">11.3.</span> <span class="toc-text">事件处理器挂接</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BA%8B%E4%BB%B6"><span class="toc-number">11.4.</span> <span class="toc-text">自定义事件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E6%9C%AC%E8%B4%A8"><span class="toc-number">11.5.</span> <span class="toc-text">事件本质</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%B1%BB"><span class="toc-number">12.</span> <span class="toc-text">类</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E7%B1%BB"><span class="toc-number">12.1.</span> <span class="toc-text">什么是类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E5%92%8C%E6%9E%90%E6%9E%84"><span class="toc-number">12.2.</span> <span class="toc-text">构造和析构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E7%9A%84%E5%A3%B0%E6%98%8E"><span class="toc-number">12.3.</span> <span class="toc-text">类的声明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E7%9A%84%E6%9D%83%E9%99%90"><span class="toc-number">12.4.</span> <span class="toc-text">类的权限</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E7%9A%84%E7%BB%A7%E6%89%BF"><span class="toc-number">12.5.</span> <span class="toc-text">类的继承</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%87%8D%E5%86%99%E3%80%81%E9%9A%90%E8%97%8F%E3%80%81%E5%A4%9A%E6%80%81"><span class="toc-number">12.6.</span> <span class="toc-text">重写、隐藏、多态</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8A%BD%E8%B1%A1%E7%B1%BB"><span class="toc-number">12.7.</span> <span class="toc-text">抽象类</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3"><span class="toc-number">13.</span> <span class="toc-text">接口</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9D%E8%AF%86%E6%8E%A5%E5%8F%A3"><span class="toc-number">13.1.</span> <span class="toc-text">初识接口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3%E6%9C%AC%E8%B4%A8"><span class="toc-number">13.2.</span> <span class="toc-text">接口本质</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BE%9D%E8%B5%96%E5%92%8C%E8%80%A6%E5%90%88"><span class="toc-number">13.3.</span> <span class="toc-text">依赖和耦合</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99"><span class="toc-number">14.</span> <span class="toc-text">设计原则</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84"><span class="toc-number">15.</span> <span class="toc-text">反射</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B3%9B%E5%9E%8B"><span class="toc-number">16.</span> <span class="toc-text">泛型</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9D%E8%AF%86%E6%B3%9B%E5%9E%8B"><span class="toc-number">16.1.</span> <span class="toc-text">初识泛型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%9B%E5%9E%8B%E5%AE%9E%E4%BE%8B"><span class="toc-number">16.2.</span> <span class="toc-text">泛型实例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B%E5%8F%82%E6%95%B0"><span class="toc-number">16.3.</span> <span class="toc-text">类型参数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%9B%E5%9E%8B%E5%A7%94%E6%89%98"><span class="toc-number">16.4.</span> <span class="toc-text">泛型委托</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#partial-%E7%B1%BB"><span class="toc-number">17.</span> <span class="toc-text">partial 类</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9E%9A%E4%B8%BE"><span class="toc-number">18.</span> <span class="toc-text">枚举</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93"><span class="toc-number">19.</span> <span class="toc-text">结构体</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Lambda-%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">20.</span> <span class="toc-text">Lambda 表达式</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#LINQ%E6%95%B0%E6%8D%AE%E8%AE%BF%E9%97%AE"><span class="toc-number">21.</span> <span class="toc-text">LINQ数据访问</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Windows-%E7%AA%97%E4%BD%93"><span class="toc-number">22.</span> <span class="toc-text">Windows 窗体</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AA%97%E5%8F%B0%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">22.1.</span> <span class="toc-text">窗台常用方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AA%97%E4%BD%93%E5%B8%B8%E7%94%A8%E4%BA%8B%E4%BB%B6"><span class="toc-number">22.2.</span> <span class="toc-text">窗体常用事件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MDI-%E7%AA%97%E4%BD%93"><span class="toc-number">22.3.</span> <span class="toc-text">ＭDI 窗体</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%A7%E6%89%BF%E7%AA%97%E4%BD%93"><span class="toc-number">22.4.</span> <span class="toc-text">继承窗体</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A7%E4%BB%B6"><span class="toc-number">22.5.</span> <span class="toc-text">控件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A7%E4%BB%B6%E6%A6%82%E8%BF%B0"><span class="toc-number">22.5.1.</span> <span class="toc-text">控件概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E6%8E%A7%E4%BB%B6"><span class="toc-number">22.5.2.</span> <span class="toc-text">常用控件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AB%98%E7%BA%A7%E6%8E%A7%E4%BB%B6"><span class="toc-number">22.5.3.</span> <span class="toc-text">高级控件</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BF%E9%97%AE"><span class="toc-number">23.</span> <span class="toc-text">数据库访问</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL"><span class="toc-number">23.1.</span> <span class="toc-text">SQL</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-%E8%AF%AD%E8%A8%80"><span class="toc-number">23.1.1.</span> <span class="toc-text">SQL  语言</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-%E8%AF%AD%E6%B3%95"><span class="toc-number">23.1.2.</span> <span class="toc-text">SQL 语法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ADO-NET-%E5%AF%B9%E8%B1%A1%E6%A8%A1%E5%9E%8B"><span class="toc-number">23.2.</span> <span class="toc-text">ADO.NET 对象模型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E8%B1%A1%E6%A8%A1%E5%9E%8B"><span class="toc-number">23.2.1.</span> <span class="toc-text">对象模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E8%AE%BF%E9%97%AE%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4"><span class="toc-number">23.2.2.</span> <span class="toc-text">数据访问命名空间</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Entity-Framework"><span class="toc-number">23.3.</span> <span class="toc-text">Entity Framework</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%8F%8A%E6%95%B0%E6%8D%AE%E6%B5%81%E6%8A%80%E6%9C%AF"><span class="toc-number">24.</span> <span class="toc-text">文件及数据流技术</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="toc-number">24.1.</span> <span class="toc-text">文件基本操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#File-%E7%B1%BB"><span class="toc-number">24.1.1.</span> <span class="toc-text">File 类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FileInfo-%E7%B1%BB"><span class="toc-number">24.1.2.</span> <span class="toc-text">FileInfo 类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E4%B8%8E%E5%90%A6"><span class="toc-number">24.1.3.</span> <span class="toc-text">判断文件存在与否</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%96%87%E4%BB%B6"><span class="toc-number">24.1.4.</span> <span class="toc-text">创建文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%8D%E5%88%B6%E6%96%87%E4%BB%B6"><span class="toc-number">24.1.5.</span> <span class="toc-text">复制文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A7%BB%E5%8A%A8%E6%96%87%E4%BB%B6"><span class="toc-number">24.1.6.</span> <span class="toc-text">移动文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6"><span class="toc-number">24.1.7.</span> <span class="toc-text">删除文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%96%87%E4%BB%B6%E4%BF%A1%E6%81%AF"><span class="toc-number">24.1.8.</span> <span class="toc-text">获取文件信息</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%A4%B9%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="toc-number">24.2.</span> <span class="toc-text">文件夹基本操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E6%96%87%E4%BB%B6%E5%A4%B9%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8"><span class="toc-number">24.2.1.</span> <span class="toc-text">判断文件夹是否存在</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9"><span class="toc-number">24.2.2.</span> <span class="toc-text">创建文件夹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A7%BB%E5%8A%A8%E6%96%87%E4%BB%B6%E5%A4%B9"><span class="toc-number">24.2.3.</span> <span class="toc-text">移动文件夹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6%E5%A4%B9"><span class="toc-number">24.2.4.</span> <span class="toc-text">删除文件夹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%81%8D%E5%8E%86%E6%96%87%E4%BB%B6%E5%A4%B9"><span class="toc-number">24.2.5.</span> <span class="toc-text">遍历文件夹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E6%B5%81"><span class="toc-number">24.3.</span> <span class="toc-text">文件流</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#FileStream-%E7%B1%BB"><span class="toc-number">24.3.1.</span> <span class="toc-text">FileStream 类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E6%9C%AC%E6%96%87%E4%BB%B6%E8%AF%BB%E5%86%99"><span class="toc-number">24.3.2.</span> <span class="toc-text">文本文件读写</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF"><span class="toc-number">25.</span> <span class="toc-text">网络编程技术</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE"><span class="toc-number">25.1.</span> <span class="toc-text">网络协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AB%AF%E5%8F%A3"><span class="toc-number">25.2.</span> <span class="toc-text">端口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IP-%E5%9C%B0%E5%9D%80%E5%B0%81%E8%A3%85"><span class="toc-number">25.3.</span> <span class="toc-text">IP 地址封装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Dns-%E7%B1%BB"><span class="toc-number">25.3.1.</span> <span class="toc-text">Dns 类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IPAddress-%E7%B1%BB"><span class="toc-number">25.3.2.</span> <span class="toc-text">IPAddress  类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IPHostEntry-%E7%B1%BB"><span class="toc-number">25.3.3.</span> <span class="toc-text">IPHostEntry 类</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A5%97%E6%8E%A5%E5%AD%97"><span class="toc-number">25.4.</span> <span class="toc-text">套接字</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Sockets-%E7%B1%BB"><span class="toc-number">25.4.1.</span> <span class="toc-text">Sockets 类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TcpClient-%E7%B1%BB"><span class="toc-number">25.4.2.</span> <span class="toc-text">TcpClient 类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TcpListener-%E7%B1%BB"><span class="toc-number">25.4.3.</span> <span class="toc-text">TcpListener 类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UdpClient-%E7%B1%BB"><span class="toc-number">25.4.4.</span> <span class="toc-text">UdpClient 类</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/sqlserver_learning/" title="SQL Server 从入门到放弃"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2023/08/19/E24SaTKefCWJpRd.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SQL Server 从入门到放弃"/></a><div class="content"><a class="title" href="/sqlserver_learning/" title="SQL Server 从入门到放弃">SQL Server 从入门到放弃</a><time datetime="2023-08-09T11:39:02.000Z" title="发表于 2023-08-09 19:39:02">2023-08-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/CSharp_learning/" title="C# 从入门到放弃"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2023/08/19/Zw3vehYDGNbq81O.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="C# 从入门到放弃"/></a><div class="content"><a class="title" href="/CSharp_learning/" title="C# 从入门到放弃">C# 从入门到放弃</a><time datetime="2023-07-23T03:18:30.000Z" title="发表于 2023-07-23 11:18:30">2023-07-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/halcon_mv/" title="机器视觉—Halcon"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2023/05/13/Di9p5SVFybnfNol.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="机器视觉—Halcon"/></a><div class="content"><a class="title" href="/halcon_mv/" title="机器视觉—Halcon">机器视觉—Halcon</a><time datetime="2023-05-15T13:03:05.000Z" title="发表于 2023-05-15 21:03:05">2023-05-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/halcon_learning/" title="Halcon从入门到入土"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2023/05/13/Di9p5SVFybnfNol.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Halcon从入门到入土"/></a><div class="content"><a class="title" href="/halcon_learning/" title="Halcon从入门到入土">Halcon从入门到入土</a><time datetime="2023-05-13T12:42:38.000Z" title="发表于 2023-05-13 20:42:38">2023-05-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/chatgptlike/" title="ChatGPT 类产品"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2023/04/28/kopIxRQtBaFM1Oe.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ChatGPT 类产品"/></a><div class="content"><a class="title" href="/chatgptlike/" title="ChatGPT 类产品">ChatGPT 类产品</a><time datetime="2023-04-28T01:53:21.000Z" title="发表于 2023-04-28 09:53:21">2023-04-28</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 MQRoad</div><div id="workboard"><div id="runtimeTextTip"></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2023/04/17/YGpk958xbD3jyol.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">24</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">21</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">10</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child" style="left:-79px;"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="fa-fw fas fa-archive faa-tada"></i><span> 全部</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="fa-fw fas fa-shapes faa-tada"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="fa-fw fas fa-tags faa-tada"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/link/"><span> 友链</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/categories/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD"><span> AI资讯</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child" style="left:-79px;"><li><a class="site-page child faa-parent animated-hover" href="/about/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-zhifeiji"></use></svg><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="fa-fw fas fas fa-lightbulb faa-tada"></i><span> 发个说说</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/timeline/"><i class="fa-fw fa-fw fas fa-shoe-prints faa-tada faa-tada"></i><span> 建站小记</span></a></li></ul></div></div></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><a id="switch_commentBarrage" href="javascript:anzhiyu.switchCommentBarrage();" title="开关弹幕"><svg class="icon" aria-hidden="true"><use href="#icon-danmu"></use></svg></a><button id="center-console" type="button" title="中控台"><i class="fas fa-fish-fins"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="console"><div class="close-btn" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"><i class="fas fa-circle-xmark"></i></div><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://s2.loli.net/2022/08/02/NU5AfdCaoirtyK1.jpg" target="_blank"><img class="post-qr-code-img" alt="wechat" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2022/08/02/NU5AfdCaoirtyK1.jpg"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="https://img01.anzhiy.cn/useruploads/0/2023/04/06/642ec98c8227c.png" target="_blank"><img class="post-qr-code-img" alt="alipay" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img01.anzhiy.cn/useruploads/0/2023/04/06/642ec98c8227c.png"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments" onclick="anzhiyu.hideConsole()"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> <span>最新评论</span></span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags" onclick="anzhiyu.hideConsole()"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/C/" style="font-size: 1.15em; color: rgb(131, 78, 181)">C#<sup>1</sup></a><a href="/tags/C/" style="font-size: 1.35em; color: rgb(126, 127, 51)">C++<sup>3</sup></a><a href="/tags/Commemorate/" style="font-size: 1.15em; color: rgb(33, 45, 69)">Commemorate<sup>1</sup></a><a href="/tags/Coppeliasim-Vrep/" style="font-size: 1.15em; color: rgb(181, 56, 50)">Coppeliasim/Vrep<sup>1</sup></a><a href="/tags/DIP/" style="font-size: 1.15em; color: rgb(20, 135, 166)">DIP<sup>1</sup></a><a href="/tags/HEC/" style="font-size: 1.15em; color: rgb(81, 98, 44)">HEC<sup>1</sup></a><a href="/tags/Halcon/" style="font-size: 1.25em; color: rgb(81, 189, 12)">Halcon<sup>2</sup></a><a href="/tags/Hexo/" style="font-size: 1.15em; color: rgb(62, 58, 183)">Hexo<sup>1</sup></a><a href="/tags/Interview/" style="font-size: 1.45em; color: rgb(42, 86, 105)">Interview<sup>8</sup></a><a href="/tags/Leetcode/" style="font-size: 1.35em; color: rgb(175, 182, 149)">Leetcode<sup>3</sup></a><a href="/tags/PCL/" style="font-size: 1.15em; color: rgb(52, 73, 35)">PCL<sup>1</sup></a><a href="/tags/Point-Cloud/" style="font-size: 1.15em; color: rgb(154, 137, 102)">Point Cloud<sup>1</sup></a><a href="/tags/Python/" style="font-size: 1.15em; color: rgb(86, 67, 198)">Python<sup>1</sup></a><a href="/tags/SQL-Server/" style="font-size: 1.15em; color: rgb(186, 197, 44)">SQL Server<sup>1</sup></a><a href="/tags/Simulation/" style="font-size: 1.15em; color: rgb(79, 108, 26)">Simulation<sup>1</sup></a><a href="/tags/UR5/" style="font-size: 1.25em; color: rgb(130, 163, 168)">UR5<sup>2</sup></a><a href="/tags/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/" style="font-size: 1.15em; color: rgb(72, 50, 158)">人工智能<sup>1</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 1.15em; color: rgb(41, 79, 118)">数据结构<sup>1</sup></a><a href="/tags/%E6%AF%95%E8%AE%BE/" style="font-size: 1.25em; color: rgb(89, 191, 189)">毕设<sup>2</sup></a><a href="/tags/%E7%82%B9%E4%BA%91/" style="font-size: 1.15em; color: rgb(114, 34, 122)">点云<sup>1</sup></a><a href="/tags/%E8%B5%84%E8%AE%AF/" style="font-size: 1.15em; color: rgb(5, 87, 190)">资讯<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history" onclick="anzhiyu.hideConsole()"><div class="item-headline"><i class="fas fa-archive"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/08/"><span class="card-archive-list-date">八月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/07/"><span class="card-archive-list-date">七月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/05/"><span class="card-archive-list-date">五月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/04/"><span class="card-archive-list-date">四月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/03/"><span class="card-archive-list-date">三月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/11/"><span class="card-archive-list-date">十一月 2022</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/09/"><span class="card-archive-list-date">九月 2022</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/08/"><span class="card-archive-list-date">八月 2022</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">5</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" onclick="rm.switchDarkMode()" title="显示模式切换" href="javascript:void(0);"><i class="fas fa-moon" style="font-size: 1rem;"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="fas fa-arrows-alt-h"></i></a></div><div class="console-btn-item on" id="consoleCommentBarrage" onclick="anzhiyu.switchCommentBarrage()" title="热评开关"><a class="commentBarrage"><i class="fa-solid fa-message"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="fas fa-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="fa-solid fa-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="fa-solid fa-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="fa-solid fa-arrow-rotate-right"></i></div><div class="rightMenu-item" id="menu-top"><i class="fa-solid fa-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="fas fa-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="fas fa-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="fas fa-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="fas fa-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="fas fa-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="fas fa-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="fas fa-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="fas fa-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="fa-solid fa-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="fa-solid fa-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="fa-solid fa-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="fas fa-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="fas fa-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="fas fa-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="fas fa-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="fas fa-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="fas fa-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="fas fa-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="fas fa-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="fa-solid fa-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="fa-solid fa-moon"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="fas fa-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div id="he-plugin-simple"></div><script>var WIDGET = {
  "CONFIG": {
    "modules": "0124",
    "background": "2",
    "tmpColor": "FFFFFF",
    "tmpSize": "16",
    "cityColor": "FFFFFF",
    "citySize": "16",
    "aqiColor": "E8D87B",
    "aqiSize": "16",
    "weatherIconSize": "24",
    "alertIconSize": "18",
    "padding": "10px 10px 10px 10px",
    "shadow": "0",
    "language": "auto",
    "borderRadius": "20",
    "fixed": "true",
    "vertical": "top",
    "horizontal": "left",
    "left": "20",
    "top": "7.1",
    "key": "df245676fb434a0691ead1c63341cd94"
  }
}
</script><link rel="stylesheet" href="https://widget.qweather.net/simple/static/css/he-simple.css?v=1.4.0"/><script src="https://widget.qweather.net/simple/static/js/he-simple.js?v=1.4.0"></script><div><script src="https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js"></script><script src="https://npm.elemecdn.com/hexo-theme-anzhiyu@1.0.8/source/js/utils.js"></script><script src="https://npm.elemecdn.com/hexo-theme-anzhiyu@1.0.8/source/js/main.js"></script><script src="https://npm.elemecdn.com/hexo-theme-anzhiyu@1.0.8/source/js/tw_cn.js"></script><script src="https://npm.elemecdn.com/@fancyapps/ui@4.0.31/dist/fancybox.umd.js"></script><script src="https://npm.elemecdn.com/instant.page@5.1.1/instantpage.js" type="module"></script><script src="https://npm.elemecdn.com/vanilla-lazyload@17.3.1/dist/lazyload.iife.min.js"></script><script src="https://npm.elemecdn.com/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  console.log(1)
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("04/01/2020 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    //- `
        
    //-    █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
    //-   ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
    //-   ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
    //-   ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
    //-   ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
    //-   ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
    //-     `,
    "已上线",
    dnum,
    "天",
    "©2020 By 安知鱼",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#3b70fc",
      "",
      "color:#3b70fc",
      "color:#3b70fc",
      "",
      "color:#3b70fc",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 MQRoad 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script async="async">(function () {
  var grt = new Date("04/01/2020 00:00:00"); //设置网站上线时间
  var now = new Date();
  var dnum;
  var hnum;
  var mnum;
  var snum;

  // 计算并更新天数、小时数、分钟数和秒数
  function updateTime() {
    now = new Date(); // 更新 now 的值
    var days = (now - grt) / 1000 / 60 / 60 / 24;
    dnum = Math.floor(days);
    var hours = (now - grt) / 1000 / 60 / 60 - 24 * dnum;
    hnum = Math.floor(hours);
    if (String(hnum).length == 1) {
      hnum = "0" + hnum;
    }
    var minutes = (now - grt) / 1000 / 60 - 24 * 60 * dnum - 60 * hnum;
    mnum = Math.floor(minutes);
    if (String(mnum).length == 1) {
      mnum = "0" + mnum;
    }
    var seconds = (now - grt) / 1000 - 24 * 60 * 60 * dnum - 60 * 60 * hnum - 60 * mnum;
    snum = Math.round(seconds);
    if (String(snum).length == 1) {
      snum = "0" + snum;
    }
  }

  // 更新网页中显示的网站运行时间
  function updateHtml() {
    let currentTimeHtml = "";
    if (hnum < 18 && hnum >= 9) {
      // 如果是上班时间，默认就是"安知鱼-上班摸鱼中.svg"图片，不需要更改
      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='fas fa-heartbeat' style='color:red'></i>`;
    } else {
      // 如果是下班时间，插入"安知鱼-下班啦.svg"图片
      let img = document.querySelector("#workboard .workSituationImg");
      img.src = "";
      img.title = "";
      img.alt = "";

      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='fas fa-heartbeat' style='color:red'></i>`;
    }

    if (document.getElementById("runtimeTextTip")) {
      document.getElementById("runtimeTextTip").innerHTML = currentTimeHtml;
    }
  }

  setInterval(() => {
    updateTime();
    updateHtml();
  }, 1000);
})();</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.0
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://npm.elemecdn.com/mathjax@3.2.2/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://mqroad.zeabur.app',
      region: '',
      onCommentLoaded: function () {
        anzhiyu.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://mqroad.zeabur.app',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://npm.elemecdn.com/twikoo@1.6.11/dist/twikoo.all.min.js').then(runFn)
  }
  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) anzhiyu.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: 'https://mqroad.zeabur.app',
        region: '',
        pageSize: 6,
        includeReply: true
      }).then(function (res) {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        saveToLocal.set('twikoo-newest-comments', JSON.stringify(twikooArray), 10/(60*24))
        generateHtml(twikooArray)
      }).catch(function (err) {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.innerHTML= "无法获取评论，请确认相关配置是否正确"
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      getScript('https://npm.elemecdn.com/twikoo@1.6.11/dist/twikoo.all.min.js').then(runTwikoo)
    }
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'><div class='name'><span>${array[i].nick}</span></div></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom.innerHTML= result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('twikoo-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/bubble/bubble.js"></script><script>var visitorMail = "visitor@anzhiy.cn";</script><script data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/catalog-bar/catalog-bar.js"></script><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/categoryBar/categoryBar.js"></script><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script async="async">// 初始化函数
let rm = {};

//禁止图片拖拽
let imgElements = document.getElementsByTagName("img");
for (let i = 0; i < imgElements.length; i++) {
  imgElements[i].addEventListener("dragstart", function (event) {
    event.preventDefault();
  });
}

// 显示菜单
rm.showRightMenu = function (isTrue, x = 0, y = 0) {
  let rightMenu = document.getElementById("rightMenu");
  rightMenu.style.top = x + "px";
  rightMenu.style.left = y + "px";
  if (isTrue) {
    rightMenu.style.display = "block";
    stopMaskScroll();
  } else {
    rightMenu.style.display = "none";
  }
};

// 隐藏菜单
rm.hideRightMenu = function () {
  rm.showRightMenu(false);
  let rightMenuMask = document.querySelector("#rightmenu-mask");
  rightMenuMask.style.display = "none";
};

// 尺寸
let rmWidth = $("#rightMenu").width();
let rmHeight = $("#rightMenu").height();

// 重新定义尺寸
rm.reloadrmSize = function () {
  rmWidth = $("#rightMenu").width();
  rmHeight = $("#rightMenu").height();
};

// 获取点击的href
let domhref = "";
let domImgSrc = "";
let globalEvent = null;

// 监听右键初始化
window.oncontextmenu = function (event) {
  if (document.body.clientWidth > 768) {
    let pageX = event.clientX + 10; //加10是为了防止显示时鼠标遮在菜单上
    let pageY = event.clientY;

    //其他额外菜单
    let $rightMenuOther = $(".rightMenuOther");
    let $rightMenuPlugin = $(".rightMenuPlugin");
    let $rightMenuCopyText = $("#menu-copytext");
    let $rightMenuPasteText = $("#menu-pastetext");
    let $rightMenuCommentText = $("#menu-commenttext");
    let $rightMenuNewWindow = $("#menu-newwindow");
    let $rightMenuNewWindowImg = $("#menu-newwindowimg");
    let $rightMenuCopyLink = $("#menu-copylink");
    let $rightMenuCopyImg = $("#menu-copyimg");
    let $rightMenuDownloadImg = $("#menu-downloadimg");
    let $rightMenuSearch = $("#menu-search");
    let $rightMenuSearchBaidu = $("#menu-searchBaidu");
    let $rightMenuMusicToggle = $("#menu-music-toggle");
    let $rightMenuMusicBack = $("#menu-music-back");
    let $rightMenuMusicForward = $("#menu-music-forward");
    let $rightMenuMusicPlaylist = $("#menu-music-playlist");
    let $rightMenuMusicCopyMusicName = $("#menu-music-copyMusicName");
    let href = event.target.href;
    let imgsrc = event.target.currentSrc;

    // 判断模式 扩展模式为有事件
    let pluginMode = false;
    $rightMenuOther.show();
    globalEvent = event;

    // 检查是否需要复制 是否有选中文本
    if (selectTextNow && window.getSelection()) {
      pluginMode = true;
      $rightMenuCopyText.show();
      $rightMenuCommentText.show();
      $rightMenuSearch.show();
      $rightMenuSearchBaidu.show();
    } else {
      $rightMenuCopyText.hide();
      $rightMenuCommentText.hide();
      $rightMenuSearchBaidu.hide();
      $rightMenuSearch.hide();
    }

    //检查是否右键点击了链接a标签
    if (href) {
      pluginMode = true;
      $rightMenuNewWindow.show();
      $rightMenuCopyLink.show();
      domhref = href;
    } else {
      $rightMenuNewWindow.hide();
      $rightMenuCopyLink.hide();
    }

    //检查是否需要复制图片
    if (imgsrc) {
      pluginMode = true;
      $rightMenuCopyImg.show();
      $rightMenuDownloadImg.show();
      $rightMenuNewWindowImg.show();
      domImgSrc = imgsrc;
    } else {
      $rightMenuCopyImg.hide();
      $rightMenuDownloadImg.hide();
      $rightMenuNewWindowImg.hide();
    }

    // 判断是否为输入框
    if (event.target.tagName.toLowerCase() === "input" || event.target.tagName.toLowerCase() === "textarea") {
      console.log("这是一个输入框");
      pluginMode = true;
      $rightMenuPasteText.show();
    } else {
      $rightMenuPasteText.hide();
    }
    const navMusicEl = document.querySelector("#nav-music");
    //判断是否是音乐
    if (navMusicEl && navMusicEl.contains(event.target)) {
      pluginMode = true;
      $rightMenuMusicToggle.show();
      $rightMenuMusicBack.show();
      $rightMenuMusicForward.show();
      $rightMenuMusicPlaylist.show();
      $rightMenuMusicCopyMusicName.show();
    } else {
      $rightMenuMusicToggle.hide();
      $rightMenuMusicBack.hide();
      $rightMenuMusicForward.hide();
      $rightMenuMusicPlaylist.hide();
      $rightMenuMusicCopyMusicName.hide();
    }

    // 如果不是扩展模式则隐藏扩展模块
    if (pluginMode) {
      $rightMenuOther.hide();
      $rightMenuPlugin.show();
    } else {
      $rightMenuPlugin.hide();
    }

    rm.reloadrmSize();

    // 鼠标默认显示在鼠标右下方，当鼠标靠右或考下时，将菜单显示在鼠标左方\上方
    if (pageX + rmWidth > window.innerWidth) {
      pageX -= rmWidth + 10;
    }
    if (pageY + rmHeight > window.innerHeight) {
      pageY -= pageY + rmHeight - window.innerHeight;
    }

    rm.showRightMenu(true, pageY, pageX);
    $("#rightmenu-mask").attr("style", "display: flex");
    return false;
  }
};

// 下载图片状态
rm.downloadimging = false;

// 复制图片到剪贴板
rm.writeClipImg = function (imgsrc) {
  console.log("按下复制");
  rm.hideRightMenu();
  anzhiyu.snackbarShow("正在下载中，请稍后", false, 10000);
  if (rm.downloadimging == false) {
    rm.downloadimging = true;
    setTimeout(function () {
      copyImage(imgsrc);
      anzhiyu.snackbarShow("复制成功！图片已添加盲水印，请遵守版权协议");
      rm.downloadimging = false;
    }, "10000");
  }
};

function imageToBlob(imageURL) {
  const img = new Image();
  const c = document.createElement("canvas");
  const ctx = c.getContext("2d");
  img.crossOrigin = "";
  img.src = imageURL;
  return new Promise(resolve => {
    img.onload = function () {
      c.width = this.naturalWidth;
      c.height = this.naturalHeight;
      ctx.drawImage(this, 0, 0);
      c.toBlob(
        blob => {
          // here the image is a blob
          resolve(blob);
        },
        "image/png",
        0.75
      );
    };
  });
}

async function copyImage(imageURL) {
  const blob = await imageToBlob(imageURL);
  const item = new ClipboardItem({ "image/png": blob });
  navigator.clipboard.write([item]);
}

rm.switchDarkMode = function () {
  // Switch Between Light And Dark Mode
  const nowMode = document.documentElement.getAttribute("data-theme") === "dark" ? "dark" : "light";
  if (nowMode === "light") {
    activateDarkMode();
    saveToLocal.set("theme", "dark", 2);
    GLOBAL_CONFIG.Snackbar !== undefined && anzhiyu.snackbarShow(GLOBAL_CONFIG.Snackbar.day_to_night);
  } else {
    activateLightMode();
    saveToLocal.set("theme", "light", 2);
    GLOBAL_CONFIG.Snackbar !== undefined && anzhiyu.snackbarShow(GLOBAL_CONFIG.Snackbar.night_to_day);
  }
  // handle some cases
  typeof runMermaid === "function" && window.runMermaid();
  rm.hideRightMenu();
  anzhiyu.darkModeStatus();
};

rm.copyUrl = function (id) {
  $("body").after("<input id='copyVal'></input>");
  var text = id;
  var input = document.getElementById("copyVal");
  input.value = text;
  input.select();
  input.setSelectionRange(0, input.value.length);
  document.execCommand("copy");
  $("#copyVal").remove();
};

function stopMaskScroll() {
  if (document.getElementById("rightmenu-mask")) {
    let xscroll = document.getElementById("rightmenu-mask");
    xscroll.addEventListener(
      "mousewheel",
      function (e) {
        //阻止浏览器默认方法
        rm.hideRightMenu();
        // e.preventDefault();
      },
      false
    );
  }
  if (document.getElementById("rightMenu")) {
    let xscroll = document.getElementById("rightMenu");
    xscroll.addEventListener(
      "mousewheel",
      function (e) {
        //阻止浏览器默认方法
        rm.hideRightMenu();
        // e.preventDefault();
      },
      false
    );
  }
}

rm.rightmenuCopyText = function (txt) {
  if (navigator.clipboard) {
    navigator.clipboard.writeText(txt);
  }
  rm.hideRightMenu();
};

rm.copyPageUrl = function () {
  var url = window.location.href;
  rm.copyUrl(url);
  anzhiyu.snackbarShow("复制本页链接地址成功", false, 2000);
  rm.hideRightMenu();
};

rm.sharePage = function () {
  var content = window.location.href;
  rm.copyUrl(url);
  anzhiyu.snackbarShow("复制本页链接地址成功", false, 2000);
  rm.hideRightMenu();
};

// 复制当前选中文本
var selectTextNow = "";
document.onmouseup = document.ondblclick = selceText;

function selceText() {
  var txt;
  if (document.selection) {
    txt = document.selection.createRange().text;
  } else {
    txt = window.getSelection().toString();
  }
  selectTextNow = txt !== "" ? txt : "";
}

// 读取剪切板
rm.readClipboard = function () {
  if (navigator.clipboard) {
    navigator.clipboard.readText().then(clipText => rm.insertAtCaret(globalEvent.target, clipText));
  }
};

// 粘贴文本到焦点
rm.insertAtCaret = function (elemt, value) {
  const startPos = elemt.selectionStart,
    endPos = elemt.selectionEnd;
  if (document.selection) {
    elemt.focus();
    var sel = document.selection.createRange();
    sel.text = value;
    elemt.focus();
  } else {
    if (startPos || startPos == "0") {
      var scrollTop = elemt.scrollTop;
      elemt.value = elemt.value.substring(0, startPos) + value + elemt.value.substring(endPos, elemt.value.length);
      elemt.focus();
      elemt.selectionStart = startPos + value.length;
      elemt.selectionEnd = startPos + value.length;
      elemt.scrollTop = scrollTop;
    } else {
      elemt.value += value;
      elemt.focus();
    }
  }
};

//粘贴文本
rm.pasteText = function () {
  const result = rm.readClipboard() || "";
  rm.hideRightMenu();
};

//引用到评论
rm.rightMenuCommentText = function (txt) {
  rm.hideRightMenu();
  const postCommentDom = document.querySelector("#post-comment");
  var domTop = postCommentDom.offsetTop;
  window.scrollTo(0, domTop - 80);
  if (txt == "undefined" || txt == "null") txt = "好棒！";
  function setText() {
    setTimeout(() => {
      var input = document.getElementsByClassName("el-textarea__inner")[0];
      if (!input) setText();
      let evt = document.createEvent("HTMLEvents");
      evt.initEvent("input", true, true);
      let inputValue = replaceAll(txt, "\n", "\n> ");
      input.value = "> " + inputValue + "\n\n";
      input.dispatchEvent(evt);
      input.focus();
      input.setSelectionRange(-1, -1);
      if (document.getElementById("comment-tips")) {
        document.getElementById("comment-tips").classList.add("show");
      }
    }, 100);
  }
  setText();
};

//替换所有内容
function replaceAll(string, search, replace) {
  return string.split(search).join(replace);
}

// 百度搜索
rm.searchBaidu = function () {
  anzhiyu.snackbarShow("即将跳转到百度搜索", false, 2000);
  setTimeout(function () {
    window.open("https://www.baidu.com/s?wd=" + selectTextNow);
  }, "2000");
  rm.hideRightMenu();
};

//分享链接
rm.copyLink = function () {
  rm.rightmenuCopyText(domhref);
  anzhiyu.snackbarShow("已复制链接地址");
};

function addRightMenuClickEvent() {
  // 添加点击事件
  $("#menu-backward").on("click", function () {
    window.history.back();
    rm.hideRightMenu();
  });
  $("#menu-forward").on("click", function () {
    window.history.forward();
    rm.hideRightMenu();
  });
  $("#menu-refresh").on("click", function () {
    window.location.reload();
  });
  $("#menu-top").on("click", function () {
    anzhiyu.scrollToDest(0, 500);
    rm.hideRightMenu();
  });
  $(".menu-link").on("click", rm.hideRightMenu);
  $("#menu-darkmode").on("click", rm.switchDarkMode);
  $("#menu-home").on("click", function () {
    window.location.href = window.location.origin;
  });
  $("#menu-randomPost").on("click", function () {
    toRandomPost();
  });
  $("#menu-commentBarrage").on("click", anzhiyu.switchCommentBarrage);
  $("#rightmenu-mask").on("click", rm.hideRightMenu);
  $("#rightmenu-mask").contextmenu(function () {
    rm.hideRightMenu();
    return false;
  });
  $("#menu-copy").on("click", rm.copyPageUrl);
  $("#menu-pastetext").on("click", rm.pasteText);
  $("#menu-copytext").on("click", function () {
    rm.rightmenuCopyText(selectTextNow);
    anzhiyu.snackbarShow("复制成功，复制和转载请标注本文地址");
  });
  $("#menu-commenttext").on("click", function () {
    rm.rightMenuCommentText(selectTextNow);
  });
  $("#menu-newwindow").on("click", function () {
    window.open(domhref);
    rm.hideRightMenu();
  });
  $("#menu-copylink").on("click", rm.copyLink);
  $("#menu-downloadimg").on("click", function () {
    anzhiyu.downloadImage(domImgSrc, "anzhiyu");
  });
  $("#menu-newwindowimg").on("click", function () {
    window.open(domImgSrc);
    rm.hideRightMenu();
  });
  $("#menu-copyimg").on("click", function () {
    rm.writeClipImg(domImgSrc);
  });
  $("#menu-searchBaidu").on("click", rm.searchBaidu);
  //音乐
  $("#menu-music-toggle").on("click", anzhiyu.musicToggle);
  $("#menu-music-back").on("click", anzhiyu.musicSkipBack);
  $("#menu-music-forward").on("click", anzhiyu.musicSkipForward);
  $("#menu-music-copyMusicName").on("click", function () {
    rm.rightmenuCopyText(anzhiyu.musicGetName());
    anzhiyu.snackbarShow("复制歌曲名称成功", false, 3000);
  });
}

addRightMenuClickEvent();</script><script data-pjax>var themeColorMeta = document.querySelector('meta[name="theme-color"]');
var pageHeaderEl = document.getElementById("page-header");
var navMusicEl = document.getElementById("nav-music");
var consoleEl = document.getElementById("console");
// 已随机的歌曲
var selectRandomSong = [];
// 音乐默认声音大小
var musicVolume = 0.8;
// 是否切换了周杰伦音乐列表
var changeMusicListFlag = false;
// 当前默认播放列表
var defaultPlayMusicList = [];

document.getElementById("page-name").innerText = document.title.split(" | 安知鱼")[0];
anzhiyu.initIndexEssay();
anzhiyu.changeTimeInEssay();
anzhiyu.removeBodyPaceClass();
anzhiyu.changeTimeInAlbumDetail();
anzhiyu.reflashEssayWaterFall();
anzhiyu.sayhi();
anzhiyu.stopImgRightDrag();
anzhiyu.addNavBackgroundInit();
anzhiyu.setValueToBodyType();

anzhiyu.getCustomPlayList();
anzhiyu.addEventListenerConsoleMusicList(false);</script><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/ali_font.js"></script><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://npm.elemecdn.com/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://npm.elemecdn.com/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://npm.elemecdn.com/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","meta[property=\"og:type\"]","meta[property=\"og:site_name\"]","meta[property=\"og:description\"]","head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)
  window.anzhiyuScrollFnToDo && window.removeEventListener('scroll', anzhiyuScrollFnToDo)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script></div></body></html>